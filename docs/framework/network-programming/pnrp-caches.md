---
title: "PNRP キャッシュ"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
- C++
- jsharp
ms.assetid: 270068d9-1b6b-4eb9-9e14-e02326bb88df
caps.latest.revision: 4
author: mcleblanc
ms.author: markl
manager: markl
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: b468a8cfd050943513cbe858c3ba985ee922b23f
ms.contentlocale: ja-jp
ms.lasthandoff: 08/21/2017

---
# <a name="pnrp-caches"></a>PNRP キャッシュ
ピア名解決プロトコル (PNRP) キャッシュは、アルゴリズムによって選択され、ピアで保持されているピア エンドポイントのローカル コレクションです。  
  
## <a name="pnrp-cache-initialization"></a>PNRP キャッシュ初期化  
 ピア ノードの起動時に PNRP キャッシュまたはピア名レコード コレクションを初期化するには、次の方法をノードで利用できます。  
  
-   ノードのシャットダウン時に存在していた永続キャッシュ エントリがハード ディスク ストレージから読み込まれます。  
  
-   アプリケーションで P2P コラボレーション インフラストラクチャを使用している場合、連絡先マネージャーでそのノードに関するコラボレーション情報を利用できます。  
  
## <a name="scaling-peer-name-resolution-with-a-multi-level-cache"></a>マルチレベル キャッシュを使用してピア名解決の規模を調整する  
 PNRP キャッシュ サイズを小さくするために、ピア ノードはマルチレベル キャッシュを使用します。このマルチレベル キャッシュの各レベルには最大数のエントリが格納されます。 キャッシュ内の各レベルは、PNRP ID の数値スペース (2<sup>256</sup>) の 10 分の 1 の大きさを表しています。 キャッシュ内の最下位レベルには、ローカルに登録されている PNRP ID とこれに近い番号の他の PNRP ID が含まれています。 キャッシュの 1 つのレベルに最大数 (20 個) のエントリが格納されると、これよりも下位の新しいレベルが生成されます。 キャッシュ内のレベルの最大数は、log10(クラウド内の PNRP ID の合計数) の桁で計算されます。 たとえば、名前解決の際に 1 億個の PNRP ID があるグローバル クラウドで PNRP ID を解決する場合、キャッシュ内のレベルは 8 (=log10(100,000,000)) を下回り、ホップ数も同様の数しか存在しません。 このメカニズムでは、対応する CPA を持つピアが見つかるまで 2 番目に近いピアに PNRP 要求メッセージを転送することによって任意の PNRP ID を解決できるよう、分散ハッシュ テーブルを作成します。  
  
 名前解決が完了し、ノードのキャッシュの最下位レベルにエントリが追加されるたびに、エントリのコピーが、キャッシュの最終レベル内部のすべてのノードに追加されます。  
  
 キャッシュ エントリは時間が経つと更新されます。 古くなったキャッシュ エントリはキャッシュから削除されます。 その結果として、PNRP ID の分散ハッシュ テーブルはアクティブなエンドポイントに基づいて作成されています。これは、アドレス レコードと DNS プロトコルによって、アドレスに関連付けられているノードが必ずネットワーク上でアクティブになるとは限らない DNS とは異なる点です。  
  
## <a name="other-pnrp-caches"></a>その他の PNRP キャッシュ  
 もう 1 つの永続データ ストアはローカル キャッシュです。  PNRP アクティビティに必要な他のオブジェクトに加え、安全に公開され、クラウドの全メンバー間で同期されている、PNRP クラウドまたはコラボレーション セッションに関連付けられたレポートが含まれる場合があります。 このレプリケートされたストアは、グループ データのビューを表しており、すべてのグループ メンバーで同じである必要があります。 正確に言うと、これらのオブジェクトはレコードというよりも、ローカル キャッシュに送信されるアプリケーション、プレゼンス、およびオブジェクト データです。 PNRP クラウドを使用することで、オブジェクトはコラボレーション セッションまたは PNRP クラウド内のすべてのノードに反映されます。  クラウド メンバー間のレコード レプリケーションでは、SSL を使用して暗号化とデータの整合性を提供しています。  
  
 ピアがクラウドに参加しても、アタッチしているホスト ピアからはローカル キャッシュ データを自動的に受信しません。アプリケーション、プレゼンス、およびオブジェクト データの更新を受信するには、ホスト ピアにサブスクライブする必要があります。 ピアは、初回の同期後、レプリケートされたストアを定期的に再同期することで、すべてのグループ メンバーで一貫して同じビューを維持します。  コラボレーション セッションまたはコラボレーション セッション内のアプリケーションは、同じ関数を実行することもあります。  
  
 クラウドのコラボレーション セッションが開始された後、アプリケーションはピアを登録し、クラウド スコープに定義されているセキュリティを使用して情報を公開できるようになります。 ピアがクラウドに参加すると、クラウドのセキュリティ機構がピアに適用され、参加するスコープが指定されます。  そのレコードは、クラウドのスコープ内で安全に公開できるようになります。 クラウドのスコープは、コラボレーション アプリケーションのスコープと同じではない可能性があります。  
  
 ピアは、他のピアからオブジェクトを受信する希望を登録できます。 オブジェクトが更新されると、コラボレーション アプリケーションに通知され、新しいオブジェクトはアプリケーションのすべてのサブスクライバーに渡されます。 たとえば、グループ チャット アプリケーションのピアは、アプリケーション情報を受信する希望を登録できます。そのアプリケーションからは、すべてのチャット レコードがアプリケーション データとして送信されます。  これによって、クラウド内のチャット アクティビティを監視できます。  
  
## <a name="see-also"></a>関連項目  
 <xref:System.Net.PeerToPeer>

