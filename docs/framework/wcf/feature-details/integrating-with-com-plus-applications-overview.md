---
title: "COM+ アプリケーションとの統合の概要"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Windows Communication Foundation, COM+ integration
- WCF, COM+ integration
ms.assetid: e481e48f-7096-40eb-9f20-7f0098412941
caps.latest.revision: "29"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 04de29891bcf5d8cdbac32ffc85d64a4003e3184
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/02/2017
---
# <a name="integrating-with-com-applications-overview"></a><span data-ttu-id="be5c1-102">COM+ アプリケーションとの統合の概要</span><span class="sxs-lookup"><span data-stu-id="be5c1-102">Integrating with COM+ Applications Overview</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="be5c1-103"> は分散アプリケーションを作成するための有用な環境を提供します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-103"> provides a rich environment for creating distributed applications.</span></span> <span data-ttu-id="be5c1-104">COM+ でホストされるコンポーネント ベースのアプリケーション ロジックを既に使用している場合は、[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] を使用すると、既存のロジックを修正することなく拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-104">If you are already using component-based application logic hosted in COM+, you can use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] to extend your existing logic rather than having to rewrite it.</span></span> <span data-ttu-id="be5c1-105">既存の COM+ サービスまたはエンタープライズ サービスの業務ロジックを、Web サービスを介して公開する場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-105">A common scenario is when you want to expose existing COM+ or Enterprise Services business logic through Web Services.</span></span>  
  
 <span data-ttu-id="be5c1-106">COM+ コンポーネントのインターフェイスを Web サービスとして公開する場合、その仕様やコントラクトは、アプリケーションの初期化の際に実行される自動マッピングによって決まります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-106">When an interface on a COM+ component is exposed as a Web service, the specification and contract of these services are determined by an automatic mapping that is performed at application initialization time.</span></span> <span data-ttu-id="be5c1-107">このマッピングの概念モデルを次に示します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-107">The following list shows the conceptual model for this mapping:</span></span>  
  
-   <span data-ttu-id="be5c1-108">公開する COM クラスごとに 1 つのサービスが定義されます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-108">One service is defined for each exposed COM class.</span></span>  
  
-   <span data-ttu-id="be5c1-109">サービスのコントラクトは、選択されたコンポーネントのインターフェイス定義から直接派生しますが、一部のメソッドを除外することも可能です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-109">The contract for the service is derived directly from the selected component's interface definition with the possibility of method exclusion defined in configuration.</span></span>  
  
-   <span data-ttu-id="be5c1-110">このコントラクトに定義する操作は、コンポーネントのインターフェイス定義のメソッドから直接派生します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-110">The operations in that contract are derived directly from the methods on the component's interface definition.</span></span>  
  
-   <span data-ttu-id="be5c1-111">操作のためのパラメーターは、コンポーネントのメソッド パラメーターに対応する COM の (相互運用性を実現するための) 型から直接派生します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-111">The parameters for those operations are derived directly from the COM interoperability type that corresponds to the component's method parameters.</span></span>  
  
 <span data-ttu-id="be5c1-112">サービスのアドレス既定値やトランスポート バインディングは、サービス構成ファイルに記述しますが、必要に応じて再設定も可能です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-112">Default addresses and transport bindings for the service are provided in a service configuration file, but these can be reconfigured as required.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="be5c1-113">公開した Web サービスのコントラクトは、COM+ インターフェイスや構成を変更しない限り変わりません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-113">The contracts for the exposed Web services remain constant as long as the COM+ interfaces and configuration remain unchanged.</span></span> <span data-ttu-id="be5c1-114">また、複数のインターフェイスを変更しても、利用できるサービスが自動的に更新されることはありません。COM+ サービス モデル構成ツール (ComSvcConfig.exe) を再実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-114">A modification to several interfaces does not automatically update the available services and requires re-running the COM+ Service Model Configuration tool (ComSvcConfig.exe).</span></span>  
  
 <span data-ttu-id="be5c1-115">COM+ アプリケーションおよびそのコンポーネントの認証/承認要求は、Web サービスを使う場合でもやはり必要です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-115">The authentication and authorization requirements of the COM+ application and its components continue to be enforced when used as a Web service.</span></span>  
  
 <span data-ttu-id="be5c1-116">呼び出し元が Web サービス トランザクションを起動すると、トランザクション処理中としてマークされたコンポーネントが、該当するトランザクション スコープに入ります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-116">If the caller initiates a Web service transaction, components marked as transactional enlist within that transaction scope.</span></span>  
  
 <span data-ttu-id="be5c1-117">COM+ コンポーネントを修正することなく、そのインターフェイスを Web サービスとして公開するための手順を次に示します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-117">The following steps are required to expose a COM+ component's interface as a Web service without modifying the component:</span></span>  
  
1.  <span data-ttu-id="be5c1-118">COM+ コンポーネントのインターフェイスを、実際に Web サービスとして公開してかまわないかどうか、あらかじめ確認してください。</span><span class="sxs-lookup"><span data-stu-id="be5c1-118">Determine whether the COM+ component's interface can be exposed as a Web service.</span></span>  
  
2.  <span data-ttu-id="be5c1-119">適切なホスティング モードを選択します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-119">Select an appropriate hosting mode.</span></span>  
  
3.  <span data-ttu-id="be5c1-120">COM+ サービス モデル構成ツール (ComSvcConfig.exe) を使用して、当該インターフェイスを公開するための Web サービスを追加します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-120">Use the COM+ Service Model Configuration tool (ComSvcConfig.exe) to add a Web service for the interface.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="be5c1-121">ComSvcConfig.exe を使用して、表示する方法[する方法: COM + サービス モデルの構成ツールを使用して](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md)です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-121"> how to use ComSvcConfig.exe, see [How to: Use the COM+ Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span></span>  
  
4.  <span data-ttu-id="be5c1-122">アプリケーション構成ファイルで、追加のサービス設定を構成します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-122">Configure any additional service settings in the application configuration file.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="be5c1-123">参照してください、コンポーネントを構成する方法[する方法: COM + サービス設定の構成](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md)です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-123"> how to configure a component, see [How to: Configure COM+ Service Settings](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span></span>  
  
## <a name="supported-interfaces"></a><span data-ttu-id="be5c1-124">公開可能なインターフェイス</span><span class="sxs-lookup"><span data-stu-id="be5c1-124">Supported Interfaces</span></span>  
 <span data-ttu-id="be5c1-125">Web サービスとして公開できるインターフェイスの種類に関して、いくつか制約があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-125">There are some restrictions on the type of interfaces that can be exposed as a Web service.</span></span> <span data-ttu-id="be5c1-126">次のようなインターフェイスは公開できません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-126">The following types of interfaces are not supported:</span></span>  
  
-   <span data-ttu-id="be5c1-127">オブジェクト参照をパラメーターとして渡すインターフェイス。ただし、「オブジェクト参照を渡せる場合」で説明されているようにいくつか例外があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-127">Interfaces that pass object references as parameters - the following limited object reference approach is described in the Limited Object Reference Support section.</span></span>  
  
-   <span data-ttu-id="be5c1-128">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] COM 相互運用変換ができない型を渡すインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="be5c1-128">Interfaces that pass types that are not compatible with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] COM interoperability conversions.</span></span>  
  
-   <span data-ttu-id="be5c1-129">COM+ でサービスを提供する場合にアプリケーション プールが有効になるアプリケーションに対するインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="be5c1-129">Interfaces for applications that have application pooling enabled when hosted by COM+.</span></span>  
  
-   <span data-ttu-id="be5c1-130">アプリケーション内部でのみ有効な (プライベートと指定された) コンポーネントのインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="be5c1-130">Interfaces of components that are marked as private to the application.</span></span>  
  
-   <span data-ttu-id="be5c1-131">COM+ インフラストラクチャ インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="be5c1-131">COM+ infrastructure interfaces.</span></span>  
  
-   <span data-ttu-id="be5c1-132">システム アプリケーションからのインターフェース。</span><span class="sxs-lookup"><span data-stu-id="be5c1-132">Interfaces from the system application.</span></span>  
  
-   <span data-ttu-id="be5c1-133">エンタープライズ サービス コンポーネントからのインターフェイスで、グローバル アセンブリ キャッシュに追加されていないもの。</span><span class="sxs-lookup"><span data-stu-id="be5c1-133">Interfaces from Enterprise Services components that have not been added to the global assembly cache.</span></span>  
  
### <a name="limited-object-reference-support"></a><span data-ttu-id="be5c1-134">オブジェクト参照を渡せる場合</span><span class="sxs-lookup"><span data-stu-id="be5c1-134">Limited Object Reference Support</span></span>  
 <span data-ttu-id="be5c1-135">展開済みの COM+ コンポーネントの多くが、ADO Recordset オブジェクトを返す場合などに、パラメーターとしてオブジェクト参照を渡すようになっているため、COM+ 統合においても、一定の条件を満たす場合には、オブジェクト参照をパラメーターとして渡せるようになっています。</span><span class="sxs-lookup"><span data-stu-id="be5c1-135">Because a number of deployed COM+ components do use objects by reference parameters, such as returning an ADO Recordset object, COM+ integration includes limited support for object reference parameters.</span></span> <span data-ttu-id="be5c1-136">オブジェクト参照を渡せるのは、`IPersistStream` COM インターフェイスを実装しているオブジェクトに限ります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-136">The support is limited to objects that implement the `IPersistStream` COM interface.</span></span> <span data-ttu-id="be5c1-137">たとえば ADO Recordset オブジェクトがそうで、アプリケーション固有の COM オブジェクトについてはオブジェクト参照を実装できます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-137">This includes ADO Recordset objects and can be implemented for application specific COM objects.</span></span>  
  
 <span data-ttu-id="be5c1-138">このサポートを有効にするには、ComSvcConfig.exe ツールが用意されています、 **allowreferences**通常のメソッド シグネチャのパラメーターが無効になり、オブジェクト参照パラメーターが使用されていないことを確認するツールを実行することを確認するスイッチ.</span><span class="sxs-lookup"><span data-stu-id="be5c1-138">To enable this support, the ComSvcConfig.exe tool provides the **allowreferences** switch that disables the regular method signature parameter and checks that the tool runs to ensure that object reference parameters are not being used.</span></span> <span data-ttu-id="be5c1-139">ただし、パラメーターとして渡すオブジェクト型に名前を付け、<`persistableTypes`> 構成要素 (<`comContract`> 要素の子要素) で識別できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-139">In addition, the object types that you pass as parameters must be named and identified within the <`persistableTypes`> configuration element that is a child of the <`comContract`> element.</span></span>  
  
 <span data-ttu-id="be5c1-140">この機能を使用する場合、COM+ 統合サービスは、`IPersistStream` インターフェイスを使用してオブジェクト インスタンスのシリアル化および逆シリアル化を行います。</span><span class="sxs-lookup"><span data-stu-id="be5c1-140">When this feature is used, the COM+ integration service uses the `IPersistStream` interface to serialize or deserialize the object instance.</span></span> <span data-ttu-id="be5c1-141">オブジェクト インスタンスが `IPersistStream` インターフェイスを実装していない場合、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-141">If the object instance does not support `IPersistStream`, an exception is thrown.</span></span>  
  
 <span data-ttu-id="be5c1-142">クライアント アプリケーションがサービスとの間でオブジェクトをやり取りするためには、<xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> オブジェクトの該当するメソッドを使用できます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-142">Within a client application, the methods on the <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> object can be used to pass an object in to a service and similarly to retrieve an object.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="be5c1-143">このメソッドはプラットフォーム固有の独自の方式でシリアル化を行うようになっているので、[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] クライアントと [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] サービスの間でやり取りする場合に最も適しています。</span><span class="sxs-lookup"><span data-stu-id="be5c1-143">Due to the custom and platform-specific nature of the serialization approach, this is best suited for use between [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services.</span></span>  
  
## <a name="selecting-the-hosting-mode"></a><span data-ttu-id="be5c1-144">ホスティング モードの選択</span><span class="sxs-lookup"><span data-stu-id="be5c1-144">Selecting the Hosting Mode</span></span>  
 <span data-ttu-id="be5c1-145">COM+ が Web サービスを公開する際のホスティング モードには、次のようなものがあります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-145">COM+ exposes Web services in one of the following hosting modes:</span></span>  
  
-   <span data-ttu-id="be5c1-146">COM+ ホスト</span><span class="sxs-lookup"><span data-stu-id="be5c1-146">COM+-hosted</span></span>  
  
     <span data-ttu-id="be5c1-147">Web サービスを各アプリケーション専用の COM+ サーバー プロセス (Dllhost.exe) から提供します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-147">The Web service is hosted within the application's dedicated COM+ server process (Dllhost.exe).</span></span> <span data-ttu-id="be5c1-148">この場合、実際に Web サービス要求が届く前に、あらかじめアプリケーションを起動しておかなければなりません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-148">This mode requires the application to be explicitly started before it can receive Web service requests.</span></span> <span data-ttu-id="be5c1-149">COM+ オプション "Run as an NT Service" または "Leave running when idle" を指定することにより、アプリケーションやサービスがアイドル状態になっても停止しないようになります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-149">The COM+ options "Run as an NT Service" or "Leave running when idle" can be used to prevent idle shutdown of the application and its services.</span></span> <span data-ttu-id="be5c1-150">このモードでは、サーバー アプリケーションから Web サービスと DCOM アクセスの両方を利用できます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-150">This mode provides both Web service and DCOM access to the server application.</span></span>  
  
-   <span data-ttu-id="be5c1-151">Web ホスト</span><span class="sxs-lookup"><span data-stu-id="be5c1-151">Web-hosted</span></span>  
  
     <span data-ttu-id="be5c1-152">Web サービスを Web サーバーのワーカー プロセス内で提供します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-152">The Web service is hosted within a Web server worker process.</span></span> <span data-ttu-id="be5c1-153">最初の要求が届いた時点で、あらかじめ COM+ がアクティブになっている必要はありません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-153">This mode does not require COM+ to be active when the initial request is received.</span></span> <span data-ttu-id="be5c1-154">必要に応じ、自動的にアクティブ化してから要求を処理するようになっています。</span><span class="sxs-lookup"><span data-stu-id="be5c1-154">If the application is not active when this request is received, it is automatically activated prior to processing the request.</span></span> <span data-ttu-id="be5c1-155">このモードでも、サーバー アプリケーションから Web サービスと DCOM アクセスの両方を利用できますが、Web サービス要求の転送が発生するため、プロセス ホップが発生します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-155">This mode also provides both Web service and DCOM access to the server application, but causes a process hop for Web service requests.</span></span> <span data-ttu-id="be5c1-156">通常、クライアント側で偽装が必要になります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-156">This typically requires the client to enable impersonation.</span></span> <span data-ttu-id="be5c1-157">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] では、<xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> クラスの <xref:System.ServiceModel.Security.WindowsClientCredential> プロパティ (ジェネリック <xref:System.ServiceModel.ChannelFactory%601> クラスのプロパティとしてアクセス) および <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> 列挙値を使用してこれを行います。</span><span class="sxs-lookup"><span data-stu-id="be5c1-157">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], this can be done with the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class, which is accessed as a property of the generic <xref:System.ServiceModel.ChannelFactory%601> class, as well as the <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> enumeration value.</span></span>  
  
-   <span data-ttu-id="be5c1-158">Web ホスト (インプロセス)</span><span class="sxs-lookup"><span data-stu-id="be5c1-158">Web-hosted in-process</span></span>  
  
     <span data-ttu-id="be5c1-159">Web サービスと COM+ アプリケーション ロジックの両方を Web サーバーのワーカー プロセス内で提供します。</span><span class="sxs-lookup"><span data-stu-id="be5c1-159">The Web service and the COM+ application logic are hosted within the Web server worker process.</span></span> <span data-ttu-id="be5c1-160">Web サービス要求を転送することなく、自動的に Web ホスト モードにすることができます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-160">This provides automatic activation of the Web-hosted mode without causing a process hop for Web service requests.</span></span> <span data-ttu-id="be5c1-161">ただし、サーバー アプリケーションに DCOM でアクセスできない、という短所があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-161">The disadvantage is that the server application cannot be accessed through DCOM.</span></span>  
  
### <a name="security-considerations"></a><span data-ttu-id="be5c1-162">セキュリティの考慮事項</span><span class="sxs-lookup"><span data-stu-id="be5c1-162">Security Considerations</span></span>  
 <span data-ttu-id="be5c1-163">他の [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] サービスと同様、公開するサービスのセキュリティ設定は [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] チャネルに対して行います。</span><span class="sxs-lookup"><span data-stu-id="be5c1-163">Like other [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services, the security settings for the exposed service are administered through configuration settings for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] channel.</span></span> <span data-ttu-id="be5c1-164">従来の DCOM セキュリティ設定には、コンピューター全体のアクセス権限設定などがありましたが、これは必須ではありません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-164">Traditional DCOM security settings such as the DCOM machine-wide permissions settings are not enforced.</span></span> <span data-ttu-id="be5c1-165">COM+ アプリケーション ロールを強制する場合、コンポーネントの "コンポーネント レベルのアクセス確認" 承認を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-165">To enforce COM+ application roles, "component-level access checks" authorization must be enabled for the component.</span></span>  
  
 <span data-ttu-id="be5c1-166">セキュリティ保護されていないバインディングは改ざんや情報漏洩を招くので、</span><span class="sxs-lookup"><span data-stu-id="be5c1-166">The use of a non-secured binding can leave communication open to tampering or information disclosure.</span></span> <span data-ttu-id="be5c1-167">セキュリティ保護されたバインディングを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="be5c1-167">To prevent this, it is recommended that you use a secured binding.</span></span>  
  
 <span data-ttu-id="be5c1-168">"COM+ ホスト" モードおよび "Web ホスト" モードの場合、クライアント アプリケーション側で、サーバー プロセスによるクライアント ユーザーの偽装を許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-168">For the COM+-hosted and Web-hosted modes, client applications must permit the server process to impersonate the client user.</span></span> <span data-ttu-id="be5c1-169">これは、[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] クライアント側で、偽装レベルを <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> と設定することにより行います。</span><span class="sxs-lookup"><span data-stu-id="be5c1-169">This can be done in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients by setting the impersonation level to <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span></span>  
  
 <span data-ttu-id="be5c1-170">インターネット インフォメーション サービス (IIS) または Windows プロセス アクティブ化サービス (WAS) で HTTP トランスポートを使用する場合、Httpcfg.exe ツールでトランスポート エンドポイントのアドレスを確保し、他の用途には使用しないように予約することができます。</span><span class="sxs-lookup"><span data-stu-id="be5c1-170">With Internet Information Services (IIS) or Windows Process Activation Service (WAS) using the HTTP transport, the Httpcfg.exe tool can be used to reserve a transport endpoint address.</span></span> <span data-ttu-id="be5c1-171">他の構成では、正当なサービスのように機能する不正なサービスからの防御が重要です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-171">In other configurations, it is important to protect against rogue services that act as the intended service.</span></span> <span data-ttu-id="be5c1-172">接続先のエンドポイントで不正なサービスが起動されるのを防ぐため、正当なサービスは NT サービスとして動作するよう設定するとよいでしょう。</span><span class="sxs-lookup"><span data-stu-id="be5c1-172">To prevent a rogue service from starting at the desired endpoint, the legitimate service can be configured to run as an NT service.</span></span> <span data-ttu-id="be5c1-173">これにより、正当なサービスは、他の不正なサービスに優先してエンドポイント アドレスを確保できるようになります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-173">This enables the legitimate service to claim the endpoint address prior to any rogue services.</span></span>  
  
 <span data-ttu-id="be5c1-174">Web ホスト サービスとして構成されている COM + ロールで COM + アプリケーションを公開するときに、アプリケーションのロールのいずれかに"Launch IIS Process Account"を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="be5c1-174">When exposing a COM+ application with configured COM+ roles as a Web-hosted service, the "Launch IIS Process Account" must be added to one of the application’s roles.</span></span> <span data-ttu-id="be5c1-175">このアカウントは通常、IWAM_machinename という形の名前で、オブジェクトの使用後、安全にシャットダウンできるようにするために必要です。</span><span class="sxs-lookup"><span data-stu-id="be5c1-175">This account, typically with the name IWAM_machinename, must be added to enable clean shutdown of objects after use.</span></span> <span data-ttu-id="be5c1-176">ただし、このアカウントにその他の権限は与えないでください。</span><span class="sxs-lookup"><span data-stu-id="be5c1-176">The account should not be granted any additional permissions.</span></span>  
  
 <span data-ttu-id="be5c1-177">COM+ のプロセス リサイクル機能は、統合アプリケーションでは使えません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-177">The COM+ process recycling features cannot be used on integrated applications.</span></span> <span data-ttu-id="be5c1-178">アプリケーションがこの機能を使用するよう設定されている場合、コンポーネントが COM+ ホスト プロセスとして動作していると、サービスを起動できません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-178">If the application is configured to use process recycling and the components are running in a COM+ hosted process, the service fails to start.</span></span> <span data-ttu-id="be5c1-179">"Web ホスト (インプロセス)" モードであれば、プロセス リサイクル設定は適用されないので問題ありません。</span><span class="sxs-lookup"><span data-stu-id="be5c1-179">This requirement does not include services using the Web-hosted in-process mode because the process recycling settings are not applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="be5c1-180">関連項目</span><span class="sxs-lookup"><span data-stu-id="be5c1-180">See Also</span></span>  
 [<span data-ttu-id="be5c1-181">COM アプリケーションの概要との統合</span><span class="sxs-lookup"><span data-stu-id="be5c1-181">Integrating with COM Applications Overview</span></span>](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)
