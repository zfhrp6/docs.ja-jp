---
title: 信頼できるセッションの概要
ms.date: 03/30/2017
ms.assetid: a7fc4146-ee2c-444c-82d4-ef6faffccc2d
ms.openlocfilehash: 1c5344c2804cf4c17fdc46a7fea5a4a360122b6e
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/04/2018
ms.locfileid: "33497079"
---
# <a name="reliable-sessions-overview"></a>信頼できるセッションの概要

Windows Communication Foundation (WCF) の SOAP リライアブル メッセージの SOAP エンドポイント間でエンド ツー エンドのメッセージ転送の信頼性を提供します。 これにより、信頼性の低いネットワーク上でも、トランスポート エラーや SOAP メッセージ レベルのエラーに対処できます。 具体的には、SOAP またはトランスポート中継局を経由して送信されるメッセージに関して、1 回だけの配信や (オプションで) 順序保証の配信がセッション ベースで提供されます。 セッション ベースの配布は、メッセージの省略可能な順序とのセッションでメッセージをグループ化を提供します。

このトピックでは、信頼できるセッションをする方法について説明と、使用するタイミングと方法をセキュリティで保護します。

## <a name="wcf-reliable-sessions"></a>WCF の信頼できるセッション

WCF の信頼できるセッションは、SOAP リライアブル メッセージ機能は、Ws-reliablemessaging プロトコルで定義されているの実装です。

WCF SOAP リライアブル メッセージ数や、メッセージング エンドポイントを分離する中継ぎ局の種類に関係なく、2 つのエンドポイント間でのエンド ツー エンドの信頼できるセッションを提供します。 これにより、SOAP (HTTP プロキシなど) を使用しないトランスポート手段が含まれます。 や中継ぎ局 SOAP (たとえば、SOAP ベースのルーターやブリッジなど) を使用するエンドポイントの間でメッセージを必要とされます。 信頼できるセッション チャネルをサポートしている*インタラクティブ*通信できるように、このようなチャネルが接続されているサービスが同時に実行し、低待機時間、つまりの条件下でメッセージを処理内で比較的短い時間間隔。 この組み合わせは、それらの間で提供される分離がないように、これらのコンポーネントは一緒に進めるか、ひとまとまりでフェールオーバーを意味します。

信頼できるセッションでは次の 2 種類のエラーがマスクされます。

- SOAP メッセージ レベルのエラー (メッセージの喪失または重複、および送信順序と異なる順序で到着するメッセージを含む)

- トランスポート エラー

信頼できるセッションは、WS-ReliableMessaging プロトコルとメモリ内転送ウィンドウを実装することにより、トランスポート エラーが発生した場合に SOAP メッセージ レベルのエラーをマスクし、接続を再確立します。

信頼できるセッションは、TCP が IP パケットに提供する信頼性を SOAP メッセージに提供します。 TCP ソケット接続では、ノード間で IP パケットが 1 回のみ、正しい順序で転送されます。 信頼できるチャネルでも、これと同じタイプの信頼できる転送が提供されますが、次の点で TCP ソケットの信頼性とは異なります。

- 信頼性は、任意のサイズのバイト パケットに対してではなく、SOAP メッセージ レベルで提供されます。

- 信頼性はトランスポート中立 TCP 経由する転送に対してだけでなく提供されます。

- 信頼性の特定のトランスポート セッション (たとえば、TCP 接続により、セッション) に関連付けられていない使用できると複数のトランスポート セッション順番にまたは同時に信頼できるセッションの有効期間。

- 信頼できるセッションは、送信側と受信側の SOAP エンドポイント間の接続に必要なトランスポート接続の数に関係なく、両者の間で提供されます。 つまり、TCP の信頼性はトランスポート接続が終了する、エンド ツー エンドの信頼性を提供しますが、信頼できるセッションを終了します。

## <a name="reliable-sessions-and-bindings"></a>信頼できるセッションとバインディング

前述のように、信頼できるセッションは、トランスポート中立的なです。 また、要求/応答や双方向など、複数のメッセージ交換パターンで信頼できるセッションを確立することができます。 WCF の信頼できるセッションは、一連のバインディングのプロパティとして公開されます。

使用するエンドポイントでは、信頼できるセッションを使用します。

- HTTP ベース トランスポートの標準バインディング

  - `WsHttpBinding` : 要求/応答または一方向のコントラクトを公開します。

  - ときに、要求/応答または一方向のサービス コントラクト上で信頼できるセッションを使用します。

  - `WsDualHttpBinding` : 双方向、要求/応答、または一方向のコントラクトを公開します。

  - `WsFederationHttpBinding` : 要求/応答または一方向のコントラクトを公開します。

- TCP ベース トランスポートの標準バインディング

  - `NetTcpBinding` : 双方向、要求/応答、または一方向のコントラクトを公開します。

HTTPS などのカスタム バインディングを作成することで、他のバインディングの信頼できるセッションを使用して (に関する問題の詳細については、次を参照してください。<a href="#reliable-sessions-and-security">信頼できるセッションとセキュリティ</a>) または名前付きパイプ バインドします。

基になるチャネルの種類別、上の信頼できるセッションを積み重ねることができ、結果として得られる、信頼できるセッション チャネル形状が変化します。 クライアントとサーバーの両方でサポートされている信頼できるセッション チャネルの種類は、使用される基になるチャネルの種類によって異なります。 次の表では、基になるチャネルの種類ごとに、クライアントでサポートされるセッション チャネルの種類を示します。

| サポートされている信頼できるセッション チャネルの種類&#8224; | `IRequestChannel` | `IRequestSessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :---------------: | :----------------------: | :--------------: | :---------------------: |
| `IOutputSessionChannel`                         | [はい]               | はい                      | はい              | はい                     |
| `IRequestSessionChannel`                        | はい               | はい                      | いいえ               | Ｘ                      |
| `IDuplexSessionChannel`                         | Ｘ                | Ｘ                       | はい              | [はい]                     |

&#8224;サポートされているチャネルの種類は、ジェネリックの使用可能な値`TChannel`に渡されるパラメーター値、<xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelFactory%60%601%28System.ServiceModel.Channels.BindingContext%29>メソッドです。

次の表では、基になるチャネルの種類ごとに、サーバーでサポートされるセッション チャネルの種類を示します。

| サポートされている信頼できるセッション チャネルの種類&#8225; | `IReplyChannel` | `IReplySessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :-------------: | :--------------------: | :--------------: | :---------------------: |
| `IInputSessionChannel`                          | [はい]             | はい                    | はい              | はい                     |
| `IReplySessionChannel`                          | はい             | はい                    | いいえ               | Ｘ                      |
| `IDuplexSessionChannel`                         | Ｘ              | Ｘ                     | はい              | [はい]                     |

&#8225;サポートされているチャネルの種類は、ジェネリックの使用可能な値`TChannel`に渡されるパラメーター値、<xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelListener%60%601%28System.ServiceModel.Channels.BindingContext%29>メソッドです。

## <a name="reliable-sessions-and-security"></a>信頼できるセッションとセキュリティ

信頼できるセッションをセキュリティ保護することが重要通信している双方 (サービスとクライアント) が認証されると、セッションで交換されるメッセージが改ざんされないことを確認してください。 さらに、それぞれ個別の信頼できるセッションの整合性を確保する重要なは。 信頼できるセッションは、表現があり、セキュリティ セッション チャネルで管理するセキュリティ コンテキストにバインドすることによって保護されます。 セキュリティ チャネルによって、セキュリティ セッションが可能になります。 セッション確立中に交換されるセキュリティ トークンは、信頼できるセッションでメッセージをセキュリティで保護するために使用されます。

信頼できるセッションが TCP-s 上にあるときは、TCP セッションが信頼できるセッションに関連付けられます。 そのため、トランスポート セキュリティにより、セキュリティが信頼できるセッションにも関連付けられていることにします。 この場合、接続の再確立は無効になります。

唯一の例外は、HTTPS の使用時です。 Secure Sockets Layer (SSL) セッションは、信頼できるセッションにバインドされていません。 セキュリティ コンテキスト (SSL セッション) を共有しているセッションが; 互いから保護されていないため、脅威は、このこれが原因か、アプリケーションによっては現実的な脅威ができない可能性があります。

## <a name="using-reliable-sessions"></a>信頼できるセッションを使用します。

WCF の信頼できるセッションを使用するのには、信頼できるセッションをサポートするバインディングで、エンドポイントを作成します。 WCF は信頼できるセッションは、システム指定のバインディングの 1 つを使用では、有効になっているか、これは、独自のカスタム バインディングを作成します。

信頼できるセッションが既定でサポートおよび有効化されているシステム定義のバインディングは、次のとおりです。

- <xref:System.ServiceModel.WSDualHttpBinding>

既定で有効にしないオプションとして、信頼できるセッションをサポートするシステム提供のバインディングは、次のとおりです。

- <xref:System.ServiceModel.WSHttpBinding>

- <xref:System.ServiceModel.WSFederationHttpBinding>

- <xref:System.ServiceModel.NetTcpBinding>

カスタム バインディングを作成する方法の例は、次を参照してください。[する方法: HTTPS で、カスタムの信頼できるセッション バインドを作成する](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md)です。

信頼できるセッションをサポートしている WCF バインドの詳細については、次を参照してください。[システム指定のバインディング](../../../../docs/framework/wcf/system-provided-bindings.md)です。

## <a name="when-to-use-reliable-sessions"></a>信頼できるセッションを使用する場合

アプリケーションで信頼できるセッションを使用するタイミングを理解しておく必要です。 WCF では、同時にアクティブで有効であるエンドポイント間で信頼できるセッションをサポートします。 アプリケーションでは、エンドポイントのいずれかが必要な場合は、時間、一定期間使用できないし、信頼性を実現するためにキューを使用します。

シナリオでは、2 つのエンドポイントを TCP 経由で接続されている必要がある場合、TCP は信頼性の高いメッセージ交換を提供するための十分なあります。 TCP 確実に信頼できるセッションを使用する必要はありませんが、パケットは 1 回だけ、正しい順序で到着します。

シナリオでは、次の特性のいずれか、する必要がありますに深刻な使用を検討して、信頼できるセッションです。

- SOAP ルーターなどの SOAP 中継ぎ局

- プロキシ中継ぎ局またはトランスポート ブリッジ

- 断続的な接続

- HTTP 経由でセッション

## <a name="see-also"></a>関連項目

[バインディングを使用してサービスとクライアントを構成するには](../../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md)   
[WS 信頼できるセッション](../../../../docs/framework/wcf/samples/ws-reliable-session.md)
