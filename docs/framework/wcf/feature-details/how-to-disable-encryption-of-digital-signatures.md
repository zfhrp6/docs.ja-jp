---
title: '方法 : デジタル署名の暗号化を無効にする'
ms.date: 03/30/2017
ms.assetid: fd174313-ad81-4dca-898a-016ccaff8187
ms.openlocfilehash: 074a32f6a69f8353568e76c99f4b65aece813f55
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/04/2018
ms.locfileid: "33491661"
---
# <a name="how-to-disable-encryption-of-digital-signatures"></a><span data-ttu-id="68a8c-102">方法 : デジタル署名の暗号化を無効にする</span><span class="sxs-lookup"><span data-stu-id="68a8c-102">How to: Disable Encryption of Digital Signatures</span></span>
<span data-ttu-id="68a8c-103">既定では、メッセージは署名され、署名はデジタル暗号化されます。</span><span class="sxs-lookup"><span data-stu-id="68a8c-103">By default, a message is signed and the signature is digitally encrypted.</span></span> <span data-ttu-id="68a8c-104">これは、<xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement> または <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> のインスタンスを使用してカスタム バインディングを作成し、いずれかのクラスの `MessageProtectionOrder` プロパティを <xref:System.ServiceModel.Security.MessageProtectionOrder> 列挙値に設定することによって制御されます。</span><span class="sxs-lookup"><span data-stu-id="68a8c-104">This is controlled by creating a custom binding with an instance of the <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement> or the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> and setting the `MessageProtectionOrder` property of either class to a <xref:System.ServiceModel.Security.MessageProtectionOrder> enumeration value.</span></span> <span data-ttu-id="68a8c-105">既定値は、<xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncryptAndEncryptSignature> です。</span><span class="sxs-lookup"><span data-stu-id="68a8c-105">The default is <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncryptAndEncryptSignature>.</span></span> <span data-ttu-id="68a8c-106">このプロセスは、単に署名して暗号化する場合よりも、メッセージ全体のサイズによって最大で 30 パーセントほど長い時間がかかります (メッセージが小さいほどパフォーマンスへの影響は大きくなります)。</span><span class="sxs-lookup"><span data-stu-id="68a8c-106">This process consumes up to 30 percent more time than simply signing and encrypting based on the overall message size (the smaller the message, the greater the performance impact).</span></span> <span data-ttu-id="68a8c-107">ただし、署名の暗号化を無効にすると、攻撃者がメッセージの内容を予想できるようになる危険性があります。</span><span class="sxs-lookup"><span data-stu-id="68a8c-107">Disabling encryption of the signature, however, might allow an attacker to guess the content of the message.</span></span> <span data-ttu-id="68a8c-108">その理由は、メッセージ内のすべての署名部分のプレーン テキストのハッシュ コードが署名要素に含まれるからです。</span><span class="sxs-lookup"><span data-stu-id="68a8c-108">This is possible because the signature element contains the hash code of the plain text of every signed part in the message.</span></span> <span data-ttu-id="68a8c-109">たとえば、メッセージ本体は既定で暗号化されますが、暗号化されていない署名には、暗号化される前のメッセージ本体のハッシュ コードが含まれます。</span><span class="sxs-lookup"><span data-stu-id="68a8c-109">For example, although the message body is encrypted by default, the unencrypted signature contains the hash code of the message body before the encryption.</span></span> <span data-ttu-id="68a8c-110">署名および暗号化された部分に指定できる一連の値が小さい場合、攻撃者にハッシュ値を参照され、内容を推測されてしまうおそれがあります。</span><span class="sxs-lookup"><span data-stu-id="68a8c-110">If the set of possible values for the signed and encrypted part is small, an attacker might be able to deduce the contents by looking at the hash value.</span></span> <span data-ttu-id="68a8c-111">署名を暗号化すると、このような攻撃は軽減します。</span><span class="sxs-lookup"><span data-stu-id="68a8c-111">Encrypting the signature mitigates this attack vector.</span></span>  
  
 <span data-ttu-id="68a8c-112">そのため、署名の暗号化を無効にするのは、コンテンツの重要性が低いか、または指定できる一連のコンテンツの値が大きくて非決定性があり、前述の攻撃を軽減するよりもパフォーマンスの向上が重要な場合に限定してください。</span><span class="sxs-lookup"><span data-stu-id="68a8c-112">Therefore, disable encryption of the signature only when the value of the content is low or the set of possible content values is large and nondeterministic, and the performance gain is more important than mitigating the attack described above.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="68a8c-113">メッセージ内に暗号化する対象が存在しない場合は、<xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> プロパティまたは <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> プロパティが <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncryptAndEncryptSignature> に設定されていても、署名要素は暗号化されません。</span><span class="sxs-lookup"><span data-stu-id="68a8c-113">If there is nothing in the message that is encrypted, the signature element is not encrypted, even when the <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncryptAndEncryptSignature>.</span></span> <span data-ttu-id="68a8c-114">この動作は、システム指定のバインディングでも発生します。すべてのシステム指定のバインディングには、メッセージを保護する順序が `SignBeforeEncryptAndEncryptSignature` に設定されています。</span><span class="sxs-lookup"><span data-stu-id="68a8c-114">This behavior occurs even with system-provided bindings; all system-provided bindings have the message protection order set to `SignBeforeEncryptAndEncryptSignature`.</span></span> <span data-ttu-id="68a8c-115">ただし、Web サービス記述言語 (WSDL) WCF は生成がまだ含まれている、`<sp:EncryptSignature>`アサーションです。</span><span class="sxs-lookup"><span data-stu-id="68a8c-115">However, the Web Services Description Language (WSDL) WCF generates will still contain the `<sp:EncryptSignature>` assertion.</span></span>  
  
### <a name="to-disable-digital-signing"></a><span data-ttu-id="68a8c-116">デジタル署名を無効にするには</span><span class="sxs-lookup"><span data-stu-id="68a8c-116">To disable digital signing</span></span>  
  
1.  <span data-ttu-id="68a8c-117"><xref:System.ServiceModel.Channels.CustomBinding> を作成します。</span><span class="sxs-lookup"><span data-stu-id="68a8c-117">Create a <xref:System.ServiceModel.Channels.CustomBinding>.</span></span> <span data-ttu-id="68a8c-118">詳細については、次を参照してください。[する方法: SecurityBindingElement 作成するカスタム バインドを使用して、](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md)です。</span><span class="sxs-lookup"><span data-stu-id="68a8c-118">For more information, see [How to: Create a Custom Binding Using the SecurityBindingElement](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-binding-using-the-securitybindingelement.md).</span></span>  
  
2.  <span data-ttu-id="68a8c-119"><xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement> または <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> をバインディング コレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="68a8c-119">Add either an <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement> or a <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement> to the binding collection.</span></span>  
  
3.  <span data-ttu-id="68a8c-120"><xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> プロパティを <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncrypt> に設定するか、または <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> プロパティを <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncrypt> に設定します。</span><span class="sxs-lookup"><span data-stu-id="68a8c-120">Set the <xref:System.ServiceModel.Channels.AsymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncrypt>, or set the <xref:System.ServiceModel.Channels.SymmetricSecurityBindingElement.MessageProtectionOrder%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.Security.MessageProtectionOrder.SignBeforeEncrypt>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="68a8c-121">関連項目</span><span class="sxs-lookup"><span data-stu-id="68a8c-121">See Also</span></span>  
 [<span data-ttu-id="68a8c-122">カスタム バインドを使用したセキュリティ機能</span><span class="sxs-lookup"><span data-stu-id="68a8c-122">Security Capabilities with Custom Bindings</span></span>](../../../../docs/framework/wcf/feature-details/security-capabilities-with-custom-bindings.md)
