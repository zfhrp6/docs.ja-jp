---
title: ドラッグ アンド ドロップの概要
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-wpf
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- drag-and-drop [WPF], implementing
- drag sources [WPF], drag-and-drop
- data transfer [WPF], drag-and-drop
- drag-and-drop [WPF], about
- drag-and-drop [WPF], events
- drop targets [WPF], drag-and-drop
ms.assetid: 1a5b27b0-0ac5-4cdf-86c0-86ac0271fa64
caps.latest.revision: 31
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: fe34933c19e7f8a50d144cad99b99decbd501965
ms.sourcegitcommit: 2042de78fcdceebb6b8ac4b7a292b93e8782cbf5
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/27/2018
---
# <a name="drag-and-drop-overview"></a><span data-ttu-id="308bd-102">ドラッグ アンド ドロップの概要</span><span class="sxs-lookup"><span data-stu-id="308bd-102">Drag and Drop Overview</span></span>
<span data-ttu-id="308bd-103">このトピックでは、[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] アプリケーションでのドラッグ アンド ドロップのサポートの概要について説明します。</span><span class="sxs-lookup"><span data-stu-id="308bd-103">This topic provides an overview of drag-and-drop support in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] applications.</span></span> <span data-ttu-id="308bd-104">一般的に、ドラッグ アンド ドロップとは、マウス (または何らかのポインティング デバイス) を使用して 1 つ以上のオブジェクトを選択し、これらのオブジェクトを [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] の目的のドロップ先までドラッグしてからドロップするデータ転送方式をいいます。</span><span class="sxs-lookup"><span data-stu-id="308bd-104">Drag-and-drop commonly refers to a method of data transfer that involves using a mouse (or some other pointing device) to select one or more objects, dragging these objects over some desired drop target in the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], and dropping them.</span></span>  
  
  
<a name="Drag_and_Drop_Support"></a>   
## <a name="drag-and-drop-support-in-wpf"></a><span data-ttu-id="308bd-105">WPF でのドラッグ アンド ドロップのサポート</span><span class="sxs-lookup"><span data-stu-id="308bd-105">Drag-and-Drop Support in WPF</span></span>  
 <span data-ttu-id="308bd-106">ドラッグ アンド ドロップ操作には、一般に、ドラッグするオブジェクトがドラッグを始めるドラッグ元と、ドロップするオブジェクトを受け取るドロップ先という 2 者があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-106">Drag-and-drop operations typically involve two parties: a drag source from which the dragged object originates and a drop target which receives the dropped object.</span></span>  <span data-ttu-id="308bd-107">ドラッグ元とドロップ先は、同じアプリケーションまたは異なるアプリケーションの UI 要素になることがあります。</span><span class="sxs-lookup"><span data-stu-id="308bd-107">The drag source and drop target may be UI elements in the same application or a different application.</span></span>  
  
 <span data-ttu-id="308bd-108">ドラッグ アンド ドロップで操作できるオブジェクトの種類と数は、まったく任意です。</span><span class="sxs-lookup"><span data-stu-id="308bd-108">The type and number of objects that can be manipulated with drag-and-drop is completely arbitrary.</span></span> <span data-ttu-id="308bd-109">たとえば、ファイル、フォルダー、およびコンテンツの選択項目は、ドラッグ アンド ドロップ操作を介して操作する、より一般的なオブジェクトの一部です。</span><span class="sxs-lookup"><span data-stu-id="308bd-109">For example, files, folders, and selections of content are some of the more common objects manipulated through drag-and-drop operations.</span></span>  
  
 <span data-ttu-id="308bd-110">ドラッグ アンド ドロップ操作中に実行される特定の操作はアプリケーション固有で、多くの場合コンテキストによって決定されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-110">The particular actions performed during a drag-and-drop operation are application specific, and often determined by context.</span></span>  <span data-ttu-id="308bd-111">たとえば、同じストレージ デバイスで選択したファイルをあるフォルダーから別のフォルダーにドラッグすると、既定ではファイルが移動します。一方、[!INCLUDE[TLA#tla_unc](../../../../includes/tlasharptla-unc-md.md)] 共有からローカル フォルダーにファイルをドラッグすると、既定ではファイルがコピーされます。</span><span class="sxs-lookup"><span data-stu-id="308bd-111">For example, dragging a selection of files from one folder to another on the same storage device moves the files by default, whereas dragging files from a [!INCLUDE[TLA#tla_unc](../../../../includes/tlasharptla-unc-md.md)] share to a local folder copies the files by default.</span></span>  
  
 <span data-ttu-id="308bd-112">
          [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] が提供するドラッグ アンド ドロップ機能は、さまざまなドラッグ アンド ドロップのシナリオをサポートするよう、非常に柔軟かつカスタマイズできるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="308bd-112">The drag-and-drop facilities provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are designed to be highly flexible and customizable to support a wide variety of drag-and-drop scenarios.</span></span>  <span data-ttu-id="308bd-113">ドラッグ アンド ドロップでは、1 つのアプリケーション内で、または異なるアプリケーションの間でのオブジェクトの操作をサポートします。</span><span class="sxs-lookup"><span data-stu-id="308bd-113">Drag-and-drop supports manipulating objects within a single application, or between different applications.</span></span> <span data-ttu-id="308bd-114">ドラッグ アンド ドロップの間で[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]アプリケーションおよびその他の Windows アプリケーションも完全にサポートします。</span><span class="sxs-lookup"><span data-stu-id="308bd-114">Dragging-and-dropping between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications and other Windows applications is also fully supported.</span></span>  
  
 <span data-ttu-id="308bd-115">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] では、任意の <xref:System.Windows.UIElement> または <xref:System.Windows.ContentElement> がドラッグ アンド ドロップに参加できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-115">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], any <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> can participate in drag-and-drop.</span></span> <span data-ttu-id="308bd-116">ドラッグ アンド ドロップ操作に必要なイベントとメソッドは、<xref:System.Windows.DragDrop> クラスで定義されています。</span><span class="sxs-lookup"><span data-stu-id="308bd-116">The events and methods required for drag-and-drop operations are defined in the <xref:System.Windows.DragDrop> class.</span></span> <span data-ttu-id="308bd-117"><xref:System.Windows.UIElement> と <xref:System.Windows.ContentElement> クラスには、<xref:System.Windows.DragDrop> のアタッチ済みのイベントのエイリアスが含まれています。これにより、<xref:System.Windows.UIElement> や <xref:System.Windows.ContentElement> が基本要素として継承されるときに、イベントがクラスのメンバーとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-117">The <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> classes contain aliases for the <xref:System.Windows.DragDrop> attached events so that the events appear in the class members list when a <xref:System.Windows.UIElement> or <xref:System.Windows.ContentElement> is inherited as a base element.</span></span> <span data-ttu-id="308bd-118">これらのイベントにアタッチされたイベント ハンドラーは、基になる <xref:System.Windows.DragDrop> のアタッチ済みのイベントにアタッチされ、同じイベント データのインスタンスを受信します。</span><span class="sxs-lookup"><span data-stu-id="308bd-118">Event handlers that are attached to these events are attached to the underlying <xref:System.Windows.DragDrop> attached event and receive the same event data instance.</span></span> <span data-ttu-id="308bd-119">詳細については、<xref:System.Windows.UIElement.Drop?displayProperty=nameWithType> イベントを参照してください。</span><span class="sxs-lookup"><span data-stu-id="308bd-119">For more information, see the <xref:System.Windows.UIElement.Drop?displayProperty=nameWithType> event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="308bd-120">OLE のドラッグ アンド ドロップは、インターネット ゾーンにある間は機能しません。</span><span class="sxs-lookup"><span data-stu-id="308bd-120">OLE drag-and-drop does not work while in the Internet zone.</span></span>  
  
<a name="Data_Transfer"></a>   
## <a name="data-transfer"></a><span data-ttu-id="308bd-121">データ転送</span><span class="sxs-lookup"><span data-stu-id="308bd-121">Data Transfer</span></span>  
 <span data-ttu-id="308bd-122">ドラッグ アンド ドロップは、より一般的な領域のデータ転送の一部です。</span><span class="sxs-lookup"><span data-stu-id="308bd-122">Drag-and-drop is part of the more general area of data transfer.</span></span> <span data-ttu-id="308bd-123">データ転送には、ドラッグ アンド ドロップ操作およびコピーと貼り付けの操作があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-123">Data transfer includes drag-and-drop and copy-and-paste operations.</span></span> <span data-ttu-id="308bd-124">ドラッグ アンド ドロップ操作は、システムのクリップボードを使用して、あるオブジェクトまたはアプリケーションから別のオブジェクトまたはアプリケーションへのデータ転送に使用する、コピーと貼り付け操作または切り取りと貼り付け操作に似ています。</span><span class="sxs-lookup"><span data-stu-id="308bd-124">A drag-and-drop operation is analogous to a copy-and-paste or cut-and-paste operation that is used to transfer data from one object or application to another by using the system clipboard.</span></span> <span data-ttu-id="308bd-125">いずれの種類の操作でも、次のものが必要です。</span><span class="sxs-lookup"><span data-stu-id="308bd-125">Both types of operations require:</span></span>  
  
-   <span data-ttu-id="308bd-126">データを提供するソース オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="308bd-126">A source object that provides the data.</span></span>  
  
-   <span data-ttu-id="308bd-127">転送されたデータを一時的に格納する方法。</span><span class="sxs-lookup"><span data-stu-id="308bd-127">A way to temporarily store the transferred data.</span></span>  
  
-   <span data-ttu-id="308bd-128">データを受け取るターゲット オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="308bd-128">A target object that receives the data.</span></span>  
  
 <span data-ttu-id="308bd-129">コピーと貼り付け操作では、システムのクリップボードを使用して、転送されたデータを一時的に保存します。ドラッグ アンド ドロップ操作では、<xref:System.Windows.DataObject> を使用してデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="308bd-129">In a copy-and-paste operation, the system clipboard is used to temporarily store the transferred data; in a drag-and-drop operation, a <xref:System.Windows.DataObject> is used to store the data.</span></span> <span data-ttu-id="308bd-130">データ オブジェクトは、概念的に、実際のデータと対応するデータ形式の識別子を格納する 1 組以上の <xref:System.Object> で構成されています。</span><span class="sxs-lookup"><span data-stu-id="308bd-130">Conceptually, a data object consists of one or more pairs of an <xref:System.Object> that contains the actual data, and a corresponding data format identifier.</span></span>  
  
 <span data-ttu-id="308bd-131">ドラッグ元では、静的な <xref:System.Windows.DragDrop.DoDragDrop%2A?displayProperty=nameWithType> メソッドを呼び出して、転送するデータをそのメソッドに渡すことでドラッグ アンド ドロップ操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="308bd-131">The drag source initiates a drag-and-drop operation by calling the static <xref:System.Windows.DragDrop.DoDragDrop%2A?displayProperty=nameWithType> method and passing the transferred data to it.</span></span> <span data-ttu-id="308bd-132">必要な場合、<xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドは <xref:System.Windows.DataObject> にデータを自動的にラップします。</span><span class="sxs-lookup"><span data-stu-id="308bd-132">The <xref:System.Windows.DragDrop.DoDragDrop%2A> method will automatically wrap the data in a <xref:System.Windows.DataObject> if necessary.</span></span> <span data-ttu-id="308bd-133">データ形式の制御を拡大するには、データを <xref:System.Windows.DataObject> メソッドに渡す前に <xref:System.Windows.DragDrop.DoDragDrop%2A> にラップします。</span><span class="sxs-lookup"><span data-stu-id="308bd-133">For greater control over the data format, you can wrap the data in a <xref:System.Windows.DataObject> before passing it to the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="308bd-134">ドロップ先は、<xref:System.Windows.DataObject> からデータを抽出する役割を務めます。</span><span class="sxs-lookup"><span data-stu-id="308bd-134">The drop target is responsible for extracting the data from the <xref:System.Windows.DataObject>.</span></span> <span data-ttu-id="308bd-135">データ オブジェクトの操作の詳細については、「[データとデータ オブジェクト](../../../../docs/framework/wpf/advanced/data-and-data-objects.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="308bd-135">For more information about working with data objects, see [Data and Data Objects](../../../../docs/framework/wpf/advanced/data-and-data-objects.md).</span></span>  
  
 <span data-ttu-id="308bd-136">ドラッグ アンド ドロップ操作のソースとターゲットは UI 要素ですが、一般に、実際に転送されているデータには視覚的表現はありません。</span><span class="sxs-lookup"><span data-stu-id="308bd-136">The source and target of a drag-and-drop operation are UI elements; however, the data that is actually being transferred typically does not have a visual representation.</span></span> <span data-ttu-id="308bd-137">Windows エクスプローラーでファイルをドラッグするときに起こるような視覚的表現を、ドラッグするデータで実行するように、コードを記述することができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-137">You can write code to provide a visual representation of the data that is dragged, such as occurs when dragging files in Windows Explorer.</span></span> <span data-ttu-id="308bd-138">既定では、データを移動するのかコピーするのかなど、ドラッグ アンド ドロップ操作によりデータに起こる効果を表すようにカーソルを変更して、ユーザーにフィードバックします。</span><span class="sxs-lookup"><span data-stu-id="308bd-138">By default, feedback is provided to the user by changing the cursor to represent the effect that the drag-and-drop operation will have on the data, such as whether the data will be moved or copied.</span></span>  
  
### <a name="drag-and-drop-effects"></a><span data-ttu-id="308bd-139">ドラッグ アンド ドロップの効果</span><span class="sxs-lookup"><span data-stu-id="308bd-139">Drag-and-Drop Effects</span></span>  
 <span data-ttu-id="308bd-140">ドラッグ アンド ドロップ操作には、転送するデータにさまざまな効果を持たせることができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-140">Drag-and-drop operations can have different effects on the transferred data.</span></span> <span data-ttu-id="308bd-141">たとえば、データをコピーしたり、データを移動したりできるなどです。</span><span class="sxs-lookup"><span data-stu-id="308bd-141">For example, you can copy the data or you can move the data.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="308bd-142"> では、ドラッグ アンド ドロップ操作の効果を指定するために使用できる <xref:System.Windows.DragDropEffects> 列挙体を定義します。</span><span class="sxs-lookup"><span data-stu-id="308bd-142"> defines a <xref:System.Windows.DragDropEffects> enumeration that you can use to specify the effect of a drag-and-drop operation.</span></span> <span data-ttu-id="308bd-143">ドラッグ元では、ソースが <xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドで許可する効果を指定できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-143">In the drag source, you can specify the effects that the source will allow in the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="308bd-144">ドロップ先では、<xref:System.Windows.DragEventArgs.Effects%2A> クラスの <xref:System.Windows.DragEventArgs> プロパティでターゲットの目的の効果を指定できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-144">In the drop target, you can specify the effect that the target intends in the <xref:System.Windows.DragEventArgs.Effects%2A> property of the <xref:System.Windows.DragEventArgs> class.</span></span> <span data-ttu-id="308bd-145"><xref:System.Windows.DragDrop.DragOver> イベントでドロップ先の目的の効果を指定した場合、その情報が <xref:System.Windows.DragDrop.GiveFeedback> イベントのドラッグ元に渡されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-145">When the drop target specifies its intended effect in the <xref:System.Windows.DragDrop.DragOver> event, that information is passed back to the drag source in the <xref:System.Windows.DragDrop.GiveFeedback> event.</span></span> <span data-ttu-id="308bd-146">ドラッグ元では、この情報を使用して、ドロップ先がデータにどのような効果を起こそうとしているかをユーザーに伝えます。</span><span class="sxs-lookup"><span data-stu-id="308bd-146">The drag source uses this information to inform the user what effect the drop target intends to have on the data.</span></span> <span data-ttu-id="308bd-147">データがドロップされると、ドロップ先では <xref:System.Windows.DragDrop.Drop> イベントでの実際の効果を指定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-147">When the data is dropped, the drop target specifies its actual effect in the <xref:System.Windows.DragDrop.Drop> event.</span></span> <span data-ttu-id="308bd-148">この情報は、<xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドの戻り値としてドラッグ元に渡されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-148">That information is passed back to the drag source as the return value of the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="308bd-149">ドラッグ元の `allowedEffects` の一覧にない効果をドロップ先が返す場合、ドラッグ アンド ドロップ操作は取り消され、データ転送は発生しません。</span><span class="sxs-lookup"><span data-stu-id="308bd-149">If the drop target returns an effect that is not in the drag sources list of `allowedEffects`, the drag-and-drop operation is cancelled without any data transfer occurring.</span></span>  
  
 <span data-ttu-id="308bd-150">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] では、ドラッグ アンド ドロップ操作の効果に関しては、<xref:System.Windows.DragDropEffects> 値はドラッグ元とドロップ先間の通信にのみ使用されるということを覚えておくのは重要です。</span><span class="sxs-lookup"><span data-stu-id="308bd-150">It is important to remember that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the <xref:System.Windows.DragDropEffects> values are only used to provide communication between the drag source and the drop target regarding the effects of the drag-and-drop operation.</span></span> <span data-ttu-id="308bd-151">ドラッグ アンド ドロップ操作の実際の効果は、アプリケーションで適切なコードを記述することに依存します。</span><span class="sxs-lookup"><span data-stu-id="308bd-151">The actual effect of the drag-and-drop operation depends on you to write the appropriate code in your application.</span></span>  
  
 <span data-ttu-id="308bd-152">たとえば、ドロップ先では、ドロップ先にデータをドロップすることはデータが移動することと指定される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-152">For example, the drop target might specify that the effect of dropping data on it is to move the data.</span></span> <span data-ttu-id="308bd-153">ただし、データを移動するには、データがターゲット要素に追加されるとともに、ソース要素から削除される必要があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-153">However, to move the data, it must be both added to the target element and removed from the source element.</span></span> <span data-ttu-id="308bd-154">ソース要素は、データの移動を許可していますが、ソース要素からデータを削除するコードを指定しない場合、最終的にデータは移動ではなく、コピーされるという結果になります。</span><span class="sxs-lookup"><span data-stu-id="308bd-154">The source element might indicate that it allows moving the data, but if you do not provide the code to remove the data from the source element, the end result will be that the data is copied, and not moved.</span></span>  
  
<a name="Drag_and_Drop_Events"></a>   
## <a name="drag-and-drop-events"></a><span data-ttu-id="308bd-155">ドラッグ アンド ドロップのイベント</span><span class="sxs-lookup"><span data-stu-id="308bd-155">Drag-and-Drop Events</span></span>  
 <span data-ttu-id="308bd-156">ドラッグ アンド ドロップの操作は、イベント ドリブン モデルをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="308bd-156">Drag-and-drop operations support an event driven model.</span></span>  <span data-ttu-id="308bd-157">ドラッグ元とドロップ先の両方でイベントの標準セットを使用して、ドラッグ アンド ドロップの操作を処理します。</span><span class="sxs-lookup"><span data-stu-id="308bd-157">Both the drag source and the drop target use a standard set of events to handle drag-and-drop operations.</span></span>  <span data-ttu-id="308bd-158">次の表は、標準のドラッグ アンド ドロップのイベントをまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="308bd-158">The following tables summarize the standard drag-and-drop events.</span></span> <span data-ttu-id="308bd-159">これらは、<xref:System.Windows.DragDrop> クラスでアタッチされるイベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-159">These are attached events on the <xref:System.Windows.DragDrop> class.</span></span> <span data-ttu-id="308bd-160">アタッチされるイベントの詳細については、「[アタッチされるイベントの概要](../../../../docs/framework/wpf/advanced/attached-events-overview.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="308bd-160">For more information about attached events, see [Attached Events Overview](../../../../docs/framework/wpf/advanced/attached-events-overview.md).</span></span>  
  
### <a name="drag-source-events"></a><span data-ttu-id="308bd-161">ドラッグ元のイベント</span><span class="sxs-lookup"><span data-stu-id="308bd-161">Drag Source Events</span></span>  
  
|<span data-ttu-id="308bd-162">イベント</span><span class="sxs-lookup"><span data-stu-id="308bd-162">Event</span></span>|<span data-ttu-id="308bd-163">まとめ</span><span class="sxs-lookup"><span data-stu-id="308bd-163">Summary</span></span>|  
|-----------|-------------|  
|<xref:System.Windows.DragDrop.GiveFeedback>|<span data-ttu-id="308bd-164">このイベントは、ドラッグ アンド ドロップ操作中に継続的に発生し、ドロップ ソースがユーザーに情報をフィードバックできるようにします。</span><span class="sxs-lookup"><span data-stu-id="308bd-164">This event occurs continuously during a drag-and-drop operation, and enables the drop source to give feedback information to the user.</span></span> <span data-ttu-id="308bd-165">このフィードバックは、通常、マウス ポインターの外観を変えて、ドロップ先が許可する効果を示すことで実行されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-165">This feedback is commonly given by changing the appearance of the mouse pointer to indicate the effects allowed by the drop target.</span></span>  <span data-ttu-id="308bd-166">これは、バブリング イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-166">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.QueryContinueDrag>|<span data-ttu-id="308bd-167">このイベントは、ドラッグ アンド ドロップ操作時にキーボードやマウス ボタンの状態が変化し、ドロップ ソースがキーやボタンの状態によってドラッグ アンド ドロップ操作の取り消しができるようになったときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-167">This event occurs when there is a change in the keyboard or mouse button states during a drag-and-drop operation, and enables the drop source to cancel the drag-and-drop operation depending on the key/button states.</span></span> <span data-ttu-id="308bd-168">これは、バブリング イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-168">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewGiveFeedback>|<span data-ttu-id="308bd-169">トンネリング バージョンの <xref:System.Windows.DragDrop.GiveFeedback> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-169">Tunneling version of <xref:System.Windows.DragDrop.GiveFeedback>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewQueryContinueDrag>|<span data-ttu-id="308bd-170">トンネリング バージョンの <xref:System.Windows.DragDrop.QueryContinueDrag> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-170">Tunneling version of <xref:System.Windows.DragDrop.QueryContinueDrag>.</span></span>|  
  
### <a name="drop-target-events"></a><span data-ttu-id="308bd-171">ドロップ先のイベント</span><span class="sxs-lookup"><span data-stu-id="308bd-171">Drop Target Events</span></span>  
  
|<span data-ttu-id="308bd-172">イベント</span><span class="sxs-lookup"><span data-stu-id="308bd-172">Event</span></span>|<span data-ttu-id="308bd-173">まとめ</span><span class="sxs-lookup"><span data-stu-id="308bd-173">Summary</span></span>|  
|-----------|-------------|  
|<xref:System.Windows.DragDrop.DragEnter>|<span data-ttu-id="308bd-174">このイベントは、オブジェクトがドロップ先の境界の中にドラッグされるときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-174">This event occurs when an object is dragged into the drop target's boundary.</span></span> <span data-ttu-id="308bd-175">これは、バブリング イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-175">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.DragLeave>|<span data-ttu-id="308bd-176">このイベントは、オブジェクトがドロップ先の境界の外にドラッグされるときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-176">This event occurs when an object is dragged out of the drop target's boundary.</span></span>  <span data-ttu-id="308bd-177">これは、バブリング イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-177">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.DragOver>|<span data-ttu-id="308bd-178">このイベントは、オブジェクトがドロップ先の境界内でドラッグ (移動) する間、継続的に発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-178">This event occurs continuously while an object is dragged (moved) within the drop target's boundary.</span></span> <span data-ttu-id="308bd-179">これは、バブリング イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-179">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.Drop>|<span data-ttu-id="308bd-180">このイベントは、オブジェクトがドロップ先にドロップするときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-180">This event occurs when an object is dropped on the drop target.</span></span>  <span data-ttu-id="308bd-181">これは、バブリング イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-181">This is a bubbling event.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDragEnter>|<span data-ttu-id="308bd-182">トンネリング バージョンの <xref:System.Windows.DragDrop.DragEnter> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-182">Tunneling version of <xref:System.Windows.DragDrop.DragEnter>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDragLeave>|<span data-ttu-id="308bd-183">トンネリング バージョンの <xref:System.Windows.DragDrop.DragLeave> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-183">Tunneling version of <xref:System.Windows.DragDrop.DragLeave>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDragOver>|<span data-ttu-id="308bd-184">トンネリング バージョンの <xref:System.Windows.DragDrop.DragOver> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-184">Tunneling version of <xref:System.Windows.DragDrop.DragOver>.</span></span>|  
|<xref:System.Windows.DragDrop.PreviewDrop>|<span data-ttu-id="308bd-185">トンネリング バージョンの <xref:System.Windows.DragDrop.Drop> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-185">Tunneling version of <xref:System.Windows.DragDrop.Drop>.</span></span>|  
  
 <span data-ttu-id="308bd-186">オブジェクトのインスタンスのドラッグ アンド ドロップ イベントを処理するには、前述の表に一覧表示されたイベントにハンドラーを追加します。</span><span class="sxs-lookup"><span data-stu-id="308bd-186">To handle drag-and-drop events for instances of an object, add handlers for the events listed in the preceding tables.</span></span> <span data-ttu-id="308bd-187">クラス レベルでドラッグ アンド ドロップ イベントを処理するには、対応する仮想 On*Event イベントおよび On\*PreviewEvent メソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="308bd-187">To handle drag-and-drop events at the class level, override the corresponding virtual On*Event and On\*PreviewEvent methods.</span></span> <span data-ttu-id="308bd-188">詳細については、「[制御の基底クラスによるルーティング イベントのクラスの処理](../../../../docs/framework/wpf/advanced/marking-routed-events-as-handled-and-class-handling.md#Class_Handling_of_Routed_Events)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="308bd-188">For more information, see [Class Handling of Routed Events by Control Base Classes](../../../../docs/framework/wpf/advanced/marking-routed-events-as-handled-and-class-handling.md#Class_Handling_of_Routed_Events).</span></span>  
  
<a name="Implementing_Drag_And_Drop"></a>   
## <a name="implementing-drag-and-drop"></a><span data-ttu-id="308bd-189">ドラッグ アンド ドロップの実装</span><span class="sxs-lookup"><span data-stu-id="308bd-189">Implementing Drag-and-Drop</span></span>  
 <span data-ttu-id="308bd-190">UI 要素は、ドラッグ元、ドロップ先、またはその両方になれます。</span><span class="sxs-lookup"><span data-stu-id="308bd-190">A UI element can be a drag source, a drop target, or both.</span></span> <span data-ttu-id="308bd-191">基本的なドラッグ アンド ドロップを実装するには、ドラッグ アンド ドロップ操作を開始して、ドロップしたデータを処理するコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="308bd-191">To implement basic drag-and-drop, you write code to initiate the drag-and-drop operation and to process the dropped data.</span></span> <span data-ttu-id="308bd-192">オプションのドラッグ アンド ドロップ イベントを処理すると、ドラッグ アンド ドロップの操作性を拡張できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-192">You can enhance the drag-and-drop experience by handling optional drag-and-drop events.</span></span>  
  
 <span data-ttu-id="308bd-193">基本的なドラッグ アンド ドロップを実装するには、次のタスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="308bd-193">To implement basic drag-and-drop, you will complete the following tasks:</span></span>  
  
-   <span data-ttu-id="308bd-194">ドラッグ元となる要素を特定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-194">Identify the element that will be a drag source.</span></span> <span data-ttu-id="308bd-195">ドラッグ元には <xref:System.Windows.UIElement> または <xref:System.Windows.ContentElement> を指定できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-195">A drag source can be a <xref:System.Windows.UIElement> or a <xref:System.Windows.ContentElement>.</span></span>  
  
-   <span data-ttu-id="308bd-196">ドラッグ アンド ドロップ操作を開始するドラッグ元のイベント ハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="308bd-196">Create an event handler on the drag source that will initiate the drag-and-drop operation.</span></span> <span data-ttu-id="308bd-197">通常、イベントは <xref:System.Windows.UIElement.MouseMove> イベントです。</span><span class="sxs-lookup"><span data-stu-id="308bd-197">The event is typically the <xref:System.Windows.UIElement.MouseMove> event.</span></span>  
  
-   <span data-ttu-id="308bd-198">ドラッグ アンド ドロップ操作を開始するには、ドラッグ元のイベント ハンドラーで <xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="308bd-198">In the drag source event handler, call the <xref:System.Windows.DragDrop.DoDragDrop%2A> method to initiate the drag-and-drop operation.</span></span> <span data-ttu-id="308bd-199"><xref:System.Windows.DragDrop.DoDragDrop%2A> の呼び出しで、ドラッグ元、転送するデータ、および許可される効果を指定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-199">In the <xref:System.Windows.DragDrop.DoDragDrop%2A> call, specify the drag source, the data to be transferred, and the allowed effects.</span></span>  
  
-   <span data-ttu-id="308bd-200">ドロップ先となる要素を特定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-200">Identify the element that will be a drop target.</span></span> <span data-ttu-id="308bd-201">ドロップ先には、<xref:System.Windows.UIElement> または <xref:System.Windows.ContentElement> を指定できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-201">A drop target can be <xref:System.Windows.UIElement> or a <xref:System.Windows.ContentElement>.</span></span>  
  
-   <span data-ttu-id="308bd-202">ドロップ先で、<xref:System.Windows.UIElement.AllowDrop%2A> プロパティを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-202">On the drop target, set the <xref:System.Windows.UIElement.AllowDrop%2A> property to `true`.</span></span>  
  
-   <span data-ttu-id="308bd-203">ドロップ先で、ドロップしたデータを処理する <xref:System.Windows.DragDrop.Drop> イベント ハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="308bd-203">In the drop target, create a <xref:System.Windows.DragDrop.Drop> event handler to process the dropped data.</span></span>  
  
-   <span data-ttu-id="308bd-204"><xref:System.Windows.DragDrop.Drop> イベント ハンドラーで、<xref:System.Windows.DragEventArgs> メソッドと <xref:System.Windows.DataObject.GetDataPresent%2A> メソッドを使用して、<xref:System.Windows.DataObject.GetData%2A> からデータを抽出します。</span><span class="sxs-lookup"><span data-stu-id="308bd-204">In the <xref:System.Windows.DragDrop.Drop> event handler, extract the data from the <xref:System.Windows.DragEventArgs> by using the <xref:System.Windows.DataObject.GetDataPresent%2A> and <xref:System.Windows.DataObject.GetData%2A> methods.</span></span>  
  
-   <span data-ttu-id="308bd-205"><xref:System.Windows.DragDrop.Drop> イベント ハンドラーで、データを使用して、目的のドラッグ アンド ドロップ操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="308bd-205">In the <xref:System.Windows.DragDrop.Drop> event handler, use the data to perform the desired drag-and-drop operation.</span></span>  
  
 <span data-ttu-id="308bd-206">次のタスクに示すように、カスタム <xref:System.Windows.DataObject> を作成し、オプションのドラッグ元とドロップ先のイベントを処理すると、ドラッグ アンド ドロップの実装を拡張できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-206">You can enhance your drag-and-drop implementation by creating a custom <xref:System.Windows.DataObject> and by handling optional drag source and drop target events, as shown in the following tasks:</span></span>  
  
-   <span data-ttu-id="308bd-207">カスタム データまたは複数のデータ項目を転送するには、<xref:System.Windows.DataObject> メソッドに渡す <xref:System.Windows.DragDrop.DoDragDrop%2A> を作成します。</span><span class="sxs-lookup"><span data-stu-id="308bd-207">To transfer custom data or multiple data items, create a <xref:System.Windows.DataObject> to pass to the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span>  
  
-   <span data-ttu-id="308bd-208">ドラッグ中に他の操作を実行するには、ドロップ先で <xref:System.Windows.DragDrop.DragEnter>、<xref:System.Windows.DragDrop.DragOver>、および <xref:System.Windows.DragDrop.DragLeave> イベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="308bd-208">To perform additional actions during a drag, handle the <xref:System.Windows.DragDrop.DragEnter>, <xref:System.Windows.DragDrop.DragOver>, and <xref:System.Windows.DragDrop.DragLeave> events on the drop target.</span></span>  
  
-   <span data-ttu-id="308bd-209">マウス ポインターの外観を変更するには、ドラッグ元で <xref:System.Windows.DragDrop.GiveFeedback> イベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="308bd-209">To change the appearance of the mouse pointer, handle the <xref:System.Windows.DragDrop.GiveFeedback> event on the drag source.</span></span>  
  
-   <span data-ttu-id="308bd-210">ドラッグ アンド ドロップ操作の取り消し方法を変更するには、ドラッグ元で <xref:System.Windows.DragDrop.QueryContinueDrag> イベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="308bd-210">To change how the drag-and-drop operation is canceled, handle the <xref:System.Windows.DragDrop.QueryContinueDrag> event on the drag source.</span></span>  
  
<a name="Drag_And_Drop_Example"></a>   
## <a name="drag-and-drop-example"></a><span data-ttu-id="308bd-211">ドラッグ アンド ドロップの例</span><span class="sxs-lookup"><span data-stu-id="308bd-211">Drag-and-Drop Example</span></span>  
 <span data-ttu-id="308bd-212">このセクションでは、<xref:System.Windows.Shapes.Ellipse> 要素のドラッグ アンド ドロップを実装する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="308bd-212">This section describes how to implement drag-and-drop for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="308bd-213"><xref:System.Windows.Shapes.Ellipse> はドラッグ元とドロップ先の両方です。</span><span class="sxs-lookup"><span data-stu-id="308bd-213">The <xref:System.Windows.Shapes.Ellipse> is both a drag source and a drop target.</span></span> <span data-ttu-id="308bd-214">転送されるデータは、楕円の <xref:System.Windows.Shapes.Shape.Fill%2A> プロパティの文字列表現です。</span><span class="sxs-lookup"><span data-stu-id="308bd-214">The transferred data is the string representation of the ellipse’s <xref:System.Windows.Shapes.Shape.Fill%2A> property.</span></span> <span data-ttu-id="308bd-215">次の XAML は、<xref:System.Windows.Shapes.Ellipse> 要素と、XAML が処理するドラッグ アンド ドロップ関連のイベントを示しています。</span><span class="sxs-lookup"><span data-stu-id="308bd-215">The following XAML shows the <xref:System.Windows.Shapes.Ellipse> element and the drag-and-drop related events that it handles.</span></span> <span data-ttu-id="308bd-216">ドラッグ アンド ドロップの実装方法の完全な手順については、「[チュートリアル: ユーザー コントロールでドラッグ アンド ドロップを有効にする](../../../../docs/framework/wpf/advanced/walkthrough-enabling-drag-and-drop-on-a-user-control.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="308bd-216">For complete steps on how to implement drag-and-drop, see [Walkthrough: Enabling Drag and Drop on a User Control](../../../../docs/framework/wpf/advanced/walkthrough-enabling-drag-and-drop-on-a-user-control.md).</span></span>  
  
 [!code-xaml[DragDropSnippets#EllipseXaml](../../../../samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml#ellipsexaml)]  
  
### <a name="enabling-an-element-to-be-a-drag-source"></a><span data-ttu-id="308bd-217">要素がドラッグ元になるようにする</span><span class="sxs-lookup"><span data-stu-id="308bd-217">Enabling an Element to be a Drag Source</span></span>  
 <span data-ttu-id="308bd-218">ドラッグ元であるオブジェクトは次の役割を務めます。</span><span class="sxs-lookup"><span data-stu-id="308bd-218">An object that is a drag source is responsible for:</span></span>  
  
-   <span data-ttu-id="308bd-219">いつドラッグが発生するかを識別する。</span><span class="sxs-lookup"><span data-stu-id="308bd-219">Identifying when a drag occurs.</span></span>  
  
-   <span data-ttu-id="308bd-220">ドラッグ アンド ドロップ操作を開始する。</span><span class="sxs-lookup"><span data-stu-id="308bd-220">Initiating the drag-and-drop operation.</span></span>  
  
-   <span data-ttu-id="308bd-221">転送するデータを特定する。</span><span class="sxs-lookup"><span data-stu-id="308bd-221">Identifying the data to be transferred.</span></span>  
  
-   <span data-ttu-id="308bd-222">ドラッグ アンド ドロップ操作によってデータ転送時に起こすことができる効果を指定する。</span><span class="sxs-lookup"><span data-stu-id="308bd-222">Specifying the effects that the drag-and-drop operation is allowed to have on the transferred data.</span></span>  
  
 <span data-ttu-id="308bd-223">ドラッグ元には、許可される操作 (移動、コピー、なし) に関してユーザーにフィードバックすることもできます。また、ドラッグ中に Esc キーを押すなどのユーザーの追加の入力に基づいて、ドラッグ アンド ドロップ操作を取り消すことができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-223">The drag source may also give feedback to the user regarding the allowed actions (move, copy, none), and can cancel the drag-and-drop operation based on additional user input, such as pressing the ESC key during the drag.</span></span>  
  
 <span data-ttu-id="308bd-224">いつドラッグが発生したかを判断してから、<xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドを呼び出してドラッグ アンド ドロップ操作を開始することは、アプリケーションの役割です。</span><span class="sxs-lookup"><span data-stu-id="308bd-224">It is the responsibility of your application to determine when a drag occurs, and then initiate the drag-and-drop operation by calling the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="308bd-225">通常、これはマウス ボタンが押されている間に、要素上で <xref:System.Windows.UIElement.MouseMove> イベントが発生してドラッグする場合です。</span><span class="sxs-lookup"><span data-stu-id="308bd-225">Typically, this is when a <xref:System.Windows.UIElement.MouseMove> event occurs over the element to be dragged while a mouse button is pressed.</span></span> <span data-ttu-id="308bd-226">次の例は、<xref:System.Windows.UIElement.MouseMove> 要素の <xref:System.Windows.Shapes.Ellipse> イベント ハンドラーからドラッグ アンド ドロップ操作を開始してドラッグ元にする方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="308bd-226">The following example shows how to initiate a drag-and-drop operation from the <xref:System.Windows.UIElement.MouseMove> event handler of an <xref:System.Windows.Shapes.Ellipse> element to make it a drag source.</span></span> <span data-ttu-id="308bd-227">転送されるデータは、楕円の <xref:System.Windows.Shapes.Shape.Fill%2A> プロパティの文字列表現です。</span><span class="sxs-lookup"><span data-stu-id="308bd-227">The transferred data is the string representation of the ellipse’s <xref:System.Windows.Shapes.Shape.Fill%2A> property.</span></span>  
  
 [!code-csharp[DragDropSnippets#DoDragDrop](../../../../samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dodragdrop)]
 [!code-vb[DragDropSnippets#DoDragDrop](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dodragdrop)]  
  
 <span data-ttu-id="308bd-228"><xref:System.Windows.UIElement.MouseMove> イベント ハンドラー内で、<xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドを呼び出して、ドラッグ アンド ドロップ操作を開始します。</span><span class="sxs-lookup"><span data-stu-id="308bd-228">Inside of the <xref:System.Windows.UIElement.MouseMove> event handler, call the <xref:System.Windows.DragDrop.DoDragDrop%2A> method to initiate the drag-and-drop operation.</span></span> <span data-ttu-id="308bd-229"><xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドは 3 つのパラメーターを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="308bd-229">The <xref:System.Windows.DragDrop.DoDragDrop%2A> method takes three parameters:</span></span>  
  
-   <span data-ttu-id="308bd-230">`dragSource` – 転送されたデータのソースである依存関係オブジェクトへの参照。通常、これは <xref:System.Windows.UIElement.MouseMove> イベントのソースです。</span><span class="sxs-lookup"><span data-stu-id="308bd-230">`dragSource` – A reference to the dependency object that is the source of the transferred data; this is typically the source of the <xref:System.Windows.UIElement.MouseMove> event.</span></span>  
  
-   <span data-ttu-id="308bd-231">`data` - <xref:System.Windows.DataObject> にラップされる転送済みデータを含むオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="308bd-231">`data` - An object that contains the transferred data, wrapped in a <xref:System.Windows.DataObject>.</span></span>  
  
-   <span data-ttu-id="308bd-232">`allowedEffects` - ドラッグ アンド ドロップ操作の許可される効果を指定する <xref:System.Windows.DragDropEffects> 列挙値の 1 つ。</span><span class="sxs-lookup"><span data-stu-id="308bd-232">`allowedEffects` - One of the <xref:System.Windows.DragDropEffects> enumeration values that specifies the permitted effects of the drag-and-drop operation.</span></span>  
  
 <span data-ttu-id="308bd-233">シリアル化可能なオブジェクトはすべて `data` パラメーターに渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-233">Any serializable object can be passed in the `data` parameter.</span></span> <span data-ttu-id="308bd-234">データがまだ <xref:System.Windows.DataObject> にラップされていない場合、データは新しい <xref:System.Windows.DataObject> に自動的にラップされます。</span><span class="sxs-lookup"><span data-stu-id="308bd-234">If the data is not already wrapped in a <xref:System.Windows.DataObject>, it will automatically be wrapped in a new <xref:System.Windows.DataObject>.</span></span> <span data-ttu-id="308bd-235">複数のデータ項目を渡すには、自分で <xref:System.Windows.DataObject> を作成し、<xref:System.Windows.DragDrop.DoDragDrop%2A> メソッドに渡す必要があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-235">To pass multiple data items, you must create the <xref:System.Windows.DataObject> yourself, and pass it to the <xref:System.Windows.DragDrop.DoDragDrop%2A> method.</span></span> <span data-ttu-id="308bd-236">詳細については、「[データとデータ オブジェクト](../../../../docs/framework/wpf/advanced/data-and-data-objects.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="308bd-236">For more information, see [Data and Data Objects](../../../../docs/framework/wpf/advanced/data-and-data-objects.md).</span></span>  
  
 <span data-ttu-id="308bd-237">
          `allowedEffects` パラメーターを使用すると、ドラッグ元が、ドロップ先に対して、データの転送時に何を行えるかを指定できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-237">The `allowedEffects` parameter is used to specify what the drag source will allow the drop target to do with the transferred data.</span></span> <span data-ttu-id="308bd-238">ドラッグ元の一般的な値は <xref:System.Windows.DragDropEffects.Copy>、<xref:System.Windows.DragDropEffects.Move>、および <xref:System.Windows.DragDropEffects.All> です。</span><span class="sxs-lookup"><span data-stu-id="308bd-238">The common values for a drag source are <xref:System.Windows.DragDropEffects.Copy>, <xref:System.Windows.DragDropEffects.Move>, and <xref:System.Windows.DragDropEffects.All>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="308bd-239">ドロップ先でも、ドロップされたデータに対応してどのような効果を意図するか指定できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-239">The drop target is also able to specify what effects it intends in response to the dropped data.</span></span> <span data-ttu-id="308bd-240">たとえば、ドロップ先がドロップするデータ型を認識しない場合、許可された効果を <xref:System.Windows.DragDropEffects.None> に設定してデータを拒否することができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-240">For example, if the drop target does not recognize the data type to be dropped, it can refuse the data by setting its allowed effects to <xref:System.Windows.DragDropEffects.None>.</span></span> <span data-ttu-id="308bd-241">これは通常、 <xref:System.Windows.DragDrop.DragOver> イベント ハンドラーで実行します。</span><span class="sxs-lookup"><span data-stu-id="308bd-241">It typically does this in its <xref:System.Windows.DragDrop.DragOver> event handler.</span></span>  
  
 <span data-ttu-id="308bd-242">ドラッグ元は、オプションで <xref:System.Windows.DragDrop.GiveFeedback> イベントと <xref:System.Windows.DragDrop.QueryContinueDrag> イベントを処理できます。</span><span class="sxs-lookup"><span data-stu-id="308bd-242">A drag source can optionally handle the <xref:System.Windows.DragDrop.GiveFeedback> and <xref:System.Windows.DragDrop.QueryContinueDrag> events.</span></span> <span data-ttu-id="308bd-243">これらのイベントには、イベントを処理済みとマークしない限り使用される既定のハンドラーがあります。</span><span class="sxs-lookup"><span data-stu-id="308bd-243">These events have default handlers that are used unless you mark the events as handled.</span></span> <span data-ttu-id="308bd-244">既定の動作を変更する特定のニーズがない限り、通常はこれらのイベントを無視します。</span><span class="sxs-lookup"><span data-stu-id="308bd-244">You will typically ignore these events unless you have a specific need to change their default behavior.</span></span>  
  
 <span data-ttu-id="308bd-245">ドラッグ元がドラッグされている間、<xref:System.Windows.DragDrop.GiveFeedback> イベントは継続的に発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-245">The <xref:System.Windows.DragDrop.GiveFeedback> event is raised continuously while the drag source is being dragged.</span></span> <span data-ttu-id="308bd-246">このイベントの既定のハンドラーは、ドラッグ元が有効なドロップ先の上にドラッグしているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="308bd-246">The default handler for this event checks whether the drag source is over a valid drop target.</span></span> <span data-ttu-id="308bd-247">有効である場合は、このハンドラーは、ドロップ先の許可された効果を確認します。</span><span class="sxs-lookup"><span data-stu-id="308bd-247">If it is, it checks the allowed effects of the drop target.</span></span> <span data-ttu-id="308bd-248">その後、許可されているドロップ効果に関してエンドユーザーにフィードバックします。</span><span class="sxs-lookup"><span data-stu-id="308bd-248">It then gives feedback to the end user regarding the allowed drop effects.</span></span> <span data-ttu-id="308bd-249">通常は、マウス カーソルを非ドロップ、コピー、または移動のカーソルに変更してこれを実行します。</span><span class="sxs-lookup"><span data-stu-id="308bd-249">This is typically done by changing the mouse cursor to a no-drop, copy, or move cursor.</span></span> <span data-ttu-id="308bd-250">カスタムのカーソルを使用してユーザーにフィードバックする必要がある場合のみ、このイベントを処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-250">You should only handle this event if you need to use custom cursors to provide feedback to the user.</span></span> <span data-ttu-id="308bd-251">このイベントを処理する場合は、既定のハンドラーが自作のハンドラーをオーバーライドしないよう、必ずイベントを処理済みとマークしてください。</span><span class="sxs-lookup"><span data-stu-id="308bd-251">If you handle this event, be sure to mark it as handled so that the default handler does not override your handler.</span></span>  
  
 <span data-ttu-id="308bd-252">ドラッグ元がドラッグされている間、<xref:System.Windows.DragDrop.QueryContinueDrag> イベントは継続的に発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-252">The <xref:System.Windows.DragDrop.QueryContinueDrag> event is raised continuously while the drag source is being dragged.</span></span> <span data-ttu-id="308bd-253">このイベントを処理すると、Esc、Shift、Ctrl、および Alt の各キーの状態に加えて、マウス ボタンの状態に基づいて、どのアクションがドラッグ アンド ドロップ操作を終了させるかを決定することができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-253">You can handle this event to determine what action ends the drag-and-drop operation based on the state of the ESC, SHIFT, CTRL, and ALT keys, as well as the state of the mouse buttons.</span></span> <span data-ttu-id="308bd-254">このイベントの既定のハンドラーは、Esc キーを押した場合はドラッグ アンド ドロップ操作を取り消し、マウス ボタンを放した場合はデータをドロップします。</span><span class="sxs-lookup"><span data-stu-id="308bd-254">The default handler for this event cancels the drag-and-drop operation if the ESC key is pressed, and drops the data if the mouse button is released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="308bd-255">これらのイベントは、ドラッグ アンド ドロップ操作中に継続的に発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-255">These events are raised continuously during the drag-and-drop operation.</span></span> <span data-ttu-id="308bd-256">そのため、イベント ハンドラーではリソースを集中的に使用するタスクを避ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="308bd-256">Therefore, you should avoid resource-intensive tasks in the event handlers.</span></span>  <span data-ttu-id="308bd-257">たとえば、<xref:System.Windows.DragDrop.GiveFeedback> イベントが発生するたびに新しいカーソルを作成するのではなく、キャッシュされたカーソルを使用します。</span><span class="sxs-lookup"><span data-stu-id="308bd-257">For example, use a cached cursor instead of creating a new cursor each time the <xref:System.Windows.DragDrop.GiveFeedback> event is raised.</span></span>  
  
### <a name="enabling-an-element-to-be-a-drop-target"></a><span data-ttu-id="308bd-258">要素がドロップ先になるようにする</span><span class="sxs-lookup"><span data-stu-id="308bd-258">Enabling an Element to be a Drop Target</span></span>  
 <span data-ttu-id="308bd-259">ドロップ先であるオブジェクトは次の役割を務めます。</span><span class="sxs-lookup"><span data-stu-id="308bd-259">An object that is a drop target is responsible for:</span></span>  
  
-   <span data-ttu-id="308bd-260">有効なドロップ先であることを指定する。</span><span class="sxs-lookup"><span data-stu-id="308bd-260">Specifying that it is a valid drop target.</span></span>  
  
-   <span data-ttu-id="308bd-261">ドラッグ元に対して、ターゲットの上にドラッグしたときに応答する。</span><span class="sxs-lookup"><span data-stu-id="308bd-261">Responding to the drag source when it drags over the target.</span></span>  
  
-   <span data-ttu-id="308bd-262">転送されたデータが受信できる形式であることを確認する。</span><span class="sxs-lookup"><span data-stu-id="308bd-262">Checking that the transferred data is in a format that it can receive.</span></span>  
  
-   <span data-ttu-id="308bd-263">ドロップしたデータを処理する。</span><span class="sxs-lookup"><span data-stu-id="308bd-263">Processing the dropped data.</span></span>  
  
 <span data-ttu-id="308bd-264">要素がドロップ先であることを指定するには、<xref:System.Windows.UIElement.AllowDrop%2A> プロパティを `true` に設定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-264">To specify that an element is a drop target, you set its <xref:System.Windows.UIElement.AllowDrop%2A> property to `true`.</span></span> <span data-ttu-id="308bd-265">ドロップ先のイベントが要素で発生して、処理できるようになります。</span><span class="sxs-lookup"><span data-stu-id="308bd-265">The drop target events will then be raised on the element so that you can handle them.</span></span> <span data-ttu-id="308bd-266">ドラッグ アンド ドロップ操作中に、次の一連のイベントがドロップ先で発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-266">During a drag-and-drop operation, the following sequence of events occurs on the drop target:</span></span>  
  
1.  <xref:System.Windows.DragDrop.DragEnter>  
  
2.  <xref:System.Windows.DragDrop.DragOver>  
  
3.  <span data-ttu-id="308bd-267"><xref:System.Windows.DragDrop.DragLeave> または <xref:System.Windows.DragDrop.Drop></span><span class="sxs-lookup"><span data-stu-id="308bd-267"><xref:System.Windows.DragDrop.DragLeave> or <xref:System.Windows.DragDrop.Drop></span></span>  
  
 <span data-ttu-id="308bd-268"><xref:System.Windows.DragDrop.DragEnter> イベントは、データがドロップ先の境界の中にドラッグされるときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-268">The <xref:System.Windows.DragDrop.DragEnter> event occurs when the data is dragged into the drop target's boundary.</span></span> <span data-ttu-id="308bd-269">通常は、アプリケーションに適していれば、ドラッグ アンド ドロップ操作の効果のプレビューを提供するように、このイベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="308bd-269">You typically handle this event to provide a preview of the effects of the drag-and-drop operation, if appropriate for your application.</span></span> <span data-ttu-id="308bd-270"><xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> イベントで <xref:System.Windows.DragDrop.DragEnter> プロパティを設定しないでください。このプロパティは <xref:System.Windows.DragDrop.DragOver> イベントで上書きされるためです。</span><span class="sxs-lookup"><span data-stu-id="308bd-270">Do not set the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property in the <xref:System.Windows.DragDrop.DragEnter> event, as it will be overwritten in the <xref:System.Windows.DragDrop.DragOver> event.</span></span>  
  
 <span data-ttu-id="308bd-271">次の例は、<xref:System.Windows.Shapes.Ellipse> 要素の <xref:System.Windows.DragDrop.DragEnter> イベント ハンドラーを示しています。</span><span class="sxs-lookup"><span data-stu-id="308bd-271">The following example shows the <xref:System.Windows.DragDrop.DragEnter> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="308bd-272">このコードでは、現在の <xref:System.Windows.Shapes.Shape.Fill%2A> ブラシを保存して、ドラッグ アンド ドロップ操作の効果をプレビューします。</span><span class="sxs-lookup"><span data-stu-id="308bd-272">This code previews the effects of the drag-and-drop operation by saving the current <xref:System.Windows.Shapes.Shape.Fill%2A> brush.</span></span> <span data-ttu-id="308bd-273">続いて、<xref:System.Windows.DataObject.GetDataPresent%2A> メソッドを使用して、楕円の上にドラッグした <xref:System.Windows.DataObject> に、<xref:System.Windows.Media.Brush> に変換できる文字列データが含まれているかどうかを確認します。 </span><span class="sxs-lookup"><span data-stu-id="308bd-273">It then uses the <xref:System.Windows.DataObject.GetDataPresent%2A> method to check whether the <xref:System.Windows.DataObject> being dragged over the ellipse contains string data that can be converted to a <xref:System.Windows.Media.Brush>.</span></span> <span data-ttu-id="308bd-274">含まれている場合、データは <xref:System.Windows.DataObject.GetData%2A> メソッドによって抽出されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-274">If so, the data is extracted using the <xref:System.Windows.DataObject.GetData%2A> method.</span></span> <span data-ttu-id="308bd-275">その後、データは <xref:System.Windows.Media.Brush> に変換されて、楕円に適用されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-275">It is then converted to a <xref:System.Windows.Media.Brush> and applied to the ellipse.</span></span> <span data-ttu-id="308bd-276">変更は <xref:System.Windows.DragDrop.DragLeave> イベント ハンドラーで元に戻ります。</span><span class="sxs-lookup"><span data-stu-id="308bd-276">The change is reverted in the <xref:System.Windows.DragDrop.DragLeave> event handler.</span></span> <span data-ttu-id="308bd-277">データが <xref:System.Windows.Media.Brush> に変換できない場合、アクションは実行されません。</span><span class="sxs-lookup"><span data-stu-id="308bd-277">If the data cannot be converted to a <xref:System.Windows.Media.Brush>, no action is performed.</span></span>  
  
 [!code-csharp[DragDropSnippets#DragEnter](../../../../samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dragenter)]
 [!code-vb[DragDropSnippets#DragEnter](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dragenter)]  
  
 <span data-ttu-id="308bd-278"><xref:System.Windows.DragDrop.DragOver> イベントは、データがドロップ先の上にドラッグされる間、継続的に発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-278">The <xref:System.Windows.DragDrop.DragOver> event occurs continuously while the data is dragged over the drop target.</span></span> <span data-ttu-id="308bd-279">このイベントはドラッグ元の <xref:System.Windows.DragDrop.GiveFeedback> イベントとペアになります。</span><span class="sxs-lookup"><span data-stu-id="308bd-279">This event is paired with the <xref:System.Windows.DragDrop.GiveFeedback> event on the drag source.</span></span> <span data-ttu-id="308bd-280"><xref:System.Windows.DragDrop.DragOver> イベント ハンドラーでは、通常は <xref:System.Windows.DataObject.GetDataPresent%2A> メソッドと <xref:System.Windows.DataObject.GetData%2A> メソッドを使用して、転送されたデータがドロップ先で処理できる形式であるかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="308bd-280">In the <xref:System.Windows.DragDrop.DragOver> event handler, you typically use the <xref:System.Windows.DataObject.GetDataPresent%2A> and <xref:System.Windows.DataObject.GetData%2A> methods to check whether the transferred data is in a format that the drop target can process.</span></span> <span data-ttu-id="308bd-281">また、いずれかの修飾キーが押されたかどうかも確認できます。修飾キーは、通常、ユーザーが移動またはコピー操作を意図しているかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="308bd-281">You can also check whether any modifier keys are pressed, which will typically indicate whether the user intends a move or copy action.</span></span> <span data-ttu-id="308bd-282">これらの確認を行った後、<xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> プロパティを、データをドロップするとどのような効果が起こるかをドラッグ元に通知するように設定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-282">After these checks are performed, you set the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property to notify the drag source what effect dropping the data will have.</span></span> <span data-ttu-id="308bd-283">ドラッグ元は、<xref:System.Windows.DragDrop.GiveFeedback> のイベント引数でこの情報を受信し、適切なカーソルを設定してユーザーにフィードバックします。</span><span class="sxs-lookup"><span data-stu-id="308bd-283">The drag source receives this information in the <xref:System.Windows.DragDrop.GiveFeedback> event args, and can set an appropriate cursor to give feedback to the user.</span></span>  
  
 <span data-ttu-id="308bd-284">次の例は、<xref:System.Windows.Shapes.Ellipse> 要素の <xref:System.Windows.DragDrop.DragOver> イベント ハンドラーを示しています。</span><span class="sxs-lookup"><span data-stu-id="308bd-284">The following example shows the <xref:System.Windows.DragDrop.DragOver> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="308bd-285">このコードは、楕円の上にドラッグされている <xref:System.Windows.DataObject> に、<xref:System.Windows.Media.Brush> に変換できる文字列データが含まれているかどうかを確認します。 </span><span class="sxs-lookup"><span data-stu-id="308bd-285">This code checks to see if the <xref:System.Windows.DataObject> being dragged over the ellipse contains string data that can be converted to a <xref:System.Windows.Media.Brush>.</span></span> <span data-ttu-id="308bd-286">含まれている場合、<xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> プロパティを <xref:System.Windows.DragDropEffects.Copy> に設定します。</span><span class="sxs-lookup"><span data-stu-id="308bd-286">If so, it sets the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property to <xref:System.Windows.DragDropEffects.Copy>.</span></span> <span data-ttu-id="308bd-287">これにより、ドラッグ元に対して、データが楕円にコピーできることを示します。</span><span class="sxs-lookup"><span data-stu-id="308bd-287">This indicates to the drag source that the data can be copied to the ellipse.</span></span> <span data-ttu-id="308bd-288">データが <xref:System.Windows.Media.Brush> に変換できない場合、<xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> プロパティは <xref:System.Windows.DragDropEffects.None> に設定されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-288">If the data cannot be converted to a <xref:System.Windows.Media.Brush>, the <xref:System.Windows.DragEventArgs.Effects%2A?displayProperty=nameWithType> property is set to <xref:System.Windows.DragDropEffects.None>.</span></span> <span data-ttu-id="308bd-289">これにより、ドラッグ元に対して、楕円はデータの有効なドロップ先ではないことを示します。</span><span class="sxs-lookup"><span data-stu-id="308bd-289">This indicates to the drag source that the ellipse is not a valid drop target for the data.</span></span>  
  
 [!code-csharp[DragDropSnippets#DragOver](../../../../samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dragover)]
 [!code-vb[DragDropSnippets#DragOver](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dragover)]  
  
 <span data-ttu-id="308bd-290"><xref:System.Windows.DragDrop.DragLeave> イベントは、データがドロップされることなくターゲットの境界の外にドラッグされるときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-290">The <xref:System.Windows.DragDrop.DragLeave> event occurs when the data is dragged out of the target's boundary without being dropped.</span></span> <span data-ttu-id="308bd-291">このイベントを処理すると、<xref:System.Windows.DragDrop.DragEnter> イベント ハンドラーで行ったことをすべて元に戻すことができます。</span><span class="sxs-lookup"><span data-stu-id="308bd-291">You handle this event to undo anything that you did in the <xref:System.Windows.DragDrop.DragEnter> event handler.</span></span>  
  
 <span data-ttu-id="308bd-292">次の例は、<xref:System.Windows.Shapes.Ellipse> 要素の <xref:System.Windows.DragDrop.DragLeave> イベント ハンドラーを示しています。</span><span class="sxs-lookup"><span data-stu-id="308bd-292">The following example shows the <xref:System.Windows.DragDrop.DragLeave> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="308bd-293">このコードは、保存された <xref:System.Windows.Media.Brush> を楕円に適用することで、<xref:System.Windows.DragDrop.DragEnter> イベント ハンドラーで行ったプレビュー内容を元に戻します。</span><span class="sxs-lookup"><span data-stu-id="308bd-293">This code undoes the preview performed in the <xref:System.Windows.DragDrop.DragEnter> event handler by applying the saved <xref:System.Windows.Media.Brush> to the ellipse.</span></span>  
  
 [!code-csharp[DragDropSnippets#DragLeave](../../../../samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#dragleave)]
 [!code-vb[DragDropSnippets#DragLeave](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#dragleave)]  
  
 <span data-ttu-id="308bd-294"><xref:System.Windows.DragDrop.Drop> イベントは、データがドロップ先にドロップされると発生します。既定では、これはマウス ボタンが放されたときに発生します。</span><span class="sxs-lookup"><span data-stu-id="308bd-294">The <xref:System.Windows.DragDrop.Drop> event occurs when the data is dropped over the drop target; by default, this happens when the mouse button is released.</span></span> <span data-ttu-id="308bd-295"><xref:System.Windows.DragDrop.Drop> イベント ハンドラーでは、<xref:System.Windows.DataObject.GetData%2A> メソッドを使用して <xref:System.Windows.DataObject> から転送されたデータを抽出し、アプリケーションが必要とするデータ処理を実行します。</span><span class="sxs-lookup"><span data-stu-id="308bd-295">In the <xref:System.Windows.DragDrop.Drop> event handler, you use the <xref:System.Windows.DataObject.GetData%2A> method to extract the transferred data from the <xref:System.Windows.DataObject> and perform any data processing that your application requires.</span></span> <span data-ttu-id="308bd-296"><xref:System.Windows.DragDrop.Drop> イベントは、ドラッグ アンド ドロップ操作を終了します。</span><span class="sxs-lookup"><span data-stu-id="308bd-296">The <xref:System.Windows.DragDrop.Drop> event ends the drag-and-drop operation.</span></span>  
  
 <span data-ttu-id="308bd-297">次の例は、<xref:System.Windows.DragDrop.Drop> 要素の <xref:System.Windows.Shapes.Ellipse> イベント ハンドラーを示しています。</span><span class="sxs-lookup"><span data-stu-id="308bd-297">The following example shows the <xref:System.Windows.DragDrop.Drop> event handler for an <xref:System.Windows.Shapes.Ellipse> element.</span></span> <span data-ttu-id="308bd-298">このコードは、ドラッグ アンド ドロップ操作の効果を適用します。<xref:System.Windows.DragDrop.DragEnter> イベント ハンドラーのコードと似ています。</span><span class="sxs-lookup"><span data-stu-id="308bd-298">This code applies the effects of the drag-and-drop operation, and is similar to the code in the <xref:System.Windows.DragDrop.DragEnter> event handler.</span></span> <span data-ttu-id="308bd-299">このコードは、楕円の上にドラッグされている <xref:System.Windows.DataObject> に、<xref:System.Windows.Media.Brush> に変換できる文字列データが含まれているかどうかを確認します。 </span><span class="sxs-lookup"><span data-stu-id="308bd-299">It checks to see if the <xref:System.Windows.DataObject> being dragged over the ellipse contains string data that can be converted to a <xref:System.Windows.Media.Brush>.</span></span> <span data-ttu-id="308bd-300">含まれている場合は、 <xref:System.Windows.Media.Brush> は楕円に適用されます。</span><span class="sxs-lookup"><span data-stu-id="308bd-300">If so, the <xref:System.Windows.Media.Brush> is applied to the ellipse.</span></span> <span data-ttu-id="308bd-301">データが <xref:System.Windows.Media.Brush> に変換できない場合、アクションは実行されません。</span><span class="sxs-lookup"><span data-stu-id="308bd-301">If the data cannot be converted to a <xref:System.Windows.Media.Brush>, no action is performed.</span></span>  
  
 [!code-csharp[DragDropSnippets#Drop](../../../../samples/snippets/csharp/VS_Snippets_Wpf/dragdropsnippets/cs/mainwindow.xaml.cs#drop)]
 [!code-vb[DragDropSnippets#Drop](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/dragdropsnippets/vb/mainwindow.xaml.vb#drop)]  
  
## <a name="see-also"></a><span data-ttu-id="308bd-302">関連項目</span><span class="sxs-lookup"><span data-stu-id="308bd-302">See Also</span></span>  
 <xref:System.Windows.Clipboard>  
 [<span data-ttu-id="308bd-303">チュートリアル: ユーザー コントロールでのドラッグ アンド ドロップの有効化</span><span class="sxs-lookup"><span data-stu-id="308bd-303">Walkthrough: Enabling Drag and Drop on a User Control</span></span>](../../../../docs/framework/wpf/advanced/walkthrough-enabling-drag-and-drop-on-a-user-control.md)  
 [<span data-ttu-id="308bd-304">方法トピック</span><span class="sxs-lookup"><span data-stu-id="308bd-304">How-to Topics</span></span>](../../../../docs/framework/wpf/advanced/drag-and-drop-how-to-topics.md)  
 [<span data-ttu-id="308bd-305">ドラッグ アンド ドロップ</span><span class="sxs-lookup"><span data-stu-id="308bd-305">Drag and Drop</span></span>](../../../../docs/framework/wpf/advanced/drag-and-drop.md)
