---
title: "リソースとコード"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
caps.latest.revision: "14"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 1177f7eeb2b6184ea6ae0a021730658913a4794b
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="resources-and-code"></a><span data-ttu-id="11d6e-102">リソースとコード</span><span class="sxs-lookup"><span data-stu-id="11d6e-102">Resources and Code</span></span>
<span data-ttu-id="11d6e-103">この概要では、[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] 構文ではなく、コードを使用して [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] リソースにアクセスする方法、またはこのリソースを作成する方法に重点を置いて説明します。</span><span class="sxs-lookup"><span data-stu-id="11d6e-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="11d6e-104">一般的なリソースの使用法と [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 構文の観点から見たリソースの詳細については、「[XAML リソース](../../../../docs/framework/wpf/advanced/xaml-resources.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="11d6e-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span></span>  
  
  
  
<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="11d6e-105">コードからのリソースへのアクセス</span><span class="sxs-lookup"><span data-stu-id="11d6e-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="11d6e-106">リソースを識別するキーは、[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] で定義されていれば、コードでリソースを要求する際にも特定のリソースの取得に使用されます。</span><span class="sxs-lookup"><span data-stu-id="11d6e-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="11d6e-107">コードからリソースを取得する最も簡単な方法は、いずれかを呼び出すには、<xref:System.Windows.FrameworkElement.FindResource%2A>または<xref:System.Windows.FrameworkElement.TryFindResource%2A>アプリケーション フレームワーク レベルのオブジェクトからのメソッドです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="11d6e-108">これらのメソッドは、要求したキーが見つからなかった場合の動作に違いがあります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="11d6e-109"><xref:System.Windows.FrameworkElement.FindResource%2A>例外を発生させます。<xref:System.Windows.FrameworkElement.TryFindResource%2A>を返しますが、例外が発生していない`null`です。</span><span class="sxs-lookup"><span data-stu-id="11d6e-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="11d6e-110">それぞれのメソッドは、入力パラメーターとしてリソース キーを受け取り、緩く型指定されたオブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="11d6e-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="11d6e-111">通常、リソース キーは文字列ですが、文字列以外を使用する場合もあります。詳細については、「[キーとしてのオブジェクトの使用](#objectaskey)」のセクションを参照してください。</span><span class="sxs-lookup"><span data-stu-id="11d6e-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="11d6e-112">通常は、返されたオブジェクトを、リソースの要求時に設定するプロパティで必要な型にキャストします。</span><span class="sxs-lookup"><span data-stu-id="11d6e-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="11d6e-113">コードのリソース解決の検索ロジックは、動的リソース参照の [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] の場合と同じです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="11d6e-114">リソースの検索は、呼び出し元の要素から開始され、論理ツリー内の連続する親要素へと続きます。</span><span class="sxs-lookup"><span data-stu-id="11d6e-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="11d6e-115">その後、必要に応じて、アプリケーション リソース、テーマ、システム リソースへと検索が続きます。</span><span class="sxs-lookup"><span data-stu-id="11d6e-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="11d6e-116">コードによるリソースの要求では、リソース ディクショナリが [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] で読み込まれた後に行われた実行時の変更と、リアルタイムのシステム リソースの変更が適切に考慮されます。</span><span class="sxs-lookup"><span data-stu-id="11d6e-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="11d6e-117">キーを使用してリソースを検索およびとして実装されている、プロパティを設定する、返される値を使用する簡単なコード例を次に示します、<xref:System.Windows.Controls.Primitives.ButtonBase.Click>イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="11d6e-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="11d6e-118">リソースの参照を割り当てるための代替のメソッドは<xref:System.Windows.FrameworkElement.SetResourceReference%2A>します。</span><span class="sxs-lookup"><span data-stu-id="11d6e-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="11d6e-119">このメソッドは、リソースのキーと、リソース値を割り当てる要素インスタンスに存在する特定の依存関係プロパティの識別子の 2 つのパラメーターを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="11d6e-120">このメソッドは機能的には前のメソッドと同じですが、戻り値をキャストしなくて済むという利点があります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="11d6e-121">リソースにアクセスするプログラムでさらに別の方法は、の内容にアクセスする、<xref:System.Windows.FrameworkElement.Resources%2A>ディクショナリとしてのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="11d6e-122">このプロパティによって格納されたディクショナリにアクセスする方法は、新しいリソースを既存のコレクションに追加する方法、指定したキー名がコレクション既に取得されたかどうかを確認する方法などのその他のディクショナリ/コレクション操作でもあります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="11d6e-123">作成している場合、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]アプリケーション コードで完全、することができますもコードでコレクション全体を作成、キー、割り当てるおよび完成したコレクションを割り当てる、<xref:System.Windows.FrameworkElement.Resources%2A>確立されている要素のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="11d6e-124">これについては次のセクションで説明します。</span><span class="sxs-lookup"><span data-stu-id="11d6e-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="11d6e-125">内でも、指定したインデックスを作成する<xref:System.Windows.FrameworkElement.Resources%2A>として、インデックスが特定のキーを使用して、コレクションをこの方法でリソースへのアクセスは規則に従っていない標準ランタイムのリソースの解決の対応にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="11d6e-126">特定のコレクションにアクセスしているだけです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="11d6e-127">要求したキーで有効なオブジェクトが見つからなかった場合、リソース検索がルートまたはアプリケーションに向かうスコープを走査することはありません。</span><span class="sxs-lookup"><span data-stu-id="11d6e-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="11d6e-128">ただし、この方法では、キーの検索スコープがより限定されるため、特定のケースでパフォーマンス上のメリットが生じる場合があります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="11d6e-129">参照してください、<xref:System.Windows.ResourceDictionary>リソース ディクショナリを直接操作する方法の詳細についてはクラスです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="11d6e-130">コードによるリソースの作成</span><span class="sxs-lookup"><span data-stu-id="11d6e-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="11d6e-131">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] アプリケーション全体をコードで作成する場合は、そのアプリケーションのリソースもコードで作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="11d6e-132">作成するためには、新しい<xref:System.Windows.ResourceDictionary>インスタンス、および連続した呼び出しを使用してディクショナリにすべてのリソースを追加<xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>です。</span><span class="sxs-lookup"><span data-stu-id="11d6e-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="11d6e-133">次に、使用、<xref:System.Windows.ResourceDictionary>を設定するために作成された、<xref:System.Windows.FrameworkElement.Resources%2A>ページのスコープに存在する要素のプロパティをまたは<xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>です。</span><span class="sxs-lookup"><span data-stu-id="11d6e-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="11d6e-134">維持することも、<xref:System.Windows.ResourceDictionary>要素に追加しなくても、スタンドアロン オブジェクトとして。</span><span class="sxs-lookup"><span data-stu-id="11d6e-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="11d6e-135">ただし、これを行う場合は、ジェネリック ディクショナリの場合と同様に、項目のキーによって内部のリソースにアクセスする必要があります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="11d6e-136">A<xref:System.Windows.ResourceDictionary>要素にアタッチされていないを`Resources`プロパティは、要素ツリーの一部として存在していないとで使用できる参照シーケンス内のスコープを持たない<xref:System.Windows.FrameworkElement.FindResource%2A>および関連するメソッド。</span><span class="sxs-lookup"><span data-stu-id="11d6e-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="11d6e-137">キーとしてのオブジェクトの使用</span><span class="sxs-lookup"><span data-stu-id="11d6e-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="11d6e-138">通常、リソースを使用する場合、リソースのキーは文字列として設定されます。</span><span class="sxs-lookup"><span data-stu-id="11d6e-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="11d6e-139">ただし、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] の各種機能の中にはキーを指定する際に意図的に文字列型を使用しないで、このパラメーターにオブジェクトを使用するものもあります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="11d6e-140">オブジェクトによってリソースにキーを設定するには、[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] でのスタイルおよびテーマの適用のサポートを利用します。</span><span class="sxs-lookup"><span data-stu-id="11d6e-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="11d6e-141">設定されていないコントロールの既定のスタイルとなるテーマでのスタイルがそれぞれでキー指定された、<xref:System.Type>コントロールに適用されるのです。</span><span class="sxs-lookup"><span data-stu-id="11d6e-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="11d6e-142">型によってキーが設定されると、各コントロール型の既定のインスタンスで機能する信頼できる検索機構が実現され、型はリフレクションによって検索できるようになり、派生型に既定のスタイルが設定されていない場合でも派生クラスのスタイルを設定する際に使用できます。</span><span class="sxs-lookup"><span data-stu-id="11d6e-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="11d6e-143">指定することができます、<xref:System.Type>キーで定義されているリソースを[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]を使用して、 [X:type マークアップ拡張機能](../../../../docs/framework/xaml-services/x-type-markup-extension.md)します。</span><span class="sxs-lookup"><span data-stu-id="11d6e-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="11d6e-144">[ComponentResourceKey マークアップ拡張機能](../../../../docs/framework/wpf/advanced/componentresourcekey-markup-extension.md)など、文字列以外のキーの使用で [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 機能をサポートする同様の拡張機能があります。</span><span class="sxs-lookup"><span data-stu-id="11d6e-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](../../../../docs/framework/wpf/advanced/componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="11d6e-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="11d6e-145">See Also</span></span>  
 [<span data-ttu-id="11d6e-146">XAML リソース</span><span class="sxs-lookup"><span data-stu-id="11d6e-146">XAML Resources</span></span>](../../../../docs/framework/wpf/advanced/xaml-resources.md)  
 [<span data-ttu-id="11d6e-147">スタイルとテンプレート</span><span class="sxs-lookup"><span data-stu-id="11d6e-147">Styling and Templating</span></span>](../../../../docs/framework/wpf/controls/styling-and-templating.md)
