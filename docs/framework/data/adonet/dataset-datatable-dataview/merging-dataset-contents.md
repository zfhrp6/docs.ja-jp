---
title: DataSet の内容のマージ
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: e5e9309a-3ebb-4a9c-9d78-21c4e2bafc5b
ms.openlocfilehash: c0cc0834dc087df89131a720f517cd34f757a0f3
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/03/2018
ms.locfileid: "32763671"
---
# <a name="merging-dataset-contents"></a><span data-ttu-id="57e4e-102">DataSet の内容のマージ</span><span class="sxs-lookup"><span data-stu-id="57e4e-102">Merging DataSet Contents</span></span>
<span data-ttu-id="57e4e-103"><xref:System.Data.DataSet.Merge%2A> メソッドを使用して、<xref:System.Data.DataSet>、<xref:System.Data.DataTable>、または <xref:System.Data.DataRow> の配列の内容を既存の `DataSet` にマージできます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-103">You can use the <xref:System.Data.DataSet.Merge%2A> method to merge the contents of a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataRow> array into an existing `DataSet`.</span></span> <span data-ttu-id="57e4e-104">いくつかの要因とオプションが、新しいデータを既存の `DataSet` にマージする方法に影響します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-104">Several factors and options affect how new data is merged into an existing `DataSet`.</span></span>  
  
## <a name="primary-keys"></a><span data-ttu-id="57e4e-105">主キー</span><span class="sxs-lookup"><span data-stu-id="57e4e-105">Primary Keys</span></span>  
 <span data-ttu-id="57e4e-106">マージによって新しいデータとスキーマを受け取るテーブルに主キーがある場合、受信データの新しい行と、<xref:System.Data.DataRowVersion.Original> 行バージョンの主キーの値が受信データの主キーの値と同じである既存の行が照合されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-106">If the table receiving new data and schema from a merge has a primary key, new rows from the incoming data are matched with existing rows that have the same <xref:System.Data.DataRowVersion.Original> primary key values as those in the incoming data.</span></span> <span data-ttu-id="57e4e-107">受信スキーマの列が既存のスキーマの列と一致する場合、既存の行にあるデータが変更されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-107">If the columns from the incoming schema match those of the existing schema, the data in the existing rows is modified.</span></span> <span data-ttu-id="57e4e-108">既存のスキーマと一致しない列は、<xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> パラメーターに基づいて無視または追加されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-108">Columns that do not match the existing schema are either ignored or added based on the <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parameter.</span></span> <span data-ttu-id="57e4e-109">主キーの値が既存の行と一致しない新しい行は、既存のテーブルに追加されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-109">New rows with primary key values that do not match any existing rows are appended to the existing table.</span></span>  
  
 <span data-ttu-id="57e4e-110">受信する行または既存の行の状態が <xref:System.Data.DataRowState.Added> の場合、<xref:System.Data.DataRowVersion.Current> 行バージョンが存在しないため、`Added` の行の `Original` 行バージョンの主キーの値を使用して、その 2 つの行の主キーの値を照合します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-110">If incoming or existing rows have a row state of <xref:System.Data.DataRowState.Added>, their primary key values are matched using the <xref:System.Data.DataRowVersion.Current> primary key value of the `Added` row because no `Original` row version exists.</span></span>  
  
 <span data-ttu-id="57e4e-111">受信テーブルと既存のテーブルに、名前が同じでデータ型が異なる列が含まれている場合、例外がスローされ、<xref:System.Data.DataSet.MergeFailed> の `DataSet` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-111">If an incoming table and an existing table contain a column with the same name but different data types, an exception is thrown and the <xref:System.Data.DataSet.MergeFailed> event of the `DataSet` is raised.</span></span> <span data-ttu-id="57e4e-112">受信テーブルと既存のテーブルの両方にキーが定義されていても、主キーの対象の列が異なる場合、例外がスローされ、`MergeFailed` の `DataSet` イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-112">If an incoming table and an existing table both have defined keys, but the primary keys are for different columns, an exception is thrown and the `MergeFailed` event of the `DataSet` is raised.</span></span>  
  
 <span data-ttu-id="57e4e-113">マージによって新しいデータを受け取るテーブルに主キーがない場合、受信データの新しい行とそのテーブルの既存の行は一致しません。その代わりに新しい行が既存のテーブルに追加されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-113">If the table receiving new data from a merge does not have a primary key, new rows from the incoming data cannot be matched to existing rows in the table and are instead appended to the existing table.</span></span>  
  
## <a name="table-names-and-namespaces"></a><span data-ttu-id="57e4e-114">テーブル名と名前空間</span><span class="sxs-lookup"><span data-stu-id="57e4e-114">Table Names and Namespaces</span></span>  
 <span data-ttu-id="57e4e-115"><xref:System.Data.DataTable> オブジェクトには、<xref:System.Data.DataTable.Namespace%2A> プロパティ値を割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-115"><xref:System.Data.DataTable> objects can optionally be assigned a <xref:System.Data.DataTable.Namespace%2A> property value.</span></span> <span data-ttu-id="57e4e-116"><xref:System.Data.DataTable.Namespace%2A> の値が割り当てられている場合、<xref:System.Data.DataSet> には、<xref:System.Data.DataTable> の値が同じである複数の <xref:System.Data.DataTable.TableName%2A> オブジェクトを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-116">When <xref:System.Data.DataTable.Namespace%2A> values are assigned, a <xref:System.Data.DataSet> can contain multiple <xref:System.Data.DataTable> objects with the same <xref:System.Data.DataTable.TableName%2A> value.</span></span> <span data-ttu-id="57e4e-117">マージ操作の際には、<xref:System.Data.DataTable.TableName%2A> と <xref:System.Data.DataTable.Namespace%2A> の両方を使用してマージの対象を識別します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-117">During merge operations, both <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataTable.Namespace%2A> are used to identify the target of a merge.</span></span> <span data-ttu-id="57e4e-118"><xref:System.Data.DataTable.Namespace%2A> が割り当てられていない場合、<xref:System.Data.DataTable.TableName%2A> のみを使用してマージの対象を識別します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-118">If no <xref:System.Data.DataTable.Namespace%2A> has been assigned, only the <xref:System.Data.DataTable.TableName%2A> is used to identify the target of a merge.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="57e4e-119">この動作は .NET Framework version 2.0 で変更されました。</span><span class="sxs-lookup"><span data-stu-id="57e4e-119">This behavior changed in version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="57e4e-120">.NET Framework version 1.1 では、名前空間はサポートされていましたが、マージ操作中には無視されました。</span><span class="sxs-lookup"><span data-stu-id="57e4e-120">In version 1.1, namespaces were supported but were ignored during merge operations.</span></span> <span data-ttu-id="57e4e-121">そのため、<xref:System.Data.DataSet> プロパティ値を使用する <xref:System.Data.DataTable.Namespace%2A> の動作は、実行されている .NET Framework のバージョンに応じて変わります。</span><span class="sxs-lookup"><span data-stu-id="57e4e-121">For this reason, a <xref:System.Data.DataSet> that uses <xref:System.Data.DataTable.Namespace%2A> property values will have different behaviors depending on which version of the .NET Framework you are running.</span></span> <span data-ttu-id="57e4e-122">たとえば、`DataSets` を含む 2 つの `DataTables` があり、どちらの <xref:System.Data.DataTable.TableName%2A> プロパティの値も同じですが、<xref:System.Data.DataTable.Namespace%2A> プロパティの値が異なっているとします。</span><span class="sxs-lookup"><span data-stu-id="57e4e-122">For example, suppose you have two `DataSets` containing `DataTables` with the same <xref:System.Data.DataTable.TableName%2A> property values but different <xref:System.Data.DataTable.Namespace%2A> property values.</span></span> <span data-ttu-id="57e4e-123">.NET Framework 1.1 では、この 2 つの <xref:System.Data.DataTable.Namespace%2A> オブジェクトをマージするときには <xref:System.Data.DataSet> の名前の違いが無視されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-123">In version 1.1 of the .NET Framework, the different <xref:System.Data.DataTable.Namespace%2A> names will be ignored when merging the two <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="57e4e-124">しかし、バージョン 2.0 以降では、マージを実行すると対象の `DataTables` に新しい <xref:System.Data.DataSet> が 2 つ作成されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-124">However, starting with version 2.0, merging causes two new `DataTables` to be created in the target <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="57e4e-125">元の `DataTables` はマージの影響を受けません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-125">The original `DataTables` will be unaffected by the merge.</span></span>  
  
## <a name="preservechanges"></a><span data-ttu-id="57e4e-126">PreserveChanges</span><span class="sxs-lookup"><span data-stu-id="57e4e-126">PreserveChanges</span></span>  
 <span data-ttu-id="57e4e-127">`DataSet`、`DataTable`、または `DataRow` の各配列を `Merge` メソッドに渡すときに、オプション パラメーターを含めることができます。そのパラメーターを使用して、変更内容を既存の `DataSet` に保存するかどうか、および受信データで見つかった新しいスキーマの要素を処理する方法を指定します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-127">When you pass a `DataSet`, `DataTable`, or `DataRow` array to the `Merge` method, you can include optional parameters that specify whether or not to preserve changes in the existing `DataSet`, and how to handle new schema elements found in the incoming data.</span></span> <span data-ttu-id="57e4e-128">受信データの後に続く最初のオプション パラメーターは、Boolean 型のフラグ <xref:System.Data.LoadOption.PreserveChanges> で、変更内容を既存の `DataSet` に保存するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-128">The first of these parameters after the incoming data is a Boolean flag, <xref:System.Data.LoadOption.PreserveChanges>, which specifies whether or not to preserve the changes in the existing `DataSet`.</span></span> <span data-ttu-id="57e4e-129">`PreserveChanges` フラグを `true` に設定した場合、既存の行の `Current` 行バージョンの値は受信する値で上書きされません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-129">If the `PreserveChanges` flag is set to `true`, incoming values do not overwrite existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="57e4e-130">`PreserveChanges` フラグを `false` に設定した場合、既存の行の `Current` 行バージョンの値が受信した値で上書きされます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-130">If the `PreserveChanges` flag is set to `false`, incoming values do overwrite the existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="57e4e-131">`PreserveChanges` フラグを指定しない場合は、既定で `false` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-131">If the `PreserveChanges` flag is not specified, it is set to `false` by default.</span></span> <span data-ttu-id="57e4e-132">行のバージョンの詳細については、次を参照してください。[行の状態と行のバージョン](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-132">For more information about row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span></span>  
  
 <span data-ttu-id="57e4e-133">`PreserveChanges` を `true` に設定すると、既存の行のデータは <xref:System.Data.DataRowVersion.Current> 行バージョンで保存されますが、既存の行の <xref:System.Data.DataRowVersion.Original> 行バージョンのデータは受信した行の `Original` 行バージョンのデータで上書きされます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-133">When `PreserveChanges` is `true`, the data from the existing row is maintained in the <xref:System.Data.DataRowVersion.Current> row version of the existing row, while the data from the <xref:System.Data.DataRowVersion.Original> row version of the existing row is overwritten with the data from the `Original` row version of the incoming row.</span></span> <span data-ttu-id="57e4e-134">既存の行の <xref:System.Data.DataRow.RowState%2A> は、<xref:System.Data.DataRowState.Modified> に設定されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-134">The <xref:System.Data.DataRow.RowState%2A> of the existing row is set to <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="57e4e-135">適用される例外を次に示します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-135">The following exceptions apply:</span></span>  
  
-   <span data-ttu-id="57e4e-136">既存の行の `RowState` が `Deleted` の場合、この `RowState` は `Deleted` のままであり、`Modified` には設定されません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-136">If the existing row has a `RowState` of `Deleted`, this `RowState` remains `Deleted` and is not set to `Modified`.</span></span> <span data-ttu-id="57e4e-137">この場合、受信した行のデータは既存の行の `Original` 行バージョンとして保存され、既存の行の `Original` 行バージョンのデータが上書きされます (受信する行の `RowState` が `Added` でない場合)。</span><span class="sxs-lookup"><span data-stu-id="57e4e-137">In this case, the data from the incoming row will still be stored in the `Original` row version of the existing row, overwriting the `Original` row version of the existing row (unless the incoming row has a `RowState` of `Added`).</span></span>  
  
-   <span data-ttu-id="57e4e-138">受信した行の `RowState` が `Added` の場合、受信した行には `Original` 行バージョンが存在しないため、既存の行の `Original` 行バージョンのデータは受信した行のデータで上書きされません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-138">If the incoming row has a `RowState` of `Added`, the data from the `Original` row version of the existing row will not be overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>  
  
 <span data-ttu-id="57e4e-139">`PreserveChanges` が `false` の場合、既存の行の `Current` と `Original` の両方の行バージョンが受信した行のデータで上書きされます。さらに、既存の行の `RowState` が、受信した行の `RowState` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-139">When `PreserveChanges` is `false`, both the `Current` and `Original` row versions in the existing row are overwritten with the data from the incoming row, and the `RowState` of the existing row is set to the `RowState` of the incoming row.</span></span> <span data-ttu-id="57e4e-140">適用される例外を次に示します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-140">The following exceptions apply:</span></span>  
  
-   <span data-ttu-id="57e4e-141">受信した行の `RowState` が `Unchanged` であり、既存の行の `RowState` が `Modified`、`Deleted`、または `Added` である場合、既存の行の `RowState` は `Modified` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-141">If the incoming row has a `RowState` of `Unchanged` and the existing row has a `RowState` of `Modified`, `Deleted`, or `Added`, the `RowState` of the existing row is set to `Modified`.</span></span>  
  
-   <span data-ttu-id="57e4e-142">受信した行の `RowState` が `Added` であり、既存の行の `RowState` が `Unchanged`、`Modified`、または `Deleted` である場合、既存の行の `RowState` は `Modified` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-142">If the incoming row has a `RowState` of `Added`, and the existing row has a `RowState` of `Unchanged`, `Modified`, or `Deleted`, the `RowState` of the existing row is set to `Modified`.</span></span> <span data-ttu-id="57e4e-143">また、受信した行には `Original` 行バージョンが存在しないため、既存の行の `Original` 行バージョンのデータは、受信した行のデータで上書きされません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-143">Also, the data from the `Original` row version of the existing row is not overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>  
  
## <a name="missingschemaaction"></a><span data-ttu-id="57e4e-144">MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="57e4e-144">MissingSchemaAction</span></span>  
 <span data-ttu-id="57e4e-145"><xref:System.Data.MissingSchemaAction> メソッドのオプションである `Merge` パラメーターを使用して、既存の `Merge` に含まれない受信データのスキーマ要素を `DataSet` で処理する方法を指定できます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-145">You can use the optional <xref:System.Data.MissingSchemaAction> parameter of the `Merge` method to specify how `Merge` will handle schema elements in the incoming data that are not part of the existing `DataSet`.</span></span>  
  
 <span data-ttu-id="57e4e-146">次の表で、`MissingSchemaAction` のオプションについて説明します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-146">The following table describes the options for `MissingSchemaAction`.</span></span>  
  
|<span data-ttu-id="57e4e-147">MissingSchemaAction のオプション</span><span class="sxs-lookup"><span data-stu-id="57e4e-147">MissingSchemaAction option</span></span>|<span data-ttu-id="57e4e-148">説明</span><span class="sxs-lookup"><span data-stu-id="57e4e-148">Description</span></span>|  
|--------------------------------|-----------------|  
|<xref:System.Data.MissingSchemaAction.Add>|<span data-ttu-id="57e4e-149">新しいスキーマ情報を `DataSet` に追加し、受信した値を新しい列に読み込みます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-149">Add the new schema information to the `DataSet` and populate the new columns with the incoming values.</span></span> <span data-ttu-id="57e4e-150">既定値です。</span><span class="sxs-lookup"><span data-stu-id="57e4e-150">This is the default.</span></span>|  
|<xref:System.Data.MissingSchemaAction.AddWithKey>|<span data-ttu-id="57e4e-151">新しいスキーマおよび主キーの情報を `DataSet` に追加し、受信した値を新しい列に読み込みます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-151">Add the new schema and primary key information to the `DataSet` and populate the new columns with the incoming values.</span></span>|  
|<xref:System.Data.MissingSchemaAction.Error>|<span data-ttu-id="57e4e-152">一致しないスキーマ情報が見つかった場合、例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="57e4e-152">Throw an exception if mismatched schema information is encountered.</span></span>|  
|<xref:System.Data.MissingSchemaAction.Ignore>|<span data-ttu-id="57e4e-153">新しいスキーマ情報を無視します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-153">Ignore the new schema information.</span></span>|  
  
## <a name="constraints"></a><span data-ttu-id="57e4e-154">制約</span><span class="sxs-lookup"><span data-stu-id="57e4e-154">Constraints</span></span>  
 <span data-ttu-id="57e4e-155">`Merge` メソッドでは、新しいデータがすべて既存の `DataSet` に追加されるまで制約がチェックされません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-155">With the `Merge` method, constraints are not checked until all new data has been added to the existing `DataSet`.</span></span> <span data-ttu-id="57e4e-156">データが追加されると、`DataSet` の現在の値に制約が適用されます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-156">Once the data has been added, constraints are enforced on the current values in the `DataSet`.</span></span> <span data-ttu-id="57e4e-157">開発者は、制約違反のためにスローされる例外をコードで処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="57e4e-157">You must ensure that your code handles any exceptions that might be thrown due to constraint violations.</span></span>  
  
 <span data-ttu-id="57e4e-158">`DataSet` 内に、`Unchanged` に設定され、主キー値が 1 である既存の行があるとします。</span><span class="sxs-lookup"><span data-stu-id="57e4e-158">Consider a case where an existing row in a `DataSet` is an `Unchanged` row with a primary key value of 1.</span></span> <span data-ttu-id="57e4e-159">マージ操作の際、受信した行が `Modified` に設定され、`Original` 行バージョンの主キーの値が 2 であり、`Current` 行バージョンの主キーの値が 1 である場合、`Original` 行バージョンの主キーの値が一致しないため、既存の行と受信した行は一致していると見なされません。</span><span class="sxs-lookup"><span data-stu-id="57e4e-159">During a merge operation with a `Modified` incoming row with an `Original` primary key value of 2 and a `Current` primary key value of 1, the existing row and the incoming row are not considered matching because the `Original` primary key values differ.</span></span> <span data-ttu-id="57e4e-160">マージが完了し、制約がチェックされると、`Current` 行バージョンの主キーの値が主キー列の UNIQUE 制約に違反するため、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-160">However, when the merge is completed and constraints are checked, an exception will be thrown because the `Current` primary key values violate the unique constraint for the primary key column.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="57e4e-161">ID 列などの自動インクリメント列を含むデータベース テーブルに行を挿入すると、挿入によって返される ID 列の値が `DataSet` の列の値と一致せず、返された列がマージされずに追加されることがあります。</span><span class="sxs-lookup"><span data-stu-id="57e4e-161">When rows are inserted into a database table containing an auto incrementing column such as an identity column, the identity column value returned by the insert may not match the value in the `DataSet`, causing the returned rows to be appended instead of merged.</span></span> <span data-ttu-id="57e4e-162">詳細については、次を参照してください。 [Id の取得や Autonumber 値](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md)です。</span><span class="sxs-lookup"><span data-stu-id="57e4e-162">For more information, see [Retrieving Identity or Autonumber Values](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>  
  
 <span data-ttu-id="57e4e-163">次のコード サンプルでは、スキーマが異なる 2 つの `DataSet` オブジェクトをマージし、その 2 つの受信 `DataSet` オブジェクトのスキーマを組み合わせたスキーマを持つ 1 つの `DataSet` を作成します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-163">The following code example merges two `DataSet` objects with differents schemas into one `DataSet` with the combined schemas of the two incoming `DataSet` objects.</span></span>  
  
 [!code-csharp[DataWorks DataSet.Merge#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/CS/source.cs#1)]
 [!code-vb[DataWorks DataSet.Merge#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/VB/source.vb#1)]  
  
 <span data-ttu-id="57e4e-164">次のコード サンプルでは、更新内容を含む既存の `DataSet` を取得し、その更新内容を `DataAdapter` に渡してデータ ソースで処理します。</span><span class="sxs-lookup"><span data-stu-id="57e4e-164">The following code example takes an existing `DataSet` with updates and passes those updates to a `DataAdapter` to be processed at the data source.</span></span> <span data-ttu-id="57e4e-165">次に、その結果を元の `DataSet` にマージします。</span><span class="sxs-lookup"><span data-stu-id="57e4e-165">The results are then merged into the original `DataSet`.</span></span> <span data-ttu-id="57e4e-166">エラーとなった変更内容が拒否された後、マージされた変更内容が `AcceptChanges` を使用してコミットされます。</span><span class="sxs-lookup"><span data-stu-id="57e4e-166">After rejecting changes that resulted in an error, the merged changes are committed with `AcceptChanges`.</span></span>  
  
 [!code-csharp[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#1)]
 [!code-vb[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#1)]  
  
 [!code-csharp[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#2)]
 [!code-vb[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#2)]  
  
## <a name="see-also"></a><span data-ttu-id="57e4e-167">関連項目</span><span class="sxs-lookup"><span data-stu-id="57e4e-167">See Also</span></span>  
 [<span data-ttu-id="57e4e-168">DataSet、DataTable、および DataView</span><span class="sxs-lookup"><span data-stu-id="57e4e-168">DataSets, DataTables, and DataViews</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)  
 [<span data-ttu-id="57e4e-169">行の状態とバージョン</span><span class="sxs-lookup"><span data-stu-id="57e4e-169">Row States and Row Versions</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)  
 [<span data-ttu-id="57e4e-170">DataAdapter と DataReader</span><span class="sxs-lookup"><span data-stu-id="57e4e-170">DataAdapters and DataReaders</span></span>](../../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)  
 [<span data-ttu-id="57e4e-171">ADO.NET でのデータの取得および変更</span><span class="sxs-lookup"><span data-stu-id="57e4e-171">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)  
 [<span data-ttu-id="57e4e-172">ID 値および Autonumber 値の取得</span><span class="sxs-lookup"><span data-stu-id="57e4e-172">Retrieving Identity or Autonumber Values</span></span>](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md)  
 [<span data-ttu-id="57e4e-173">ADO.NET のマネージ プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="57e4e-173">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
