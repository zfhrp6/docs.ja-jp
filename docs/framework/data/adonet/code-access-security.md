---
title: "コード アクセス セキュリティと ADO.NET"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 93e099eb-daa1-4f1e-b031-c1e10a996f88
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 754c380972d79343eab83b9e862e478798218ffc
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/22/2017
---
# <a name="code-access-security-and-adonet"></a><span data-ttu-id="2b9c3-102">コード アクセス セキュリティと ADO.NET</span><span class="sxs-lookup"><span data-stu-id="2b9c3-102">Code Access Security and ADO.NET</span></span>
<span data-ttu-id="2b9c3-103">.NET Framework はコード アクセス セキュリティ (CAS) に加えてロール ベースのセキュリティを備えています。どちらも、共通言語ランタイム (CLR) が提供する共通のインフラストラクチャを使って実装されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-103">The .NET Framework offers role-based security as well as code access security (CAS), both of which are implemented using a common infrastructure supplied by the common language runtime (CLR).</span></span> <span data-ttu-id="2b9c3-104">アンマネージ コードの場合、ほとんどのアプリケーションはユーザーまたはプリンシパルの権限で実行されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-104">In the world of unmanaged code, most applications execute with the permissions of the user or principal.</span></span> <span data-ttu-id="2b9c3-105">そのため、悪意のあるソフトウェアやエラーを含むソフトウェアが、システム特権を持つユーザーによって実行された場合、コンピューター システムが被害を受けたり、機密データが改ざんされる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-105">As a result, computer systems can be damaged and private data compromised when malicious or error-filled software is run by a user with elevated privileges.</span></span>  
  
 <span data-ttu-id="2b9c3-106">これに対し、.NET Framework で実行されるマネージ コードには、コードそのものに適用されるコード アクセス セキュリティが存在します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-106">By contrast, managed code executing in the .NET Framework includes code access security, which applies to code alone.</span></span> <span data-ttu-id="2b9c3-107">コードの実行が許可されるかどうかは、プリンシパルの ID だけでなく、コードの作成元など、コードの ID を表す情報に依存します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-107">Whether the code is allowed to run or not depends on the code's origin or other aspects of the code's identity, not solely the identity of the principal.</span></span> <span data-ttu-id="2b9c3-108">これにより、マネージ コードが誤用される可能性が低くなります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-108">This reduces the likelihood that managed code can be misused.</span></span>  
  
## <a name="code-access-permissions"></a><span data-ttu-id="2b9c3-109">コード アクセス許可</span><span class="sxs-lookup"><span data-stu-id="2b9c3-109">Code Access Permissions</span></span>  
 <span data-ttu-id="2b9c3-110">コードは、実行されるときに、CLR のセキュリティ システムで評価される証拠を提示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-110">When code is executed, it presents evidence that is evaluated by the CLR security system.</span></span> <span data-ttu-id="2b9c3-111">通常、この証拠は、URL、サイト、ゾーン、アセンブリの ID を保証するデジタル署名などのコードの作成元に関する情報で構成されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-111">Typically, this evidence comprises the origin of the code including URL, site, and zone, and digital signatures that ensure the identity of the assembly.</span></span>  
  
 <span data-ttu-id="2b9c3-112">CLR は、そのコードに許されている操作の範囲内で実行を許可します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-112">The CLR allows code to perform only those operations that the code has permission to perform.</span></span> <span data-ttu-id="2b9c3-113">コードは権限を要求できますが、その要求は管理者が設定したセキュリティ ポリシーに基づいて受理されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-113">Code can request permissions, and those requests are honored based on the security policy set by an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2b9c3-114">CLR で実行されるコード自体に、アクセス許可を与えることはできません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-114">Code executing in the CLR cannot grant permissions to itself.</span></span> <span data-ttu-id="2b9c3-115">たとえば、コードから要求できる権限は、セキュリティ ポリシーによって許可されたレベルよりも低い権限だけであり、それを超える権限が付与されることはありません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-115">For example, code can request and be granted fewer permissions than a security policy allows, but it will never be granted more permissions.</span></span> <span data-ttu-id="2b9c3-116">権限を付与する場合は、まず、権限をまったく付与しない状態から始め、その後で、実行しようとする特定のタスクに必要な最小限の権限を追加してゆくようにします。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-116">When granting permissions, start with no permissions at all and then add the narrowest permissions for the particular task being performed.</span></span> <span data-ttu-id="2b9c3-117">すべての権限を与えてから、不要なものを 1 つずつ拒否していく方法では、アプリケーションを危険にさらす結果となります。必要以上の権限を付与することによって意図しないセキュリティ ホールを招く可能性があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-117">Starting with all permissions and then denying individual ones leads to insecure applications that may contain unintentional security holes from granting more permissions than required.</span></span> <span data-ttu-id="2b9c3-118">詳細については、次を参照してください。 [NIB: セキュリティ ポリシーを構成する](http://msdn.microsoft.com/en-us/0f130bcd-1bba-4346-b231-0bcca7dab1a4)と[NIB: セキュリティ ポリシーの管理](http://msdn.microsoft.com/en-us/d754e05d-29dc-4d3a-a2c2-95eaaf1b82b9)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-118">For more information, see [NIB: Configuring Security Policy](http://msdn.microsoft.com/en-us/0f130bcd-1bba-4346-b231-0bcca7dab1a4) and [NIB: Security Policy Management](http://msdn.microsoft.com/en-us/d754e05d-29dc-4d3a-a2c2-95eaaf1b82b9).</span></span>  
  
 <span data-ttu-id="2b9c3-119">コードのアクセス権限には、次の 3 種類があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-119">There are three types of code access permissions:</span></span>  
  
-   <span data-ttu-id="2b9c3-120">`Code access permissions`。<xref:System.Security.CodeAccessPermission> クラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-120">`Code access permissions` derive from the <xref:System.Security.CodeAccessPermission> class.</span></span> <span data-ttu-id="2b9c3-121">ファイルや環境変数などの保護されたリソースにアクセスして、保護された操作 (アンマネージ コードへのアクセスなど) を実行するには権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-121">Permissions are required in order to access protected resources, such as files and environment variables, and to perform protected operations, such as accessing unmanaged code.</span></span>  
  
-   <span data-ttu-id="2b9c3-122">`Identity permissions`。アセンブリを識別する特性を表します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-122">`Identity permissions` represent characteristics that identify an assembly.</span></span> <span data-ttu-id="2b9c3-123">アセンブリには証拠に基づいて権限が付与されます。証拠には、デジタル署名やコードの作成元などの情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-123">Permissions are granted to an assembly based on evidence, which can include items such as a digital signature or where the code originated.</span></span> <span data-ttu-id="2b9c3-124">ID 権限も <xref:System.Security.CodeAccessPermission> 基本クラスから派生します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-124">Identity permissions also derive from the <xref:System.Security.CodeAccessPermission> base class.</span></span>  
  
-   <span data-ttu-id="2b9c3-125">`Role-based security permissions`。プリンシパルが、指定された ID を持っているか、または、指定されたロールに属しているかどうかに基づきます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-125">`Role-based security permissions` are based on whether a principal has a specified identity or is a member of a specified role.</span></span> <span data-ttu-id="2b9c3-126"><xref:System.Security.Permissions.PrincipalPermission> クラスにより、アクティブなプリンシパルに対する宣言型および命令型の権限チェックが可能となります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-126">The <xref:System.Security.Permissions.PrincipalPermission> class allows both declarative and imperative permission checks against the active principal.</span></span>  
  
 <span data-ttu-id="2b9c3-127">ランタイムのセキュリティ システムは、特定のリソースへのアクセスまたは特定の操作の実行がコードに許されているかどうかを判断するため、呼び出し履歴をたどりながら、各呼び出し元に付与されている権限と、要求されている権限とを比較します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-127">To determine whether code is authorized to access a resource or perform an operation, the runtime's security system traverses the call stack, comparing the granted permissions of each caller to the permission being demanded.</span></span> <span data-ttu-id="2b9c3-128">呼び出し履歴に、要求された権限を持たない呼び出し元が 1 つでも見つかった場合、<xref:System.Security.SecurityException> がスローされてアクセスが拒否されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-128">If any caller in the call stack does not have the demanded permission, a <xref:System.Security.SecurityException> is thrown and access is refused.</span></span>  
  
### <a name="requesting-permissions"></a><span data-ttu-id="2b9c3-129">権限の要求</span><span class="sxs-lookup"><span data-stu-id="2b9c3-129">Requesting Permissions</span></span>  
 <span data-ttu-id="2b9c3-130">権限を要求する目的は、そのアプリケーションを実行するために必要な権限をランタイムに伝えると共に、実際に必要な権限以外は付与されないようにすることです。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-130">The purpose of requesting permissions is to inform the runtime which permissions your application requires in order to run, and to ensure that it receives only the permissions that it actually needs.</span></span> <span data-ttu-id="2b9c3-131">たとえば、ローカル ディスクにデータを書き込むアプリケーションは <xref:System.Security.Permissions.FileIOPermission> を必要とします。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-131">For example, if your application needs to write data to the local disk, it requires <xref:System.Security.Permissions.FileIOPermission>.</span></span> <span data-ttu-id="2b9c3-132">この権限が付与されていない場合、アプリケーションがディスクへの書き込みを試行した時点で実行に失敗します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-132">If that permission hasn't been granted, the application will fail when it attempts to write to the disk.</span></span> <span data-ttu-id="2b9c3-133">ただし、アプリケーションから `FileIOPermission` を要求した場合、その権限が付与されなければ、最初の段階で例外が生成され、アプリケーションが読み込まれることはありません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-133">However, if the application requests `FileIOPermission` and that permission has not been granted, the application will generate the exception at the outset and will not load.</span></span>  
  
 <span data-ttu-id="2b9c3-134">ディスクからのデータの読み取りだけを必要とするアプリケーションでは、書き込み権限が決して付与されないように要求できます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-134">In a scenario where the application only needs to read data from the disk, you can request that it never be granted any write permissions.</span></span> <span data-ttu-id="2b9c3-135">バグが存在していたり、悪意のある攻撃を受けたとしても、操作の対象となるデータに損害を与えることはありません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-135">In the event of a bug or a malicious attack, your code cannot damage the data on which it operates.</span></span> <span data-ttu-id="2b9c3-136">詳細については、次を参照してください。 [NIB: アクセス許可の要求](http://msdn.microsoft.com/en-us/0447c49d-8cba-45e4-862c-ff0b59bebdc2)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-136">For more information, see [NIB: Requesting Permissions](http://msdn.microsoft.com/en-us/0447c49d-8cba-45e4-862c-ff0b59bebdc2).</span></span>  
  
## <a name="role-based-security-and-cas"></a><span data-ttu-id="2b9c3-137">ロール ベースのセキュリティと CAS</span><span class="sxs-lookup"><span data-stu-id="2b9c3-137">Role-Based Security and CAS</span></span>  
 <span data-ttu-id="2b9c3-138">ロール ベースのセキュリティとコード アクセス セキュリティ (CAS) の両方を実装することで、アプリケーションの全体的なセキュリティを高めることができます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-138">Implementing both role-based security and code-accessed security (CAS) enhances overall security for your application.</span></span> <span data-ttu-id="2b9c3-139">ロール ベースのセキュリティには、Windows アカウントまたはカスタム ID を使用できます。セキュリティ プリンシパルに関する情報には、現在のスレッドからアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-139">Role-based security can be based on a Windows account or a custom identity, making information about the security principal available to the current thread.</span></span> <span data-ttu-id="2b9c3-140">また、ユーザーによって指定された資格情報に基づいて、データやリソースへのアクセスを提供するアプリケーションも少なくありません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-140">In addition, applications are often required to provide access to data or resources based on credentials supplied by the user.</span></span> <span data-ttu-id="2b9c3-141">このようなアプリケーションは、通常、ユーザーのロールを調べ、そのロールに基づいてリソースへのアクセスを許可します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-141">Typically, such applications check the role of a user and provide access to resources based on those roles.</span></span>  
  
 <span data-ttu-id="2b9c3-142">ロール ベースのセキュリティを使用することで、コンポーネントが、現在のユーザーおよびそのユーザーに関連付けられているロールを実行時に特定できるようになります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-142">Role-based security enables a component to identify current users and their associated roles at run time.</span></span> <span data-ttu-id="2b9c3-143">この情報を CAS ポリシーを使ってマッピングすることによって、一連の権限が実行時に判別されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-143">This information is then mapped using a CAS policy to determine the set of permissions granted at run time.</span></span> <span data-ttu-id="2b9c3-144">特定のアプリケーション ドメインでは、ホストが既定のロール ベース セキュリティ ポリシーを変更し、ユーザーおよびそのユーザーに関連付けられたロールを表す既定のセキュリティ プリンシパルを設定できます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-144">For a specified application domain, the host can change the default role-based security policy and set a default security principal that represents a user and the roles associated with that user.</span></span>  
  
 <span data-ttu-id="2b9c3-145">CLR にはマネージ コードに制限を適用するためのメカニズムが、権限を使用することによって実装されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-145">The CLR uses permissions to implement its mechanism for enforcing restrictions on managed code.</span></span> <span data-ttu-id="2b9c3-146">ロール ベースのセキュリティ権限により、ユーザー (またはユーザーのために行動するエージェント) が特定の ID を持っているかどうか、または特定のロールに所属しているかどうかを検出するメカニズムが実現されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-146">Role-based security permissions provide a mechanism for discovering whether a user (or the agent acting on the user's behalf) has a particular identity or is a member of a specified role.</span></span> <span data-ttu-id="2b9c3-147">詳細については、次を参照してください。[セキュリティのアクセス許可](http://msdn.microsoft.com/en-us/b03757b4-e926-4196-b738-3733ced2bda0)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-147">For more information, see [Security Permissions](http://msdn.microsoft.com/en-us/b03757b4-e926-4196-b738-3733ced2bda0).</span></span>  
  
 <span data-ttu-id="2b9c3-148">開発しているアプリケーションの種類によっては、データベースに対するロール ベースの権限の実装も考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-148">Depending on the type of application you are building, you should also consider implementing role-based permissions in the database.</span></span> <span data-ttu-id="2b9c3-149">SQL Server でのロールベースのセキュリティの詳細については、次を参照してください。 [SQL Server のセキュリティ](../../../../docs/framework/data/adonet/sql/sql-server-security.md)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-149">For more information on role-based security in SQL Server, see [SQL Server Security](../../../../docs/framework/data/adonet/sql/sql-server-security.md).</span></span>  
  
## <a name="assemblies"></a><span data-ttu-id="2b9c3-150">アセンブリ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-150">Assemblies</span></span>  
 <span data-ttu-id="2b9c3-151">アセンブリは、.NET Framework アプリケーションの配置、バージョン管理、再利用、アクティベーション スコープ、およびセキュリティ権限の基本単位です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-151">Assemblies form the fundamental unit of deployment, version control, reuse, activation scoping, and security permissions for a .NET Framework application.</span></span> <span data-ttu-id="2b9c3-152">アセンブリは、互いに連携して動作するように作成された一連の型やリソースを提供し、"機能" の論理上の単位を成すものです。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-152">An assembly provides a collection of types and resources that are built to work together and form a logical unit of functionality.</span></span> <span data-ttu-id="2b9c3-153">CLR から見て、型がアセンブリのコンテキスト外に存在することはありません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-153">To the CLR, a type does not exist outside the context of an assembly.</span></span> <span data-ttu-id="2b9c3-154">作成して、アセンブリの展開の詳細については、次を参照してください。[アセンブリを使用したプログラミング](../../../../docs/framework/app-domains/programming-with-assemblies.md)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-154">For more information on creating and deploying assemblies, see [Programming with Assemblies](../../../../docs/framework/app-domains/programming-with-assemblies.md).</span></span>  
  
### <a name="strong-naming-assemblies"></a><span data-ttu-id="2b9c3-155">厳密な名前付きアセンブリ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-155">Strong-naming Assemblies</span></span>  
 <span data-ttu-id="2b9c3-156">厳密な名前 (デジタル署名) は、アセンブリの ID (単純なテキスト名、バージョン番号、および使用可能な場合はカルチャ情報) と、公開キーおよびデジタル署名で構成されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-156">A strong name, or digital signature, consists of the assembly's identity, which includes its simple text name, version number, and culture information (if provided), plus a public key and a digital signature.</span></span> <span data-ttu-id="2b9c3-157">このデジタル署名は、対応する秘密キーを使用してアセンブリ ファイルから生成されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-157">The digital signature is generated from an assembly file using the corresponding private key.</span></span> <span data-ttu-id="2b9c3-158">アセンブリ ファイルにはアセンブリ マニフェストが格納されており、そこに、アセンブリを構成するすべてのファイルの名前とハッシュが含まれます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-158">The assembly file contains the assembly manifest, which contains the names and hashes of all the files that make up the assembly.</span></span>  
  
 <span data-ttu-id="2b9c3-159">アセンブリに厳密な名前を付けることで、アプリケーションやコンポーネントに一意の ID が与えられます。他のソフトウェアは、その ID を使用することで、対応するアプリケーションまたはコンポーネントを明示的に参照できます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-159">Strong naming an assembly gives an application or component a unique identity that other software can use to refer explicitly to it.</span></span> <span data-ttu-id="2b9c3-160">アセンブリに厳密な名前を付けると、悪意のあるコードを含むアセンブリのなりすましから保護することができます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-160">Strong naming guards assemblies against being spoofed by an assembly that contains hostile code.</span></span> <span data-ttu-id="2b9c3-161">また、異なるバージョンのコンポーネント間でバージョンの整合性をとることもできます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-161">Strong-naming also ensures versioning consistency among different versions of a component.</span></span> <span data-ttu-id="2b9c3-162">グローバル アセンブリ キャッシュ (GAC) に展開されるアセンブリには、厳密な名前を付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-162">You must strong name assemblies that will be deployed to the Global Assembly Cache (GAC).</span></span> <span data-ttu-id="2b9c3-163">詳しくは、「[厳密な名前付きアセンブリの作成と使用](../../../../docs/framework/app-domains/create-and-use-strong-named-assemblies.md)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-163">For more information, see [Creating and Using Strong-Named Assemblies](../../../../docs/framework/app-domains/create-and-use-strong-named-assemblies.md).</span></span>  
  
## <a name="partial-trust-in-adonet-20"></a><span data-ttu-id="2b9c3-164">ADO.NET 2.0 での Partial Trust (部分信頼)</span><span class="sxs-lookup"><span data-stu-id="2b9c3-164">Partial Trust in ADO.NET 2.0</span></span>  
 <span data-ttu-id="2b9c3-165">ADO.NET 2.0 では、.NET Framework Data Provider for SQL Server、.NET Framework Data Provider for OLE DB、.NET Framework Data Provider for ODBC、および .NET Framework Data Provider for Oracle のすべてが、部分的に信頼された環境でも実行できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-165">In ADO.NET 2.0, the .NET Framework Data Provider for SQL Server, the .NET Framework Data Provider for OLE DB, the .NET Framework Data Provider for ODBC, and the .NET Framework Data Provider for Oracle can now all run in partially trusted environments.</span></span> <span data-ttu-id="2b9c3-166">.NET Framework の以前のリリースでは、信頼性のレベルが full-trust よりも低いアプリケーションでは <xref:System.Data.SqlClient> のみがサポートされていました。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-166">In previous releases of the .NET Framework, only <xref:System.Data.SqlClient> was supported in less than full-trust applications.</span></span>  
  
 <span data-ttu-id="2b9c3-167">SQL Server プロバイダーを使用する部分的に信頼できるアプリケーションは、少なくとも、Execution アクセス許可と <xref:System.Data.SqlClient.SqlClientPermission> アクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-167">At minimum, a partially trusted application using the SQL Server provider must have execution and <xref:System.Data.SqlClient.SqlClientPermission> permissions.</span></span>  
  
### <a name="permission-attribute-properties-for-partial-trust"></a><span data-ttu-id="2b9c3-168">Partial Trust (部分信頼) のアクセス許可属性プロパティ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-168">Permission Attribute Properties for Partial Trust</span></span>  
 <span data-ttu-id="2b9c3-169">部分信頼のシナリオでは、<xref:System.Data.SqlClient.SqlClientPermissionAttribute> メンバーを使用して、.NET Framework Data Provider for SQL Server が使用できる機能をさらに制限することができます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-169">For partial trust scenarios, you can use <xref:System.Data.SqlClient.SqlClientPermissionAttribute> members to further restrict the capabilities available for the .NET Framework Data Provider for SQL Server.</span></span>  
  
 <span data-ttu-id="2b9c3-170">使用可能な <xref:System.Data.SqlClient.SqlClientPermissionAttribute> プロパティとその説明を次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-170">The following table lists the available <xref:System.Data.SqlClient.SqlClientPermissionAttribute> properties and their descriptions:</span></span>  
  
|<span data-ttu-id="2b9c3-171">アクセス許可属性プロパティ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-171">Permission attribute property</span></span>|<span data-ttu-id="2b9c3-172">説明</span><span class="sxs-lookup"><span data-stu-id="2b9c3-172">Description</span></span>|  
|-----------------------------------|-----------------|  
|`Action`|<span data-ttu-id="2b9c3-173">セキュリティ アクションを取得または設定します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-173">Gets or sets a security action.</span></span> <span data-ttu-id="2b9c3-174">このプロパティは、<xref:System.Security.Permissions.SecurityAttribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-174">Inherited from <xref:System.Security.Permissions.SecurityAttribute>.</span></span>|  
|`AllowBlankPassword`|<span data-ttu-id="2b9c3-175">接続文字列内で空白のパスワードの使用を許可または禁止します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-175">Enables or disables the use of a blank password in a connection string.</span></span> <span data-ttu-id="2b9c3-176">有効な値は、空白のパスワードの使用を許可する `true` および空白のパスワードの使用を禁止する `false` です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-176">Valid values are `true` (to enable the use of blank passwords) and `false` (to disable the use of blank passwords).</span></span> <span data-ttu-id="2b9c3-177">このプロパティは、<xref:System.Data.Common.DBDataPermissionAttribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-177">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`ConnectionString`|<span data-ttu-id="2b9c3-178">使用できる接続文字列を指定します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-178">Identifies a permitted connection string.</span></span> <span data-ttu-id="2b9c3-179">複数の接続文字列を指定できます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-179">Multiple connection strings can be identified.</span></span> <span data-ttu-id="2b9c3-180">**注:**接続文字列でユーザー ID またはパスワードを含まれません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-180">**Note:**  Do not include a user ID or password in your connection string.</span></span> <span data-ttu-id="2b9c3-181">このリリースでは、.NET Framework 構成ツールを使用して接続文字列制限を変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-181">In this release, you cannot change connection string restrictions using the .NET Framework Configuration Tool.</span></span> <br /><br /> <span data-ttu-id="2b9c3-182">このプロパティは、<xref:System.Data.Common.DBDataPermissionAttribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-182">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`KeyRestrictions`|<span data-ttu-id="2b9c3-183">許可または禁止する接続文字列パラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-183">Identifies connection string parameters that are allowed or disallowed.</span></span> <span data-ttu-id="2b9c3-184">接続文字列パラメーターが、フォームで識別される*\<パラメーター名 > =*です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-184">Connection string parameters are identified in the form *\<parameter name>=*.</span></span> <span data-ttu-id="2b9c3-185">セミコロン (;) で区切って、複数のパラメーターを指定できます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-185">Multiple parameters can be specified, delimited using a semicolon (;).</span></span> <span data-ttu-id="2b9c3-186">**注:**を指定しない場合`KeyRestrictions`、設定するが、`KeyRestrictionBehavior`プロパティを`AllowOnly`または`PreventUsage`、追加の接続文字列パラメーターは許可されていません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-186">**Note:**  If you do not specify `KeyRestrictions`, but you set `KeyRestrictionBehavior` property to `AllowOnly` or `PreventUsage`, no additional connection string parameters are allowed.</span></span> <span data-ttu-id="2b9c3-187">このプロパティは、<xref:System.Data.Common.DBDataPermissionAttribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-187">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`KeyRestrictionBehavior`|<span data-ttu-id="2b9c3-188">接続文字列パラメーターが、追加を許可された唯一の接続文字列パラメーター (`AllowOnly`) か、または追加を禁止された接続文字列パラメーター (`PreventUsage`) かを指定します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-188">Identifies the connection string parameters as the only additional parameters allowed (`AllowOnly`), or identifies the additional parameters that are not allowed (`PreventUsage`).</span></span> <span data-ttu-id="2b9c3-189">`AllowOnly` が既定値です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-189">`AllowOnly` is the default.</span></span> <span data-ttu-id="2b9c3-190">このプロパティは、<xref:System.Data.Common.DBDataPermissionAttribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-190">Inherited from <xref:System.Data.Common.DBDataPermissionAttribute>.</span></span>|  
|`TypeID`|<span data-ttu-id="2b9c3-191">派生クラスで実装すると、この属性の一意の識別子を取得します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-191">Gets a unique identifier for this attribute when implemented in a derived class.</span></span> <span data-ttu-id="2b9c3-192">このプロパティは、<xref:System.Attribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-192">Inherited from <xref:System.Attribute>.</span></span>|  
|`Unrestricted`|<span data-ttu-id="2b9c3-193">このリソースに対する無制限のアクセス許可が宣言されているかどうかを示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-193">Indicates whether unrestricted permission to the resource is declared.</span></span> <span data-ttu-id="2b9c3-194">このプロパティは、<xref:System.Security.Permissions.SecurityAttribute> から継承されています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-194">Inherited from <xref:System.Security.Permissions.SecurityAttribute>.</span></span>|  
  
#### <a name="connectionstring-syntax"></a><span data-ttu-id="2b9c3-195">ConnectionString の構文</span><span class="sxs-lookup"><span data-stu-id="2b9c3-195">ConnectionString Syntax</span></span>  
 <span data-ttu-id="2b9c3-196">次の例では、特定の接続文字列のみ使用できるようにするために、構成ファイルの `connectionStrings` 要素を使用する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-196">The following example demonstrates how to use the `connectionStrings` element of a configuration file to allow only a specific connection string to be used.</span></span> <span data-ttu-id="2b9c3-197">参照してください[接続文字列](../../../../docs/framework/data/adonet/connection-strings.md)について詳細を格納して、構成ファイルから接続文字列を取得します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-197">See [Connection Strings](../../../../docs/framework/data/adonet/connection-strings.md) for more information on storing and retrieving connection strings from configuration files.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;" />  
</connectionStrings>  
```  
  
#### <a name="keyrestrictions-syntax"></a><span data-ttu-id="2b9c3-198">KeyRestrictions の構文</span><span class="sxs-lookup"><span data-stu-id="2b9c3-198">KeyRestrictions Syntax</span></span>  
 <span data-ttu-id="2b9c3-199">次の例の同じ接続文字列、使用できるように、`Encrypt`と`Packet``Size`接続文字列のいずれかのオプションが他の接続文字列オプションの使用を制限します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-199">The following example enables the same connection string, enables the use of the `Encrypt` and `Packet``Size` connection string options, but restricts the use of any other connection string options.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;"  
    KeyRestrictions="Encrypt=;Packet Size=;"  
    KeyRestrictionBehavior="AllowOnly" />  
</connectionStrings>  
```  
  
#### <a name="keyrestrictionbehavior-with-preventusage-syntax"></a><span data-ttu-id="2b9c3-200">KeyRestrictionBehavior を PreventUsage に設定する場合の構文</span><span class="sxs-lookup"><span data-stu-id="2b9c3-200">KeyRestrictionBehavior with PreventUsage Syntax</span></span>  
 <span data-ttu-id="2b9c3-201">上述の接続文字列の使用を許可し、`User Id`、`Password`、および `Persist Security Info` を除く他のすべての接続パラメーターを許可する例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-201">The following example enables the same connection string and allows all other connection parameters except for `User Id`, `Password` and `Persist Security Info`.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;"  
    KeyRestrictions="User Id=;Password=;Persist Security Info=;"  
    KeyRestrictionBehavior="PreventUsage" />  
</connectionStrings>  
```  
  
#### <a name="keyrestrictionbehavior-with-allowonly-syntax"></a><span data-ttu-id="2b9c3-202">KeyRestrictionBehavior を AllowOnly に設定する場合の構文</span><span class="sxs-lookup"><span data-stu-id="2b9c3-202">KeyRestrictionBehavior with AllowOnly Syntax</span></span>  
 <span data-ttu-id="2b9c3-203">`Initial Catalog`、`Connection Timeout`、`Encrypt`、および `Packet Size` パラメーターも含まれる 2 つの接続文字列の使用を許可する例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-203">The following example enables two connection strings that also contain `Initial Catalog`, `Connection Timeout`, `Encrypt`, and `Packet Size` parameters.</span></span> <span data-ttu-id="2b9c3-204">その他の接続文字列パラメーターは、すべて制限されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-204">All other connection string parameters are restricted.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="DatabaseConnection"   
    connectionString="Data Source=(local);Initial   
    Catalog=Northwind;Integrated Security=true;"  
    KeyRestrictions="Initial Catalog;Connection Timeout=;  
       Encrypt=;Packet Size=;"   
    KeyRestrictionBehavior="AllowOnly" />  
  
  <add name="DatabaseConnection2"   
    connectionString="Data Source=SqlServer2;Initial   
    Catalog=Northwind2;Integrated Security=true;"  
    KeyRestrictions="Initial Catalog;Connection Timeout=;  
       Encrypt=;Packet Size=;"   
    KeyRestrictionBehavior="AllowOnly" />  
</connectionStrings>  
```  
  
### <a name="enabling-partial-trust-with-a-custom-permission-set"></a><span data-ttu-id="2b9c3-205">カスタム アクセス許可セットを使用した Partial Trust の有効化</span><span class="sxs-lookup"><span data-stu-id="2b9c3-205">Enabling Partial Trust with a Custom Permission Set</span></span>  
 <span data-ttu-id="2b9c3-206">特定のゾーンに対して <xref:System.Data.SqlClient> アクセス許可を有効にするには、システム管理者がカスタム アクセス許可セットを作成して、目的のゾーンに指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-206">To enable the use of <xref:System.Data.SqlClient> permissions for a particular zone, a system administrator must create a custom permission set and set it as the permission set for a particular zone.</span></span> <span data-ttu-id="2b9c3-207">`LocalIntranet` などの既定のアクセス許可セットは変更できません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-207">Default permission sets, such as `LocalIntranet`, cannot be modified.</span></span> <span data-ttu-id="2b9c3-208">例については、含める<xref:System.Data.SqlClient>がコードのアクセス許可、<xref:System.Security.Policy.Zone>の`LocalIntranet`、システム管理者の権限セットをコピーでした`LocalIntranet`、"CustomLocalIntranet"に名前を変更、追加、<xref:System.Data.SqlClient>権限、インポートCustomLocalIntranet アクセス許可セットを使用して、 [Caspol.exe (コード アクセス セキュリティ ポリシー ツール)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md)の権限のセットを設定および`LocalIntranet_Zone`CustomLocalIntranet にします。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-208">For example, to include <xref:System.Data.SqlClient> permissions for code that has a <xref:System.Security.Policy.Zone> of `LocalIntranet`, a system administrator could copy the permission set for `LocalIntranet`, rename it to "CustomLocalIntranet", add the <xref:System.Data.SqlClient> permissions, import the CustomLocalIntranet permission set using the [Caspol.exe (Code Access Security Policy Tool)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md), and set the permission set of `LocalIntranet_Zone` to CustomLocalIntranet.</span></span>  
  
### <a name="sample-permission-set"></a><span data-ttu-id="2b9c3-209">サンプル アクセス許可セット</span><span class="sxs-lookup"><span data-stu-id="2b9c3-209">Sample Permission Set</span></span>  
 <span data-ttu-id="2b9c3-210">部分信頼のシナリオでの、.NET Framework Data Provider for SQL Server 用アクセス許可セットの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-210">The following is a sample permission set for the .NET Framework Data Provider for SQL Server in a partially trusted scenario.</span></span> <span data-ttu-id="2b9c3-211">カスタム権限セットを作成する方法については、次を参照してください。 [NIB: を構成するアクセス許可設定を使用して Caspol.exe](http://msdn.microsoft.com/en-us/94e2625e-21ad-4038-af36-6d1f9df40a57)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-211">For information on creating custom permission sets, see [NIB:Configuring Permission Sets Using Caspol.exe](http://msdn.microsoft.com/en-us/94e2625e-21ad-4038-af36-6d1f9df40a57).</span></span>  
  
```xml  
<PermissionSet class="System.Security.NamedPermissionSet"  
  version="1"  
  Name="CustomLocalIntranet"  
  Description="Custom permission set given to applications on  
    the local intranet">  
  
<IPermission class="System.Data.SqlClient.SqlClientPermission, System.Data, Version=2.0.0000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"  
version="1"  
AllowBlankPassword="False">  
<add ConnectionString="Data Source=(local);Integrated Security=true;"  
 KeyRestrictions="Initial Catalog=;Connection Timeout=;  
   Encrypt=;Packet Size=;"   
 KeyRestrictionBehavior="AllowOnly" />  
 </IPermission>  
</PermissionSet>  
```  
  
## <a name="verifying-adonet-code-access-using-security-permissions"></a><span data-ttu-id="2b9c3-212">セキュリティ アクセス許可を使用した ADO.NET コード アクセスの検証</span><span class="sxs-lookup"><span data-stu-id="2b9c3-212">Verifying ADO.NET Code Access Using Security Permissions</span></span>  
 <span data-ttu-id="2b9c3-213">部分信頼のシナリオでは、<xref:System.Data.SqlClient.SqlClientPermissionAttribute> を指定することによって、コード内の特定のメソッドに対する CAS 特権を要求できます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-213">For partial-trust scenarios, you can require CAS privileges for particular methods in your code by specifying a <xref:System.Data.SqlClient.SqlClientPermissionAttribute>.</span></span> <span data-ttu-id="2b9c3-214">制限されたセキュリティ ポリシーによって、実際にはその特権が許可されていない場合は、そのコードを実行する前に例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-214">If that privilege is not allowed by the restricted security policy in effect, an exception is thrown before your code is run.</span></span> <span data-ttu-id="2b9c3-215">セキュリティ ポリシーの詳細については、次を参照してください。 [NIB: セキュリティ ポリシーの管理](http://msdn.microsoft.com/en-us/d754e05d-29dc-4d3a-a2c2-95eaaf1b82b9)と[NIB: セキュリティ ポリシーのベスト プラクティス](http://msdn.microsoft.com/en-us/d49bc4d5-efb7-4caa-a2fe-e4d3cec63c05)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-215">For more information on security policy, see [NIB: Security Policy Management](http://msdn.microsoft.com/en-us/d754e05d-29dc-4d3a-a2c2-95eaaf1b82b9) and [NIB: Security Policy Best Practices](http://msdn.microsoft.com/en-us/d49bc4d5-efb7-4caa-a2fe-e4d3cec63c05).</span></span>  
  
### <a name="example"></a><span data-ttu-id="2b9c3-216">例</span><span class="sxs-lookup"><span data-stu-id="2b9c3-216">Example</span></span>  
 <span data-ttu-id="2b9c3-217">次のサンプルは、特定の接続文字列を必要とするコードの作成方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-217">The following example demonstrates how to write code that requires a particular connection string.</span></span> <span data-ttu-id="2b9c3-218">このサンプルは、<xref:System.Data.SqlClient> に対する無制限の権限を拒否する機能をシミュレートします。この機能は、実際には、システム管理者が、CAS ポリシーを使用して実装します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-218">It simulates denying unrestricted permissions to <xref:System.Data.SqlClient>, which a system administrator would implement using a CAS policy in the real world.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="2b9c3-219">ADO.NET の CAS 権限を定義する場合、最も制限の厳しいケース (権限なし) から開始し、その後で、コードが実行する特定のタスクに必要な特定の権限を追加するというのが、適切なパターンです。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-219">When designing CAS permissions for ADO.NET, the correct pattern is to start with the most restrictive case (no permissions at all) and then add the specific permissions that are needed for the particular task that the code needs to perform.</span></span> <span data-ttu-id="2b9c3-220">逆に、すべての権限を与えてから特定の権限を拒否してゆく方法は、安全ではありません。同じ接続文字列を表現する方法が多数あるためです。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-220">The opposite pattern, starting with all permissions and then denying a specific permission, is not secure because there are many ways of expressing the same connection string.</span></span> <span data-ttu-id="2b9c3-221">たとえば、すべての権限を与えた後で接続文字列 "server=someserver" の使用を拒否しても、"server=someserver.mycompany.com" という接続文字列は使用可能です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-221">For example, if you start with all permissions and then attempt to deny the use of the connection string "server=someserver", the string "server=someserver.mycompany.com" would still be allowed.</span></span> <span data-ttu-id="2b9c3-222">常に権限をまったく与えない状態から開始することで、権限セットのセキュリティ ホールを減らすことができます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-222">By always starting by granting no permissions at all, you reduce the chances that there are holes in the permission set.</span></span>  
  
 <span data-ttu-id="2b9c3-223">`SqlClient` でセキュリティ確認要求を実行する方法を、次のコードに示します。CAS の権限が適切に設定されていない場合、<xref:System.Security.SecurityException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-223">The following code demonstrates how `SqlClient` performs the security demand, which throws a <xref:System.Security.SecurityException> if the appropriate CAS permissions are not in place.</span></span> <span data-ttu-id="2b9c3-224"><xref:System.Security.SecurityException> の出力は、コンソール ウィンドウに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-224">The <xref:System.Security.SecurityException> output is displayed in the console window.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.CAS#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.CAS/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.CAS#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.CAS/VB/source.vb#1)]  
  
 <span data-ttu-id="2b9c3-225">コンソール ウィンドウに表示される出力の例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-225">You should see this output in the Console window:</span></span>  
  
```  
Failed, as expected: <IPermission class="System.Data.SqlClient.  
SqlClientPermission, System.Data, Version=2.0.0.0,   
  Culture=neutral, PublicKeyToken=b77a5c561934e089" version="1"  
  AllowBlankPassword="False">  
<add ConnectionString="Data Source=(local);Initial Catalog=  
  Northwind;Integrated Security=SSPI" KeyRestrictions=""  
KeyRestrictionBehavior="AllowOnly"/>  
</IPermission>  
  
Connection opened, as expected.  
Failed, as expected: Request failed.  
```  
  
## <a name="interoperability-with-unmanaged-code"></a><span data-ttu-id="2b9c3-226">アンマネージ コードとの相互運用性</span><span class="sxs-lookup"><span data-stu-id="2b9c3-226">Interoperability with Unmanaged Code</span></span>  
 <span data-ttu-id="2b9c3-227">CLR の外部で実行されるコードはアンマネージ コードと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-227">Code that runs outside the CLR is called unmanaged code.</span></span> <span data-ttu-id="2b9c3-228">したがって、CAS などのセキュリティ メカニズムをアンマネージ コードに適用することはできません。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-228">Therefore, security mechanisms such as CAS cannot be applied to unmanaged code.</span></span> <span data-ttu-id="2b9c3-229">アンマネージ コードの例としては、COM コンポーネント、ActiveX インターフェイス、Win32 API 関数があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-229">COM components, ActiveX interfaces, and Win32 API functions are examples of unmanaged code.</span></span> <span data-ttu-id="2b9c3-230">アンマネージ コードを実行する場合は、アプリケーションの全体的なセキュリティが損なわれないよう特別な考慮をする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-230">Special security considerations apply when executing unmanaged code so that you do not jeopardize overall application security.</span></span> <span data-ttu-id="2b9c3-231">詳細については、「[アンマネージ コードとの相互運用](../../../../docs/framework/interop/index.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-231">For more information, see [Interoperating with Unmanaged Code](../../../../docs/framework/interop/index.md).</span></span>  
  
 <span data-ttu-id="2b9c3-232">.NET Framework は、COM 相互運用機能を介したアクセスを提供することによって、既存の COM コンポーネントとの下位互換性をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-232">The .NET Framework also supports backward compatibility to existing COM components by providing access through COM interop.</span></span> <span data-ttu-id="2b9c3-233">COM 相互運用ツールを使って適切な COM 型をインポートすることにより、.NET Framework アプリケーションに COM コンポーネントを組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-233">You can incorporate COM components into a .NET Framework application by using COM interop tools to import the relevant COM types.</span></span> <span data-ttu-id="2b9c3-234">インポートが完了すると、COM 型を使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-234">Once imported, the COM types are ready to use.</span></span> <span data-ttu-id="2b9c3-235">アセンブリのメタデータをタイプ ライブラリにエクスポートし、マネージ コンポーネントを COM コンポーネントとして登録することで、COM クライアントからマネージ コードにアクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-235">COM interop also enables COM clients to access managed code by exporting assembly metadata to a type library and registering the managed component as a COM component.</span></span> <span data-ttu-id="2b9c3-236">詳細については、次を参照してください。[高度な COM 相互運用性](http://msdn.microsoft.com/en-us/3ada36e5-2390-4d70-b490-6ad8de92f2fb)です。</span><span class="sxs-lookup"><span data-stu-id="2b9c3-236">For more information, see [Advanced COM Interoperability](http://msdn.microsoft.com/en-us/3ada36e5-2390-4d70-b490-6ad8de92f2fb).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2b9c3-237">参照</span><span class="sxs-lookup"><span data-stu-id="2b9c3-237">See Also</span></span>  
 [<span data-ttu-id="2b9c3-238">ADO.NET アプリケーションのセキュリティ保護</span><span class="sxs-lookup"><span data-stu-id="2b9c3-238">Securing ADO.NET Applications</span></span>](../../../../docs/framework/data/adonet/securing-ado-net-applications.md)  
 [<span data-ttu-id="2b9c3-239">ネイティブ コードと .NET Framework コードのセキュリティ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-239">PAVE Security in Native and .NET Framework Code</span></span>](http://msdn.microsoft.com/en-us/bd61be84-c143-409a-a75a-44253724f784)  
 [<span data-ttu-id="2b9c3-240">コード アクセス セキュリティ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-240">Code Access Security</span></span>](http://msdn.microsoft.com/en-us/23a20143-241d-4fe5-9d9f-3933fd594c03)  
 [<span data-ttu-id="2b9c3-241">ロール ベースのセキュリティ</span><span class="sxs-lookup"><span data-stu-id="2b9c3-241">Role-Based Security</span></span>](http://msdn.microsoft.com/en-us/239442e3-5be4-4203-b7fd-793baffea803)  
 [<span data-ttu-id="2b9c3-242">ADO.NET のマネージ プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="2b9c3-242">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
