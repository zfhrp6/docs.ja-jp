---
title: "ADO.NET での side-by-side 実行"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
caps.latest.revision: "6"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: bdb12ce6f697bbc42052e35c252c9cad6a5e962e
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/17/2018
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="a6550-102">ADO.NET での side-by-side 実行</span><span class="sxs-lookup"><span data-stu-id="a6550-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="a6550-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の side-by-side 実行は、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の複数のバージョンがインストールされている 1 台のコンピューター上で、アプリケーションのコンパイル時のバージョンのみを使用して、アプリケーションを実行する機能です。</span><span class="sxs-lookup"><span data-stu-id="a6550-103">Side-by-side execution in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] is the ability to execute an application on a computer that has multiple versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="a6550-104">サイド バイ サイド実行を構成する方法の詳細については、次を参照してください。[サイド バイ サイド実行](../../../../docs/framework/deployment/side-by-side-execution.md)です。</span><span class="sxs-lookup"><span data-stu-id="a6550-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="a6550-105">あるバージョンの [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] を使用してコンパイルされたアプリケーションを、別のバージョンの [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] で実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="a6550-105">An application compiled by using one version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] can run on a different version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="a6550-106">ただし、インストールされている [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] のバージョンごとにアプリケーションをコンパイルして、各バージョンを別々に実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a6550-106">However, we recommend that you compile a version of the application for each installed version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], and run them separately.</span></span> <span data-ttu-id="a6550-107">いずれの場合でも、[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] の各リリース間の変更によって生じるアプリケーションの上位互換性または下位互換性の問題に注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6550-107">In either scenario, you should be aware of changes in [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="a6550-108">上位互換性と下位互換性</span><span class="sxs-lookup"><span data-stu-id="a6550-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="a6550-109">上位互換性とは、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の旧バージョンでコンパイルしたアプリケーションが、新しいバージョンの [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] でも実行できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="a6550-109">Forward compatibility means that an application can be compiled with an earlier version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but will still run successfully on a later version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)]<span data-ttu-id="a6550-110"> version 1.1 用に書かれた [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] コードは、後のバージョンとの上位互換性があります。</span><span class="sxs-lookup"><span data-stu-id="a6550-110"> code written for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="a6550-111">下位互換性とは、アプリケーションが [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の新しいバージョン用にコンパイルされ、機能を低下させずに、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の以前のバージョンで引き続き実行できることを意味します。</span><span class="sxs-lookup"><span data-stu-id="a6550-111">Backward compatibility means that an application is compiled for a newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but continues to run on earlier versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] without any loss of functionality.</span></span> <span data-ttu-id="a6550-112">当然のことながら、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の新しいバージョンで導入された機能については、これは該当しません。</span><span class="sxs-lookup"><span data-stu-id="a6550-112">Of course, this will not be the case for features introduced in a new version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="a6550-113">.NET Framework Data Provider for ODBC</span><span class="sxs-lookup"><span data-stu-id="a6550-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="a6550-114">Version 1.1 以降、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC (<xref:System.Data.Odbc>) は、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の一部として同梱されています。</span><span class="sxs-lookup"><span data-stu-id="a6550-114">Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="a6550-115">ODBC データ プロバイダーが使用できる[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]バージョン 1.0 の開発者、Web ダウンロードとしてから、[データ アクセスおよびストレージ デベロッパー センター](http://go.microsoft.com/fwlink/?linkid=4173)です。</span><span class="sxs-lookup"><span data-stu-id="a6550-115">The ODBC data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](http://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="a6550-116">名前空間をダウンロードした[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]Data Provider for ODBC は**Microsoft.Data.Odbc**です。</span><span class="sxs-lookup"><span data-stu-id="a6550-116">The namespace for the downloaded [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="a6550-117">用に開発されたアプリケーションがある場合、 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0、ODBC データ プロバイダーを使用して、データ ソースへの接続でそのアプリケーションを実行する、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]バージョン 1.1 または以降のバージョンが、ODBC の名前空間を更新する必要がありますデータ プロバイダーに**System.Data.Odbc**です。</span><span class="sxs-lookup"><span data-stu-id="a6550-117">If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="a6550-118">その後で、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の新しいバージョン用に再コンパイルする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6550-118">You then must recompile it for the newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span>  
  
 <span data-ttu-id="a6550-119">ODBC データ プロバイダーを使用してデータ ソースに接続する [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 2.0 以降用に開発したアプリケーションがあり、そのアプリケーションを [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 で実行する場合は、ODBC データ プロバイダーをダウンロードし、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 システムにインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6550-119">If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the ODBC data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system.</span></span> <span data-ttu-id="a6550-120">必要があります変更する名前空間には、ODBC データ プロバイダー **Microsoft.Data.Odbc**のアプリケーションをコンパイルし、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]バージョン 1.0。</span><span class="sxs-lookup"><span data-stu-id="a6550-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="a6550-121">.NET Framework Data Provider for Oracle</span><span class="sxs-lookup"><span data-stu-id="a6550-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="a6550-122">Version 1.1 以降、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for Oracle (<xref:System.Data.OracleClient>) は、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の一部として同梱されています。</span><span class="sxs-lookup"><span data-stu-id="a6550-122">Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="a6550-123">データ プロバイダーが使用できる[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]バージョン 1.0 の開発者、Web ダウンロードとしてから、[データ アクセスおよびストレージ デベロッパー センター](http://go.microsoft.com/fwlink/?linkid=4173)です。</span><span class="sxs-lookup"><span data-stu-id="a6550-123">The data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](http://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="a6550-124">このデータ プロバイダーを使用してデータ ソースに接続する、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 2.0 以降用に開発したアプリケーションがあり、そのアプリケーションを [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 で実行する場合は、該当するデータ プロバイダーをダウンロードし、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 システムにインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6550-124">If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="a6550-125">コード アクセス セキュリティ</span><span class="sxs-lookup"><span data-stu-id="a6550-125">Code Access Security</span></span>  
 <span data-ttu-id="a6550-126">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 の [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] データ プロバイダー (<xref:System.Data.SqlClient>、<xref:System.Data.OleDb>) を実行するには、FullTrust 権限が必要です。</span><span class="sxs-lookup"><span data-stu-id="a6550-126">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="a6550-127">権限レベルが FullTrust より低いゾーンで [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 の [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] データ プロバイダーを使用しようとすると、<xref:System.Security.SecurityException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="a6550-127">Any attempt to use the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] k data providers from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="a6550-128">ただし、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 2.0 以降では、部分的に信頼されたゾーンで [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] データ プロバイダーのすべてを使用できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="a6550-128">However, starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0, all of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="a6550-129">さらに、[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.1 の [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] データ プロバイダーに新しいセキュリティ機能が追加されました。</span><span class="sxs-lookup"><span data-stu-id="a6550-129">In addition, a new security feature was added to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1.</span></span> <span data-ttu-id="a6550-130">この機能により、特定のセキュリティ ゾーンで使用できる接続文字列を制限することができます。</span><span class="sxs-lookup"><span data-stu-id="a6550-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="a6550-131">特定のセキュリティ ゾーンに対して空白のパスワードの使用を禁止することもできます。</span><span class="sxs-lookup"><span data-stu-id="a6550-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="a6550-132">詳細については、「 [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="a6550-132">For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 <span data-ttu-id="a6550-133">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] のインストールごとに個別の Security.config ファイルがあるため、セキュリティ設定については、互換性の問題はありません。</span><span class="sxs-lookup"><span data-stu-id="a6550-133">Because each installation of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="a6550-134">ただし、アプリケーションが、[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] Version 1.1 以降に同梱されている [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の追加のセキュリティ機能に依存している場合は、アプリケーションを Version 1.0 システムに配布することはできません。</span><span class="sxs-lookup"><span data-stu-id="a6550-134">However, if your application depends on the additional security capabilities of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] included in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="a6550-135">SqlCommand の実行</span><span class="sxs-lookup"><span data-stu-id="a6550-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="a6550-136">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.1 以降では、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> がデータ ソースでコマンドを実行する方法が変更されました。</span><span class="sxs-lookup"><span data-stu-id="a6550-136">Starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="a6550-137">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>のコンテキストですべてのコマンドを実行、 **sp_executesql**ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="a6550-137">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="a6550-138">その結果、接続の状態に影響を与えるコマンド (たとえば、SET NOCOUNT ON) は、現在のコマンドの実行だけに適用されます。</span><span class="sxs-lookup"><span data-stu-id="a6550-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="a6550-139">接続が開かれている間に実行される後続のコマンドについては、接続の状態は変更されません。</span><span class="sxs-lookup"><span data-stu-id="a6550-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="a6550-140">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.1 以降<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>のみのコンテキストでコマンドを実行、 **sp_executesql**ストアド プロシージャのコマンドは、パラメーターを格納して、パフォーマンス上の利点を提供する場合。</span><span class="sxs-lookup"><span data-stu-id="a6550-140">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="a6550-141">その結果、接続の状態に影響を与えるコマンドが、非パラメーター化コマンドに含まれている場合、接続が開いている間に実行される後続のすべてのコマンドに対して、接続の状態を変更します。</span><span class="sxs-lookup"><span data-stu-id="a6550-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="a6550-142">たとえば、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> への呼び出しで次のバッチ コマンドが実行されるとします。</span><span class="sxs-lookup"><span data-stu-id="a6550-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```  
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="a6550-143">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.1 以降では、NOCOUNT は、接続が開いている間に実行される後続のコマンドに対して ON のままです。</span><span class="sxs-lookup"><span data-stu-id="a6550-143">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="a6550-144">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Version 1.0 では、NOCOUNT は、現在のコマンドの実行に対してだけ ON です。</span><span class="sxs-lookup"><span data-stu-id="a6550-144">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="a6550-145">アプリケーションが、どちらかのバージョンの <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> の [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の動作に依存している場合は、この変更が上位互換性と下位互換性の両方に影響することがあります。</span><span class="sxs-lookup"><span data-stu-id="a6550-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span>  
  
 <span data-ttu-id="a6550-146">アプリケーションを [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] の以前のバージョンと新しいバージョンの両方で動作させる場合は、どのバージョンで実行された場合にも動作が同じになるように、コードを記述できます。</span><span class="sxs-lookup"><span data-stu-id="a6550-146">For applications that run on both earlier and later versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="a6550-147">変更された接続状態が後続のすべてのコマンドでも有効になるようにする場合は、<xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> を使用してコマンドを実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a6550-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="a6550-148">変更された接続状態が後続のコマンドでは無効になるようにする場合は、接続状態をリセットするコマンドを含めるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="a6550-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="a6550-149">例:</span><span class="sxs-lookup"><span data-stu-id="a6550-149">For example:</span></span>  
  
```  
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="a6550-150">参照</span><span class="sxs-lookup"><span data-stu-id="a6550-150">See Also</span></span>  
 [<span data-ttu-id="a6550-151">ADO.NET の概要</span><span class="sxs-lookup"><span data-stu-id="a6550-151">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)  
 [<span data-ttu-id="a6550-152">ADO.NET でのデータの取得および変更</span><span class="sxs-lookup"><span data-stu-id="a6550-152">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)  
 [<span data-ttu-id="a6550-153">ADO.NET のマネージ プロバイダーと DataSet デベロッパー センター</span><span class="sxs-lookup"><span data-stu-id="a6550-153">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
