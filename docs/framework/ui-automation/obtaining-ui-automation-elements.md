---
title: "UI オートメーション要素の取得"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-bcl
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- UI Automation, obtaining elements
- elements, UI Automation, obtaining
ms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171
caps.latest.revision: "23"
author: Xansky
ms.author: mhopkins
manager: markl
ms.openlocfilehash: f657d4289e46f84246059010a2f9550d1c831d3c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/21/2017
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="4b037-102">UI オートメーション要素の取得</span><span class="sxs-lookup"><span data-stu-id="4b037-102">Obtaining UI Automation Elements</span></span>
> [!NOTE]
>  <span data-ttu-id="4b037-103">このドキュメントは、[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 名前空間で定義されているマネージ <xref:System.Windows.Automation> クラスを使用する .NET Framework 開発者を対象としています。</span><span class="sxs-lookup"><span data-stu-id="4b037-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="4b037-104">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]の最新情報については、「 [Windows Automation API: UI オートメーション](http://go.microsoft.com/fwlink/?LinkID=156746)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b037-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="4b037-105">このトピックでは、 <xref:System.Windows.Automation.AutomationElement> 要素の [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] オブジェクトを取得するさまざまな方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="4b037-105">This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="4b037-106">クライアント アプリケーションが独自のユーザー インターフェイスで要素の検索を試行する可能性がある場合は、すべての [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] の呼び出しを個別のスレッドで実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4b037-106">If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread.</span></span> <span data-ttu-id="4b037-107">詳細については、「 [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b037-107">For more information, see [UI Automation Threading Issues](../../../docs/framework/ui-automation/ui-automation-threading-issues.md).</span></span>  
  
<a name="The_Root_Element"></a>   
## <a name="root-element"></a><span data-ttu-id="4b037-108">ルート要素</span><span class="sxs-lookup"><span data-stu-id="4b037-108">Root Element</span></span>  
 <span data-ttu-id="4b037-109"><xref:System.Windows.Automation.AutomationElement> オブジェクトの検索には必ず、開始場所が必要です。</span><span class="sxs-lookup"><span data-stu-id="4b037-109">All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place.</span></span> <span data-ttu-id="4b037-110">この開始場所には、デスクトップ、アプリケーション ウィンドウ、コントロールなど任意の要素を指定できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-110">This can be any element, including the desktop, an application window, or a control.</span></span>  
  
 <span data-ttu-id="4b037-111">元のすべての要素が子と、デスクトップのルート要素が、静的なから取得した<xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType>プロパティです。</span><span class="sxs-lookup"><span data-stu-id="4b037-111">The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> property.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="4b037-112">通常、 <xref:System.Windows.Automation.AutomationElement.RootElement%2A>の直接の子のみの取得を試行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4b037-112">In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span> <span data-ttu-id="4b037-113">子孫の検索は、数百または数千もの要素を反復処理する場合があり、スタック オーバーフローを引き起こす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4b037-113">A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.</span></span> <span data-ttu-id="4b037-114">下位レベルの特定の要素を取得しようとする場合、アプリケーション ウィンドウから、または下位レベルのコンテナーから検索を開始する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4b037-114">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>  
  
<a name="Using_Conditions"></a>   
## <a name="conditions"></a><span data-ttu-id="4b037-115">条件</span><span class="sxs-lookup"><span data-stu-id="4b037-115">Conditions</span></span>  
 <span data-ttu-id="4b037-116">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 要素を取得するために使用できるほとんどの手法では、 <xref:System.Windows.Automation.Condition>を指定する必要があります。これは、取得する要素を定義する一連の条件になります。</span><span class="sxs-lookup"><span data-stu-id="4b037-116">For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.</span></span>  
  
 <span data-ttu-id="4b037-117">最も簡単な条件は <xref:System.Windows.Automation.Condition.TrueCondition>で、検索範囲内のすべての要素を指定する定義済みオブジェクトが返されます。</span><span class="sxs-lookup"><span data-stu-id="4b037-117">The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned.</span></span> <span data-ttu-id="4b037-118">要素が検出されなくなるため、<xref:System.Windows.Automation.Condition.FalseCondition>( <xref:System.Windows.Automation.Condition.TrueCondition>の逆) はあまり有用ではありません。</span><span class="sxs-lookup"><span data-stu-id="4b037-118"><xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.</span></span>  
  
 <span data-ttu-id="4b037-119">その他の 3 つの定義済み条件 ( <xref:System.Windows.Automation.Automation.ContentViewCondition>、 <xref:System.Windows.Automation.Automation.ControlViewCondition>、および <xref:System.Windows.Automation.Automation.RawViewCondition>) は、単独で使用することも、その他の条件と組み合わせて使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="4b037-119">Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>.</span></span> <span data-ttu-id="4b037-120"><xref:System.Windows.Automation.Automation.RawViewCondition>を単独で使用した場合、 <xref:System.Windows.Automation.Condition.TrueCondition>または <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> プロパティで要素をフィルター処理しないため <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> と同等になります。</span><span class="sxs-lookup"><span data-stu-id="4b037-120"><xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.</span></span>  
  
 <span data-ttu-id="4b037-121">その他の条件は 1 つ以上の <xref:System.Windows.Automation.PropertyCondition> オブジェクトで構築され、それぞれはプロパティ値を指定します。</span><span class="sxs-lookup"><span data-stu-id="4b037-121">Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value.</span></span> <span data-ttu-id="4b037-122">たとえば、 <xref:System.Windows.Automation.PropertyCondition> は要素が有効であることを指定したり、特定のコントロール パターンをサポートすることを指定したりします。</span><span class="sxs-lookup"><span data-stu-id="4b037-122">For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.</span></span>  
  
 <span data-ttu-id="4b037-123"><xref:System.Windows.Automation.AndCondition>、 <xref:System.Windows.Automation.OrCondition>、および <xref:System.Windows.Automation.NotCondition>の型のオブジェクトを構築することによって、ブール ロジックを使用して条件を組み合わせることができます。</span><span class="sxs-lookup"><span data-stu-id="4b037-123">Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.</span></span>  
  
<a name="Search_Scope"></a>   
## <a name="search-scope"></a><span data-ttu-id="4b037-124">検索範囲</span><span class="sxs-lookup"><span data-stu-id="4b037-124">Search Scope</span></span>  
 <span data-ttu-id="4b037-125"><xref:System.Windows.Automation.AutomationElement.FindFirst%2A> または <xref:System.Windows.Automation.AutomationElement.FindAll%2A> 使用した検索には、範囲と開始場所が必要です。</span><span class="sxs-lookup"><span data-stu-id="4b037-125">Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.</span></span>  
  
 <span data-ttu-id="4b037-126">範囲は、検索対象の開始場所の周囲の領域を定義します。</span><span class="sxs-lookup"><span data-stu-id="4b037-126">The scope defines the space around the starting-place that is to be searched.</span></span> <span data-ttu-id="4b037-127">これには、要素自体、その兄弟、その親、その先祖、その直接の子、およびその子孫を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="4b037-127">This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.</span></span>  
  
 <span data-ttu-id="4b037-128"><xref:System.Windows.Automation.TreeScope> 列挙の値のビットごとの組み合わせによって、検索の範囲が定義されます。</span><span class="sxs-lookup"><span data-stu-id="4b037-128">The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.</span></span>  
  
<a name="Finding_a_Known_Element"></a>   
## <a name="finding-a-known-element"></a><span data-ttu-id="4b037-129">既知の要素の検索</span><span class="sxs-lookup"><span data-stu-id="4b037-129">Finding a Known Element</span></span>  
 <span data-ttu-id="4b037-130">既知の要素 (その <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>、 <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>、または他のプロパティまたはプロパティの組み合わせによって識別される) を検索する方法として、 <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> メソッドを使用する方法が最も簡単です。</span><span class="sxs-lookup"><span data-stu-id="4b037-130">To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method.</span></span> <span data-ttu-id="4b037-131">検索する要素がアプリケーション ウィンドウである場合は、検索の開始点を <xref:System.Windows.Automation.AutomationElement.RootElement%2A>にすることができます。</span><span class="sxs-lookup"><span data-stu-id="4b037-131">If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span>  
  
 <span data-ttu-id="4b037-132">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 要素を検索するこの方法は、自動化されたシナリオ テストの最も有用な方法になります。</span><span class="sxs-lookup"><span data-stu-id="4b037-132">This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.</span></span>  
  
<a name="Finding_Elements_in_a_Subtree"></a>   
## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="4b037-133">サブツリー内の要素の検索</span><span class="sxs-lookup"><span data-stu-id="4b037-133">Finding Elements in a Subtree</span></span>  
 <span data-ttu-id="4b037-134">既知の要素に関連する特定の条件を満たすすべての要素を検索するには、 <xref:System.Windows.Automation.AutomationElement.FindAll%2A>を使用します。</span><span class="sxs-lookup"><span data-stu-id="4b037-134">To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span></span> <span data-ttu-id="4b037-135">たとえば、このメソッドを使用して、リストまたはメニューからリスト項目またはメニュー項目を取得したり、ダイアログ ボックスのすべてのコントロールを識別したりできます。</span><span class="sxs-lookup"><span data-stu-id="4b037-135">For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>  
  
<a name="Walking_a_Subtree"></a>   
## <a name="walking-a-subtree"></a><span data-ttu-id="4b037-136">サブツリーのウォーク</span><span class="sxs-lookup"><span data-stu-id="4b037-136">Walking a Subtree</span></span>  
 <span data-ttu-id="4b037-137">クライアントで使用されるアプリケーションについて予備知識がない場合、 <xref:System.Windows.Automation.TreeWalker> クラスを使用して、対象となるすべての要素のサブツリーを構築することができます。</span><span class="sxs-lookup"><span data-stu-id="4b037-137">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class.</span></span> <span data-ttu-id="4b037-138">アプリケーションは、フォーカス変更イベントへの応答でこれを実行することができます。つまり、アプリケーションやコントロールが入力フォーカスを受け取るときに、UI オートメーション クライアントはフォーカスされている要素の子およびすべての子孫を調べます。</span><span class="sxs-lookup"><span data-stu-id="4b037-138">Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>  
  
 <span data-ttu-id="4b037-139"><xref:System.Windows.Automation.TreeWalker> で使用できる別の方法は、要素の先祖を特定する方法です。</span><span class="sxs-lookup"><span data-stu-id="4b037-139">Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element.</span></span> <span data-ttu-id="4b037-140">たとえば、ツリーをウォークすることによって、コントロールの親ウィンドウを特定できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-140">For example, by walking up the tree you can identify the parent window of a control.</span></span>  
  
 <span data-ttu-id="4b037-141">クラスのオブジェクトを作成する ( <xref:System.Windows.Automation.TreeWalker> を渡すことによって対象の要素を定義する) か、 <xref:System.Windows.Automation.Condition>のフィールドとして定義されている次の定義済みオブジェクトのいずれかを使用することによって、 <xref:System.Windows.Automation.TreeWalker>を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-141">You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.</span></span>  
  
|||  
|-|-|  
|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|<span data-ttu-id="4b037-142"><xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> プロパティが `true`である要素のみを検索します。</span><span class="sxs-lookup"><span data-stu-id="4b037-142">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|<span data-ttu-id="4b037-143"><xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> プロパティが `true`である要素のみを検索します。</span><span class="sxs-lookup"><span data-stu-id="4b037-143">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|<span data-ttu-id="4b037-144">すべての要素を検索します。</span><span class="sxs-lookup"><span data-stu-id="4b037-144">Finds all elements.</span></span>|  
  
 <span data-ttu-id="4b037-145"><xref:System.Windows.Automation.TreeWalker>を取得した後、それを使用することは簡単です。</span><span class="sxs-lookup"><span data-stu-id="4b037-145">After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward.</span></span> <span data-ttu-id="4b037-146">`Get` メソッドを呼び出し、サブツリーの要素間を移動するだけです。</span><span class="sxs-lookup"><span data-stu-id="4b037-146">Simply call the `Get` methods to navigate among elements of the subtree.</span></span>  
  
 <span data-ttu-id="4b037-147"><xref:System.Windows.Automation.TreeWalker.Normalize%2A> メソッドを使用すると、ビューの一部ではない要素からサブツリー内の他の要素に移動できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-147">The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="4b037-148">たとえば、 <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>を使用してサブツリーのビューを作成したとします。</span><span class="sxs-lookup"><span data-stu-id="4b037-148">For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span></span> <span data-ttu-id="4b037-149">スクロール バーが入力フォーカスを受信したことを示す通知を、アプリケーションが受け取ります。</span><span class="sxs-lookup"><span data-stu-id="4b037-149">Your application then receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="4b037-150">スクロール バーはコンテンツ要素ではないため、サブツリーのビューには存在しません。</span><span class="sxs-lookup"><span data-stu-id="4b037-150">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="4b037-151">しかし、スクロール バーを表す <xref:System.Windows.Automation.AutomationElement> を <xref:System.Windows.Automation.TreeWalker.Normalize%2A> に渡し、コンテンツ ビュー内にある最も近い先祖を取得することができます。</span><span class="sxs-lookup"><span data-stu-id="4b037-151">However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.</span></span>  
  
<a name="Other_Ways_to_Retrieve_an_Element"></a>   
## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="4b037-152">要素を取得する別の方法</span><span class="sxs-lookup"><span data-stu-id="4b037-152">Other Ways to Retrieve an Element</span></span>  
 <span data-ttu-id="4b037-153">検索とナビゲーションに加えて、次の方法で <xref:System.Windows.Automation.AutomationElement> を取得できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-153">In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.</span></span>  
  
### <a name="from-an-event"></a><span data-ttu-id="4b037-154">イベントから</span><span class="sxs-lookup"><span data-stu-id="4b037-154">From an Event</span></span>  
 <span data-ttu-id="4b037-155">アプリケーションが [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] イベントを受信するときに、イベント ハンドラーに渡されるソース オブジェクトは <xref:System.Windows.Automation.AutomationElement>です。</span><span class="sxs-lookup"><span data-stu-id="4b037-155">When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="4b037-156">たとえば、フォーカス変更イベントをサブスクライブしている場合、 <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> に渡されるソースはフォーカスを受け取った要素になります。</span><span class="sxs-lookup"><span data-stu-id="4b037-156">For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.</span></span>  
  
 <span data-ttu-id="4b037-157">詳細については、「 [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4b037-157">For more information, see [Subscribe to UI Automation Events](../../../docs/framework/ui-automation/subscribe-to-ui-automation-events.md).</span></span>  
  
### <a name="from-a-point"></a><span data-ttu-id="4b037-158">ポイントから</span><span class="sxs-lookup"><span data-stu-id="4b037-158">From a Point</span></span>  
 <span data-ttu-id="4b037-159">画面座標 (たとえば、カーソル位置) がある場合、静的 <xref:System.Windows.Automation.AutomationElement> メソッドを使用して <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> を取得できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-159">If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.</span></span>  
  
### <a name="from-a-window-handle"></a><span data-ttu-id="4b037-160">ウィンドウ ハンドルから</span><span class="sxs-lookup"><span data-stu-id="4b037-160">From a Window Handle</span></span>  
 <span data-ttu-id="4b037-161">HWND から <xref:System.Windows.Automation.AutomationElement> を取得するには、静的 <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="4b037-161">To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.</span></span>  
  
### <a name="from-the-focused-control"></a><span data-ttu-id="4b037-162">フォーカスされたコントロールから</span><span class="sxs-lookup"><span data-stu-id="4b037-162">From the Focused Control</span></span>  
 <span data-ttu-id="4b037-163">静的 <xref:System.Windows.Automation.AutomationElement> プロパティから、フォーカスされたコントロールを表す <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> を取得できます。</span><span class="sxs-lookup"><span data-stu-id="4b037-163">You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4b037-164">関連項目</span><span class="sxs-lookup"><span data-stu-id="4b037-164">See Also</span></span>  
 [<span data-ttu-id="4b037-165">プロパティ条件に基づく UI オートメーション要素を検索します。</span><span class="sxs-lookup"><span data-stu-id="4b037-165">Find a UI Automation Element Based on a Property Condition</span></span>](../../../docs/framework/ui-automation/find-a-ui-automation-element-based-on-a-property-condition.md)  
 [<span data-ttu-id="4b037-166">Treewalker を使用した UI オートメーション要素間の移動します。</span><span class="sxs-lookup"><span data-stu-id="4b037-166">Navigate Among UI Automation Elements with TreeWalker</span></span>](../../../docs/framework/ui-automation/navigate-among-ui-automation-elements-with-treewalker.md)  
 [<span data-ttu-id="4b037-167">UI オートメーション ツリーの概要</span><span class="sxs-lookup"><span data-stu-id="4b037-167">UI Automation Tree Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)
