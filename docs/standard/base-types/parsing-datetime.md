---
title: "方法: 文字列を DateTime に変換する"
description: "日付と時刻を表す文字列を解析して、その文字列から DateTime を作成する手法について説明します。"
ms.date: 02/15/2018
ms.prod: .net
ms.technology: dotnet-standard
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- parsing strings, date and time strings
- date and time strings
- ParseExact method
- enumerations [.NET Framework], parsing strings
- base types, parsing strings
- DateTime object
- time strings
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: a17c96a03a35fcc4eb12e188dbc79d8d48153fb7
ms.sourcegitcommit: 973a12d1e6962cd9a9c263fbfaad040ec8267fe9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/22/2018
---
# <a name="parsing-date-and-time-strings-in-net"></a><span data-ttu-id="c8aa3-103">.NET での日付と時刻文字列の解析</span><span class="sxs-lookup"><span data-stu-id="c8aa3-103">Parsing Date and Time Strings in .NET</span></span>

<span data-ttu-id="c8aa3-104">文字列を解析して <xref:System.DateTime> オブジェクトに変換するには、日付と時刻がテキストとしてどのように表現されるのかを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-104">Parsing strings to convert them to <xref:System.DateTime> objects requires you to specify information about how the dates and times are represented as text.</span></span> <span data-ttu-id="c8aa3-105">異なるカルチャでは、日、月、年の並び順が異なります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-105">Different cultures use different orders for day, month, and year.</span></span> <span data-ttu-id="c8aa3-106">24 時間制を使用する時間表記があり、また "AM" および "PM" を指定する時間表記もあります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-106">Some time representations use a 24-hour clock, others specify "AM" and "PM."</span></span> <span data-ttu-id="c8aa3-107">一部のアプリケーションは日付のみを必要とします。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-107">Some applications need only the date.</span></span> <span data-ttu-id="c8aa3-108">時刻のみを必要とするアプリケーションもあります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-108">Others need only the time.</span></span> <span data-ttu-id="c8aa3-109">日付と時刻の両方を指定する必要があるアプリケーションもあります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-109">Still others need to specify both the date and the time.</span></span> <span data-ttu-id="c8aa3-110">文字列を <xref:System.DateTime> オブジェクトに変換するメソッドを使用すると、想定する書式、およびアプリケーションに必要な日付と時刻の要素について、詳しく指定できます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-110">The methods that convert strings to <xref:System.DateTime> objects enable you to provide detailed information about the formats you expect and the elements of a date and time your application needs.</span></span> <span data-ttu-id="c8aa3-111">テキストを正しく <xref:System.DateTime> に変換するには、3 つのサブタスクが必要です。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-111">There are three subtasks to correctly converting text into a <xref:System.DateTime>:</span></span>

1. <span data-ttu-id="c8aa3-112">日付と時刻を表すテキストについて、どのような書式を想定するのか指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-112">You must specify the expected format of the text representing a date and time.</span></span>
1. <span data-ttu-id="c8aa3-113">日時の書式に対してカルチャを指定する場合があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-113">You may specify the culture for the format of a date time.</span></span>
1. <span data-ttu-id="c8aa3-114">テキストの表現で不足している構成要素を、日付と時刻でどのように設定するのか指定する場合があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-114">You may specify how missing components in the text representation are set in the date and time.</span></span>

<span data-ttu-id="c8aa3-115"><xref:System.DateTime.Parse%2A> メソッドと <xref:System.DateTime.TryParse%2A> メソッドでは、多くの一般的な日付と時刻の表現を変換します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-115">The <xref:System.DateTime.Parse%2A> and <xref:System.DateTime.TryParse%2A> methods convert many common representations of a date and time.</span></span> <span data-ttu-id="c8aa3-116"><xref:System.DateTime.ParseExact%2A> メソッドと <xref:System.DateTime.TryParseExact%2A> メソッドでは、日付と時刻の書式指定文字列で指定されたパターンに適合する文字列形式を変換します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-116">The <xref:System.DateTime.ParseExact%2A> and <xref:System.DateTime.TryParseExact%2A> methods convert a string representation that conforms to the pattern specified by a date and time format string.</span></span> <span data-ttu-id="c8aa3-117">(詳細については、「[標準の日時書式指定文字列](standard-date-and-time-format-strings.md)」および「[カスタム日時書式指定文字列](custom-date-and-time-format-strings.md)」の記事をご覧ください。)</span><span class="sxs-lookup"><span data-stu-id="c8aa3-117">(See the articles on [standard date and time format strings](standard-date-and-time-format-strings.md) and [custom date and time format strings](custom-date-and-time-format-strings.md) for details.)</span></span>


<span data-ttu-id="c8aa3-118">現在の <xref:System.Globalization.DateTimeFormatInfo> オブジェクトでは、テキストを日付と時刻として解釈する方法について、より細かく制御できます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-118">The current <xref:System.Globalization.DateTimeFormatInfo> object provides more control over how text should be interpreted as a date and time.</span></span> <span data-ttu-id="c8aa3-119"><xref:System.Globalization.DateTimeFormatInfo> のプロパティでは、日付と時刻の区切り記号、月、日、時代 (年号) の名前、"AM" および "PM" を指定する書式について記述します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-119">Properties of a <xref:System.Globalization.DateTimeFormatInfo> describe the date and time separators, and the names of months, days, and eras, and the format for the "AM" and "PM" designations.</span></span> <span data-ttu-id="c8aa3-120">現在のスレッド カルチャでは、現在のカルチャを表す <xref:System.Globalization.DateTimeFormatInfo> が提供されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-120">The current thread culture provides a <xref:System.Globalization.DateTimeFormatInfo> that represents the current culture.</span></span> <span data-ttu-id="c8aa3-121">特定のカルチャまたはカスタム設定が必要な場合は、解析メソッドの <xref:System.IFormatProvider> パラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-121">If you want a specific culture or custom settings, you specify the <xref:System.IFormatProvider> parameter of a parsing method.</span></span> <span data-ttu-id="c8aa3-122"><xref:System.IFormatProvider> パラメーターには、カルチャを表す <xref:System.Globalization.CultureInfo> オブジェクト、または <xref:System.Globalization.DateTimeFormatInfo> オブジェクトを指定します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-122">For the <xref:System.IFormatProvider> parameter, specify a <xref:System.Globalization.CultureInfo> object, which represents a culture, or a <xref:System.Globalization.DateTimeFormatInfo> object.</span></span>

<span data-ttu-id="c8aa3-123">日付や時刻を表すテキストでは、一部の情報が不足している場合があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-123">The text representing a date or time may be missing some information.</span></span> <span data-ttu-id="c8aa3-124">たとえば、ほとんどの人は、「3 月 12 日」という日付が今年の日付を表していると仮定するでしょう。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-124">For example, most people would assume the date "March 12" represents the current year.</span></span> <span data-ttu-id="c8aa3-125">同様に、"2018年 3 月" は 2018 年の 3 月を表します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-125">Similarly, "March 2018" represents the month of March in the year 2018.</span></span> <span data-ttu-id="c8aa3-126">多くの場合、時刻を表すテキストでは、時間、分、AM/PM の指定のみが含まれます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-126">Text representing time often does only includes hours, minutes, and an AM/PM designation.</span></span>  <span data-ttu-id="c8aa3-127">解析メソッドでは、適切な既定値を使用して、この情報の不足が処理されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-127">Parsing methods handle this missing information by using reasonable defaults:</span></span>

- <span data-ttu-id="c8aa3-128">時刻のみが存在する場合、日付には現在の日付が使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-128">When only the time is present, the date portion uses the current date.</span></span>
- <span data-ttu-id="c8aa3-129">日付のみが存在する場合、時刻には午前 0 時が使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-129">When only the date is present, the time portion is midnight.</span></span>
- <span data-ttu-id="c8aa3-130">日付で年が指定されていない場合、現在の年が使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-130">When the year isn't specified in a date, the current year is used.</span></span>
- <span data-ttu-id="c8aa3-131">月の日付が指定されていない場合、月の最初の日付が使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-131">When the day of the month isn't specified, the first of the month is used.</span></span>

<span data-ttu-id="c8aa3-132">文字列内に日付が存在する場合、それには月、および日または年のいずれかが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-132">If the date is present in the string, it must include the month and one of the day or year.</span></span> <span data-ttu-id="c8aa3-133">時刻が存在する場合、それには時間、および分または AM/PM 指定子のいずれかが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-133">If the time is present, it must include the hour, and either the minutes or the AM/PM designator.</span></span>

<span data-ttu-id="c8aa3-134"><xref:System.Globalization.DateTimeStyles.NoCurrentDateDefault> 定数を指定して、各既定値を上書きできます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-134">You can specify the <xref:System.Globalization.DateTimeStyles.NoCurrentDateDefault> constant to override these defaults.</span></span> <span data-ttu-id="c8aa3-135">この定数を使用する場合、不足しているすべての年、月、または日のプロパティは値 `1` に設定されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-135">When you use that constant, any missing year, month, or day properties are set to the value `1`.</span></span> <span data-ttu-id="c8aa3-136"><xref:System.DateTime.Parse%2A> を使用する[最後の例](#styles-example)では、この動作について説明しています。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-136">The [last example](#styles-example) using <xref:System.DateTime.Parse%2A> demonstrates this behavior.</span></span>

<span data-ttu-id="c8aa3-137">日付と時刻のコンポーネントだけでなく、日付と時刻の文字列形式には、世界協定時刻 (UTC) と何時間異なるかを示すオフセットを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-137">In addition to a date and a time component, the string representation of a date and time can include an offset that indicates how much the time differs from Coordinated Universal Time (UTC).</span></span> <span data-ttu-id="c8aa3-138">たとえば、文字列 "2/14/2007 5:32:00 -7:00" は、UTC より 7 時間早い時刻を定義します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-138">For example, the string "2/14/2007 5:32:00 -7:00" defines a time that is seven hours earlier than UTC.</span></span> <span data-ttu-id="c8aa3-139">オフセットが時刻の文字列形式から省略される場合、解析では、その <xref:System.DateTime.Kind%2A> プロパティに <xref:System.DateTimeKind.Unspecified?displayProperty=nameWithType> を設定して、<xref:System.DateTime> オブジェクトを返します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-139">If an offset is omitted from the string representation of a time, parsing returns a <xref:System.DateTime> object with its <xref:System.DateTime.Kind%2A> property set to <xref:System.DateTimeKind.Unspecified?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c8aa3-140">オフセットが指定されている場合、解析では、その <xref:System.DateTime.Kind%2A> プロパティに <xref:System.DateTimeKind.Local?displayProperty=nameWithType> を設定した <xref:System.DateTime> オブジェクトと、使用しているマシンのローカル タイム ゾーンに調整された値を返します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-140">If an offset is specified, parsing returns a <xref:System.DateTime> object with its <xref:System.DateTime.Kind%2A> property set to <xref:System.DateTimeKind.Local?displayProperty=nameWithType> and its value adjusted to the local time zone of your machine.</span></span> <span data-ttu-id="c8aa3-141">解析メソッドで <xref:System.Globalization.DateTimeStyles> 値を使用することで、この動作を変更できます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-141">You can modify this behavior by using a <xref:System.Globalization.DateTimeStyles> value with the parsing method.</span></span>
  
<span data-ttu-id="c8aa3-142">書式プロバイダーは、あいまいな数値の日付を解釈するためにも使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-142">The format provider is also used to interpret an ambiguous numeric date.</span></span> <span data-ttu-id="c8aa3-143">文字列 "02/03/04" で表される日付は、どの構成要素が月、日、年なのかはっきりしません。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-143">It is not clear which components of the date represented by the string "02/03/04" are the month, day, and year.</span></span> <span data-ttu-id="c8aa3-144">構成要素は、書式プロバイダーにある類似した日付書式と同じ順序で解釈されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-144">The components are interpreted according to the order of similar date formats in the format provider.</span></span>

## <a name="parse"></a><span data-ttu-id="c8aa3-145">Parse</span><span class="sxs-lookup"><span data-stu-id="c8aa3-145">Parse</span></span>

<span data-ttu-id="c8aa3-146"><xref:System.DateTime.Parse%2A?displayProperty=nameWithType> メソッドを使用して `string` を <xref:System.DateTime> に変換する方法の例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-146">The following example illustrates the use of the <xref:System.DateTime.Parse%2A?displayProperty=nameWithType> method to convert a `string` into a <xref:System.DateTime>.</span></span> <span data-ttu-id="c8aa3-147">この例では、現在のスレッドに関連付けられているカルチャを使用します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-147">This example uses the culture associated with the current thread.</span></span> <span data-ttu-id="c8aa3-148">現在のカルチャに関連付けられている <xref:System.Globalization.CultureInfo> で入力文字列を解析できない場合、<xref:System.FormatException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-148">If the <xref:System.Globalization.CultureInfo> associated with the current culture cannot parse the input string, a <xref:System.FormatException> is thrown.</span></span>

> [!TIP]
> <span data-ttu-id="c8aa3-149">この記事にあるすべての C# サンプルは、ブラウザーで実行できます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-149">All the C# samples in this article run in your browser.</span></span> <span data-ttu-id="c8aa3-150">出力を確認するには、**[実行]** ボタンを押します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-150">Press the **Run** button to see the output.</span></span> <span data-ttu-id="c8aa3-151">また、サンプルを編集して自分で実験することもできます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-151">You can also edit them to experiment yourself.</span></span>

> [!NOTE]
> <span data-ttu-id="c8aa3-152">これらの例は、[C#](https://github.com/dotnet/docs/samples/tree/master/snippets/csharp/how-to/conversions) と [VB](https://github.com/dotnet/docs/samples/tree/master/snippets/visualbasic/how-to/conversions) 両方の GitHub ドキュメント リポジトリで使用可能です。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-152">These examples are available in the GitHub docs repo for both [C#](https://github.com/dotnet/docs/samples/tree/master/snippets/csharp/how-to/conversions) and [VB](https://github.com/dotnet/docs/samples/tree/master/snippets/visualbasic/how-to/conversions).</span></span> <span data-ttu-id="c8aa3-153">[C#]((https://github.com/dotnet/docs/samples/tree/master/snippets/csharp/how-to/conversions.zip) または [VB](https://github.com/dotnet/docs/samples/tree/master/snippets/visualbasic/how-to/conversions.zip) 用の zip ファイルとしてプロジェクトをダウンロードすることもできます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-153">Or you can download the project as a zipfile for [C#]((https://github.com/dotnet/docs/samples/tree/master/snippets/csharp/how-to/conversions.zip) or [VB](https://github.com/dotnet/docs/samples/tree/master/snippets/visualbasic/how-to/conversions.zip).</span></span>

[!code-csharp-interactive[Parsing.DateAndTime#1](../../../samples/snippets/csharp/how-to/conversions/StringToDateTime.cs#1)]
[!code-vb[Parsing.DateAndTime#1](../../../samples/snippets/visualbasic/how-to/conversions/Program.vb#1)]

<span data-ttu-id="c8aa3-154">文字列を解析するときに使用される書式規則を含むカルチャを、明示的に定義することもできます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-154">You can also explicitly define the culture whose formatting conventions are used when you parse a string.</span></span> <span data-ttu-id="c8aa3-155"><xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> プロパティによって返される標準 <xref:System.Globalization.DateTimeFormatInfo> オブジェクトのいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-155">You specify one of the standard <xref:System.Globalization.DateTimeFormatInfo> objects returned by the <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="c8aa3-156">次の例では、書式プロバイダーを使用して、ドイツ語の文字列を <xref:System.DateTime> に解析します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-156">The following example uses a format provider to parse a German string into a <xref:System.DateTime>.</span></span> <span data-ttu-id="c8aa3-157">これにより、`de-DE` カルチャを表す <xref:System.Globalization.CultureInfo> が作成されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-157">It creates a <xref:System.Globalization.CultureInfo> representing the `de-DE` culture.</span></span> <span data-ttu-id="c8aa3-158">この `CultureInfo` オブジェクトによって、この特定の文字列が正常に解析されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-158">That `CultureInfo` object ensures successful parsing of this particular string.</span></span> <span data-ttu-id="c8aa3-159">これによって、<xref:System.Threading.Thread.CurrentThread> の <xref:System.Threading.Thread.CurrentCulture> がどのように設定されていても除外されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-159">This precludes whatever setting is in the <xref:System.Threading.Thread.CurrentCulture> of the <xref:System.Threading.Thread.CurrentThread>.</span></span>  
  
[!code-csharp-interactive[Parsing.DateAndTime#2](../../../samples/snippets/csharp/how-to/conversions/StringToDateTime.cs#2)]
[!code-vb[Parsing.DateAndTime#2](../../../samples/snippets/visualbasic/how-to/conversions/Program.vb#2)]

<span data-ttu-id="c8aa3-160">ただし、<xref:System.DateTime.Parse%2A> メソッドのオーバーロードを使用してカスタム書式プロバイダーを指定することはできますが、このメソッドでは非標準の書式の解析はサポートされません。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-160">However, although you can use overloads of the <xref:System.DateTime.Parse%2A> method to specify custom format providers, the method does not support parsing non-standard formats.</span></span> <span data-ttu-id="c8aa3-161">非標準の書式設定で示された日付と時刻を解析するには、代わりに <xref:System.DateTime.ParseExact%2A> メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-161">To parse a date and time expressed in a non-standard format, use the <xref:System.DateTime.ParseExact%2A> method instead.</span></span>  

<a name="styles-example"></a><span data-ttu-id="c8aa3-162">次の例では、<xref:System.Globalization.DateTimeStyles> 列挙体を使用して、未指定のフィールドの <xref:System.DateTime> に現在の日付と時刻の情報を追加しないことを指定します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-162">The following example uses the <xref:System.Globalization.DateTimeStyles> enumeration to specify that the current date and time information should not be added to the <xref:System.DateTime> for unspecified fields.</span></span>  

[!code-csharp-interactive[Parsing.DateAndTime#3](../../../samples/snippets/csharp/how-to/conversions/StringToDateTime.cs#3)]
[!code-vb[Parsing.DateAndTime#3](../../../samples/snippets/visualbasic/how-to/conversions/Program.vb#3)]
 
## <a name="parseexact"></a><span data-ttu-id="c8aa3-163">ParseExact</span><span class="sxs-lookup"><span data-stu-id="c8aa3-163">ParseExact</span></span>

<span data-ttu-id="c8aa3-164"><xref:System.DateTime.ParseExact%2A?displayProperty=nameWithType> メソッドでは、文字列が指定された文字列パターンのいずれかに準拠する場合、文字列を <xref:System.DateTime> オブジェクトに変換します。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-164">The <xref:System.DateTime.ParseExact%2A?displayProperty=nameWithType> method converts a string to a <xref:System.DateTime> object if it conforms to one of the specified string patterns.</span></span> <span data-ttu-id="c8aa3-165">指定された形式のいずれでもない文字列がこのメソッドに渡された場合、<xref:System.FormatException> がスローされます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-165">When a string that is not one of the forms specified is passed to this method, a <xref:System.FormatException> is thrown.</span></span> <span data-ttu-id="c8aa3-166">標準の日付と時刻の書式指定子のいずれか、またはカスタムの書式指定子の組み合わせを指定することができます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-166">You can specify one of the standard date and time format specifiers or a combination of the custom format specifiers.</span></span> <span data-ttu-id="c8aa3-167">カスタムの書式指定子を使用すると、カスタムの認識文字列を構成することができます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-167">Using the custom format specifiers, it is possible for you to construct a custom recognition string.</span></span> <span data-ttu-id="c8aa3-168">(指定子の詳細については、[標準の日付と時刻の書式指定文字列](standard-date-and-time-format-strings.md)と[カスタムの日付と時刻の書式指定文字列](custom-date-and-time-format-strings.md)に関するトピックをご覧ください)。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-168">For an explanation of the specifiers, see the topics on [standard date and time format strings](standard-date-and-time-format-strings.md) and [custom date and time format strings](custom-date-and-time-format-strings.md).</span></span>  

<span data-ttu-id="c8aa3-169">次の例では、<xref:System.DateTime.ParseExact%2A?displayProperty=nameWithType> メソッドに、解析する文字列オブジェクト、書式指定子、<xref:System.Globalization.CultureInfo> オブジェクトが順に渡されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-169">In the following example, the <xref:System.DateTime.ParseExact%2A?displayProperty=nameWithType> method is passed a string object to parse, followed by a format specifier, followed by a <xref:System.Globalization.CultureInfo> object.</span></span> <span data-ttu-id="c8aa3-170">この <xref:System.DateTime.ParseExact%2A> メソッドでは、`en-US` カルチャの長い日付パターンに従う文字列のみを解析できます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-170">This <xref:System.DateTime.ParseExact%2A> method can only parse strings that follow the long date pattern in the `en-US` culture.</span></span>  

[!code-csharp-interactive[Parsing.DateAndTime#4](../../../samples/snippets/csharp/how-to/conversions/StringToDateTime.cs#4)]
[!code-vb[Parsing.DateAndTime#4](../../../samples/snippets/visualbasic/how-to/conversions/Program.vb#4)]

<span data-ttu-id="c8aa3-171"><xref:System.DateTime.Parse%2A> メソッドと <xref:System.DateTime.ParseExact%2A> メソッドの各オーバーロードには、<xref:System.IFormatProvider> パラメーターもあります。このパラメーターでは、文字列の書式設定に関するカルチャ固有の情報が指定されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-171">Each overload of the <xref:System.DateTime.Parse%2A> and <xref:System.DateTime.ParseExact%2A> methods also has an <xref:System.IFormatProvider> parameter that provides culture-specific information about the formatting of the string.</span></span> <span data-ttu-id="c8aa3-172">この <xref:System.IFormatProvider> オブジェクトは、標準的なカルチャを表す <xref:System.Globalization.CultureInfo> オブジェクトか、<xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> プロパティによって返される <xref:System.Globalization.DateTimeFormatInfo> オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-172">This <xref:System.IFormatProvider> object is a <xref:System.Globalization.CultureInfo> object that represents a standard culture or a <xref:System.Globalization.DateTimeFormatInfo> object that is returned by the <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> property.</span></span>  <span data-ttu-id="c8aa3-173"><xref:System.DateTime.ParseExact%2A> では、日付と時刻のカスタム書式を 1 つ以上定義する、文字列または文字列配列の追加の引数も使用されます。</span><span class="sxs-lookup"><span data-stu-id="c8aa3-173"><xref:System.DateTime.ParseExact%2A> also uses an additional string or string array argument that defines one or more custom date and time formats.</span></span>  

## <a name="see-also"></a><span data-ttu-id="c8aa3-174">参照</span><span class="sxs-lookup"><span data-stu-id="c8aa3-174">See Also</span></span>  
 [<span data-ttu-id="c8aa3-175">文字列の解析</span><span class="sxs-lookup"><span data-stu-id="c8aa3-175">Parsing Strings</span></span>](parsing-strings.md)  
 [<span data-ttu-id="c8aa3-176">型の書式設定</span><span class="sxs-lookup"><span data-stu-id="c8aa3-176">Formatting Types</span></span>](formatting-types.md)  
 [<span data-ttu-id="c8aa3-177">.NET での型変換</span><span class="sxs-lookup"><span data-stu-id="c8aa3-177">Type Conversion in .NET</span></span>](type-conversion.md)  
 [<span data-ttu-id="c8aa3-178">標準の日付と時刻の書式</span><span class="sxs-lookup"><span data-stu-id="c8aa3-178">Standard date and time formats</span></span>](standard-date-and-time-format-strings.md)  
 [<span data-ttu-id="c8aa3-179">カスタム日時書式指定文字列</span><span class="sxs-lookup"><span data-stu-id="c8aa3-179">Custom date and time format strings</span></span>](custom-date-and-time-format-strings.md)
