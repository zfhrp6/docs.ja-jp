<Type Name="ListViewInsertionMark" FullName="System.Windows.Forms.ListViewInsertionMark">
  <TypeSignature Language="C#" Value="public sealed class ListViewInsertionMark" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ListViewInsertionMark extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Windows.Forms.ListViewInsertionMark" />
  <AssemblyInfo>
    <AssemblyName>System.Windows.Forms</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>内の新しい位置に項目をドラッグすると、必要な格納場所を示すために使用する<see cref="T:System.Windows.Forms.ListView" />コントロール。 この機能は、以降 Windows XP でのみ利用可能です。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 取得することができます、<xref:System.Windows.Forms.ListViewInsertionMark>から、<xref:System.Windows.Forms.ListView.InsertionMark%2A>のプロパティ、<xref:System.Windows.Forms.ListView>を制御し、新しい位置に項目をドラッグすると、ドラッグ アンド ドロップ操作で必要な格納場所を視覚的に示す使用します。  
  
 場合にのみ、この機能は、<xref:System.Windows.Forms.ListView.AutoArrange%2A?displayProperty=nameWithType>プロパティに設定されている`true`とタイミング、<xref:System.Windows.Forms.ListView>コントロールは、項目を自動的に並べ替えられません。 自動並べ替え、<xref:System.Windows.Forms.ListView.Sorting%2A?displayProperty=nameWithType>プロパティに設定する必要があります<xref:System.Windows.Forms.SortOrder?displayProperty=nameWithType>と<xref:System.Windows.Forms.ListView.View%2A?displayProperty=nameWithType>プロパティに設定する必要があります<xref:System.Windows.Forms.View?displayProperty=nameWithType>、 <xref:System.Windows.Forms.View?displayProperty=nameWithType>、または<xref:System.Windows.Forms.View?displayProperty=nameWithType>です。 さらに、挿入マーク機能は使用できません、<xref:System.Windows.Forms.ListView>グループ化機能グループのメンバーシップによって、項目を注文するための機能をグループ化します。  
  
 <xref:System.Windows.Forms.ListViewInsertionMark>クラスがハンドラーをで通常使用される、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType>アイテムがドラッグされると、カーソルの位置を更新するイベントです。 ハンドラーでは使用も、<xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType>の正しい場所にドラッグした項目を挿入するイベントです。  
  
 挿入マークの位置を更新するには、次の手順を実行します。  
  
1.  ハンドラーで、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseMove?displayProperty=nameWithType>イベントを使用して、<xref:System.Windows.Forms.ListView.InsertionMark%2A?displayProperty=nameWithType>プロパティへのアクセスを<xref:System.Windows.Forms.ListViewInsertionMark>オブジェクトに関連付けられている、<xref:System.Windows.Forms.ListView>コントロール。  
  
2.  使用して、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>マウス ポインターを最も近い項目のインデックスを取得します。  
  
3.  インデックス値を渡す、<xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType>項目の外接する四角形を取得します。  
  
4.  外接する四角形の中心の左側にマウス ポインターがある場合は、設定、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティを`false`です。 それ以外の場合には、設定`true`です。  
  
5.  設定、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティから取得したインデックス値を<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>メソッドです。 挿入マークが、指定されたインデックスには、左またはに基づいて、右側のアイテムの横に表示、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティの値。 インデックス自体の上の項目をドラッグするが-1 の場合、この挿入マークは表示されません。  
  
 正しい場所にドラッグした項目を挿入するには、次の手順を実行します。  
  
1.  ハンドラーで、<xref:System.Windows.Forms.Control.DragDrop?displayProperty=nameWithType>または<xref:System.Windows.Forms.Control.MouseUp?displayProperty=nameWithType>イベントを使用して、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティ挿入マークの現在位置を判断します。 挿入インデックスとして後で使用するには、この値を格納します。  
  
2.  場合、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティに設定されている`true`、ストアド挿入インデックス値をインクリメントします。  
  
3.  使用して、<xref:System.Windows.Forms.ListView.ListViewItemCollection.Insert%2A?displayProperty=nameWithType>にドラッグした項目の複製を挿入するメソッドを<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>ストアド挿入インデックスのコレクション。  
  
4.  使用して、<xref:System.Windows.Forms.ListView.ListViewItemCollection.Remove%2A?displayProperty=nameWithType>ドラッグした項目の元のコピーを削除する方法です。  
  
 インデックスの値が、元のコピーが削除される前に、ドラッグした項目の複製を挿入する必要があります、<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>コレクションは、挿入前に変更されません。  
  
 項目が、インデックスの値と同じ順序で表示されていることを確認するには、設定すると、<xref:System.Windows.Forms.ListView.ListViewItemSorter%2A?displayProperty=nameWithType>プロパティの実装を<xref:System.Collections.IComparer>インデックス値によって項目を並べ替えてインターフェイスです。 詳細については、例」のセクションを参照してください。  
  
 使用して、挿入マークの色を変更することができます、<xref:System.Windows.Forms.ListViewInsertionMark.Color%2A>プロパティです。 の外接する四角形を取得するには、サイズまたは挿入マークの位置を必要がある場合、<xref:System.Windows.Forms.ListViewInsertionMark.Bounds%2A>プロパティです。  
  
> [!NOTE]
>  アプリケーションが呼び出すときに、挿入マーク機能は Windows XP および Windows Server 2003 ファミリでのみ使用できます、<xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType>メソッドです。 以前のオペレーティング システムで、挿入マークに関連するすべてのコードは無視され、挿入マークは表示されません。 その結果、挿入マーク機能に依存する任意のコードが正常に動作していない可能性があります。 挿入マーク機能は、使用できるかどうかを決定するテストを含めるしてが利用できない場合は、代替機能を提供することができます。 たとえば、挿入マークをサポートしないオペレーティング システムで実行されているときの位置を変更できる項目のドラッグ アンド ドロップを実装するすべてのコードをバイパスする可能性があります。  
>   
>  挿入マーク機能は、オペレーティング システムのテーマの機能を提供する同じライブラリによって提供されます。 このライブラリの可用性を確認するには、呼び出し、<xref:System.Windows.Forms.FeatureSupport.IsPresent%28System.Object%29?displayProperty=nameWithType>メソッドのオーバー ロードを渡します、<xref:System.Windows.Forms.OSFeature.Themes?displayProperty=nameWithType>値。  
  
   
  
## Examples  
 次のコード例を使用する方法を示しています、<xref:System.Windows.Forms.ListView>挿入マーク機能と標準を使用して実装するドラッグ アンド ドロップの項目の順番変更イベントをドラッグします。 ハンドラーで、挿入マークの位置を更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。 このハンドラーでは、マウス ポインターの位置を最も近い項目の中間点と比較し、結果を使用して、アイテムの左右に挿入マークが表示されるかどうかが決定します。  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#1)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#1)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName="AppearsAfterItem">
      <MemberSignature Language="C#" Value="public bool AppearsAfterItem { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool AppearsAfterItem" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>取得または挿入マークがで指定されたインデックスを持つアイテムの右側に表示されるかどうかを示す値を設定、<see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" />プロパティです。</summary>
        <value>
          <see langword="true" />挿入マークがで指定されたインデックスを持つアイテムの右側に表示された場合、<see cref="P:System.Windows.Forms.ListViewInsertionMark.Index" />プロパティ以外の場合、<see langword="false" />です。 既定値は、<see langword="false" /> です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>メソッドを使用して、マウスのポインターに最も近い項目を検索できますが、この項目の前後に挿入マークを表示する必要があるかどうかを決定する独自の計算を行う必要があります。  
  
 必要な値を計算する、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティ、これらの手順に従います。  
  
1.  使用して、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>マウス ポインターを最も近い項目のインデックスを取得します。  
  
2.  インデックス値を渡す、<xref:System.Windows.Forms.ListView.GetItemRect%2A?displayProperty=nameWithType>項目の外接する四角形を取得します。  
  
3.  外接する四角形の中心の左側にマウス ポインターがある場合は、設定、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティを`false`です。 それ以外の場合には、設定`true`です。  
  
 詳細については、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピックです。  
  
   
  
## Examples  
 次のコード例を使用する方法を示しています、<xref:System.Windows.Forms.ListView>挿入マーク機能と標準を使用して実装するドラッグ アンド ドロップの項目の順番変更イベントをドラッグします。 ハンドラーで、挿入マークの位置を更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。 このハンドラーでは、マウス ポインターの位置を最も近い項目の中間点と比較し、結果を使用して、アイテムの左右に挿入マークが表示されるかどうかが決定します。  
  
 完了の例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピックです。  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Bounds">
      <MemberSignature Language="C#" Value="public System.Drawing.Rectangle Bounds { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Rectangle Bounds" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Bounds" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Rectangle</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>挿入マークの外接する四角形を取得します。</summary>
        <value>A<see cref="T:System.Drawing.Rectangle" />挿入マークのサイズと位置を表すです。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 左上隅に対する相対パス、挿入マークを外接する四角形の座標、<xref:System.Windows.Forms.ListView>コントロール。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Color">
      <MemberSignature Language="C#" Value="public System.Drawing.Color Color { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Drawing.Color Color" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Color" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Drawing.Color</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>取得または挿入マークの色を設定します。</summary>
        <value>A<see cref="T:System.Drawing.Color" />挿入マークの色を表す値です。 既定値は <see cref="P:System.Windows.Forms.ListView.ForeColor" /> プロパティの値です。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このプロパティの前景色以外の値に挿入マークの色の設定を使用して、<xref:System.Windows.Forms.ListView>コントロール。  
  
   
  
## Examples  
 次のコード例を使用する方法を示しています、<xref:System.Windows.Forms.ListView>挿入マーク機能と標準を使用して実装するドラッグ アンド ドロップの項目の順番変更イベントをドラッグします。 ハンドラーで、挿入マークの位置を更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。 このハンドラーでは、マウス ポインターの位置を最も近い項目の中間点と比較し、結果を使用して、アイテムの左右に挿入マークが表示されるかどうかが決定します。  
  
 完了の例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピックです。  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#2)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#2)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#2)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Index">
      <MemberSignature Language="C#" Value="public int Index { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 Index" />
      <MemberSignature Language="DocId" Value="P:System.Windows.Forms.ListViewInsertionMark.Index" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>取得または挿入マークが表示される横にある項目のインデックスを設定します。</summary>
        <value>横にある項目のインデックス、挿入マークが表示されるまたは挿入マークが表示されていない場合は-1。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 場合に、指定したインデックスを持つ項目の左側に挿入マークが表示されます、<xref:System.Windows.Forms.ListViewInsertionMark.AppearsAfterItem%2A>プロパティに設定されている`false`、それ以外のアイテムの右側に表示されます。 ドラッグした項目の挿入と挿入マークが自動的に表示されなくなります、<xref:System.Windows.Forms.ListView.Items%2A?displayProperty=nameWithType>コレクション。 挿入マーク手動で削除するなどのアイテムをそれ自体の上にドラッグまたは制御範囲外にドラッグされたときに、設定、 <xref:System.Windows.Forms.ListViewInsertionMark.Index%2A> -1 の値。  
  
 使用して、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>ドラッグ アンド ドロップ操作でのアイテムの配置時にマウス ポインターの場所などの指定した場所に最も近い項目のインデックスを取得します。  
  
   
  
## Examples  
 次のコード例を使用する方法を示しています、<xref:System.Windows.Forms.ListView>挿入マーク機能と標準を使用して実装するドラッグ アンド ドロップの項目の順番変更イベントをドラッグします。 ハンドラーで、挿入マークの位置を更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。 このハンドラーでは、マウス ポインターの位置を最も近い項目の中間点と比較し、結果を使用して、アイテムの左右に挿入マークが表示されるかどうかが決定します。  
  
 完了の例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピックです。  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="NearestIndex">
      <MemberSignature Language="C#" Value="public int NearestIndex (System.Drawing.Point pt);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance int32 NearestIndex(valuetype System.Drawing.Point pt) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Windows.Forms.ListViewInsertionMark.NearestIndex(System.Drawing.Point)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Windows.Forms</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pt" Type="System.Drawing.Point" />
      </Parameters>
      <Docs>
        <param name="pt">A<see cref="T:System.Drawing.Point" />を最も近い項目を検索する位置を表すです。</param>
        <summary>指定したポイントに最も近い項目のインデックスを取得します。</summary>
        <returns>指定したポイントまたは最も近い項目が現在ドラッグされている項目である場合は-1 を最も近い項目のインデックス。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 このメソッドでは、ドラッグ アンド ドロップ操作を行うときにマウス ポインターを最も近い項目を検索できます。 設定するインデックス値が返されます使用して、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティです。 マウス ポインターを最も近い項目がドラッグされている項目の場合は、このメソッドの戻り値は-1 です。 この場合、設定、<xref:System.Windows.Forms.ListViewInsertionMark.Index%2A>プロパティをこの値には、挿入マークを非表示にします。  
  
 このメソッドは、マウス ポインターが中にある場所に関係なく、最も近い項目を検索、<xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType>メソッドのみ、指定した位置に項目を返しますまたは`null`その位置に項目がない場合。 <xref:System.Windows.Forms.ListView.GetItemAt%2A?displayProperty=nameWithType>メソッドを返します。 `null`、マウス ポインターが 2 つの項目の間にある場合など、します。 このためは常に使用する、<xref:System.Windows.Forms.ListViewInsertionMark.NearestIndex%2A>メソッドは、ドラッグ アンド ドロップ操作を使用してアイテムを配置するとします。  
  
   
  
## Examples  
 次のコード例を使用する方法を示しています、<xref:System.Windows.Forms.ListView>挿入マーク機能と標準を使用して実装するドラッグ アンド ドロップの項目の順番変更イベントをドラッグします。 ハンドラーで、挿入マークの位置を更新、<xref:System.Windows.Forms.Control.DragOver?displayProperty=nameWithType>イベント。 このハンドラーでは、マウス ポインターの位置を最も近い項目の中間点と比較し、結果を使用して、アイテムの左右に挿入マークが表示されるかどうかが決定します。  
  
 完了の例では、次を参照してください。、<xref:System.Windows.Forms.ListViewInsertionMark>概要リファレンス トピックです。  
  
 [!code-cpp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/cpp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CPP/listviewinsertionmarkexample.cpp#3)]
 [!code-csharp[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/CS/listviewinsertionmarkexample.cs#3)]
 [!code-vb[System.Windows.Forms.ListView.InsertionMark#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.ListView.InsertionMark/VB/listviewinsertionmarkexample.vb#3)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>
